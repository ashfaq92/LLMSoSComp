[
    {
        "id": "7e0f78b972841d3a",
        "type": "tab",
        "label": "SmartHome Setup",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "884a6474ca06ebd3",
        "type": "tab",
        "label": "SmartHome Apps",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "consumedThing1",
        "type": "consumed-thing",
        "tdLink": "/things/thing1",
        "td": "{\"@context\":\"https://www.w3.org/2019/wot/td/v1\",\"id\":\"urn:dev:ops:virtual-thing1\",\"title\":\"LED\",\"security\":[\"nosec\"],\"properties\":{\"status\":{\"type\":\"object\",\"properties\":{\"status\":{\"type\":\"number\"}},\"description\":\"LED 0 (OFF) / 1 (ON) status\",\"observable\":false,\"forms\":[{\"href\":\"http://localhost:1880/things/thing1/properties/status\",\"contentType\":\"application/json\",\"op\":[\"readproperty\",\"writeproperty\"]}]}},\"actions\":{\"toggle\":{\"description\":\"Toggle LED state\",\"forms\":[{\"href\":\"http://localhost:1880/things/thing1/actions/toggle\",\"contentType\":\"application/json\",\"op\":\"invokeaction\"}],\"output\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"number\"}},\"required\":[\"result\"]}}},\"forms\":[{\"href\":\"http://localhost:1880/things/thing1\",\"contentType\":\"application/td+json\"}]}",
        "http": true,
        "ws": false,
        "coap": false,
        "mqtt": false,
        "opcua": false,
        "modbus": false,
        "basicAuth": false,
        "username": "",
        "password": ""
    },
    {
        "id": "6b22e72718942046",
        "type": "consumed-thing",
        "tdLink": "http://localhost:1880/things/thing2",
        "td": "{\"@context\":\"https://www.w3.org/2019/wot/td/v1\",\"id\":\"urn:dev:ops:virtual-thing1\",\"title\":\"Thing2\",\"security\":[\"nosec\"],\"properties\":{\"level\":{\"type\":\"object\",\"forms\":[{\"href\":\"http://localhost:1880/things/thing2/properties/level\",\"contentType\":\"application/json\"}]}},\"actions\":{\"set\":{\"input\":{\"level\":{\"type\":\"number\"}},\"output\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"number\"}},\"required\":[\"result\"]},\"forms\":[{\"href\":\"http://localhost:1880/things/thing2/actions/set\",\"contentType\":\"application/json\"}]}},\"forms\":[{\"href\":\"http://localhost:1880/things/thing2\",\"contentType\":\"application/td+json\"}]}",
        "http": true,
        "ws": false,
        "coap": false,
        "mqtt": false,
        "opcua": false,
        "modbus": false,
        "basicAuth": false,
        "username": "",
        "password": ""
    },
    {
        "id": "2805a003dbd2b617",
        "type": "consumed-thing",
        "tdLink": "/things/thing3",
        "td": "{\"@context\":\"https://www.w3.org/2019/wot/td/v1\",\"id\":\"urn:dev:ops:thing1-temperature\",\"title\":\"Temperature Sensor\",\"@type\":\"TemperatureSensor\",\"securityDefinitions\":{\"nosec_sc\":{\"scheme\":\"nosec\"}},\"security\":\"nosec_sc\",\"properties\":{\"temperature\":{\"type\":\"number\",\"description\":\"Current temperature in Celsius\",\"observable\":false,\"readOnly\":true,\"forms\":[{\"href\":\"http://localhost:1880/things/thing3/properties/temperature\",\"contentType\":\"application/json\",\"op\":\"readproperty\"}]}}}",
        "http": true,
        "ws": false,
        "coap": false,
        "mqtt": false,
        "opcua": false,
        "modbus": false,
        "basicAuth": false,
        "username": "",
        "password": ""
    },
    {
        "id": "ac55d78eefcd2910",
        "type": "wot-server-config",
        "name": "test",
        "bindingType": "http",
        "bindingConfigType": "json",
        "bindingConfigConstValue": "{\"port\":8080,\"allowSelfSigned\":true}"
    },
    {
        "id": "44c6b99c601f73e9",
        "type": "wot-thing-config",
        "name": "test_thing1_title",
        "description": "test_thing1_description",
        "thingId": "test_thing1_id",
        "basicAuth": false,
        "basicAuthUsername": "",
        "basicAuthPassword": ""
    },
    {
        "id": "wot-server-config",
        "type": "wot-server-config",
        "name": "HTTP Server",
        "bindingType": "http",
        "bindingConfigType": "json",
        "bindingConfigConstValue": "{\"port\":8080,\"allowSelfSigned\":true}"
    },
    {
        "id": "4dbe15cf1fe3bdcf",
        "type": "wot-thing-config",
        "name": "LED",
        "description": "LED Thing",
        "thingId": "urn:dev:ops:virtual-thing1",
        "basicAuth": false,
        "basicAuthUsername": "",
        "basicAuthPassword": ""
    },
    {
        "id": "7e5ac8c08c681ae6",
        "type": "global-config",
        "env": [],
        "modules": {}
    },
    {
        "id": "a0db95b029fcfd65",
        "type": "websocket-listener",
        "path": "things/doorbell/bellrung",
        "wholemsg": "false"
    },
    {
        "id": "63485395a50b29c0",
        "type": "websocket-client",
        "path": "ws:http://localhost:1880/things/doorbell/bellrung",
        "tls": "",
        "wholemsg": "false",
        "hb": "0",
        "subprotocol": "",
        "headers": []
    },
    {
        "id": "heater_ws_server",
        "type": "websocket-listener",
        "path": "/things/heater/heaterStopped",
        "wholemsg": "false"
    },
    {
        "id": "leds_ws_server",
        "type": "websocket-listener",
        "path": "/things/leds/ledStateChanged",
        "wholemsg": "false"
    },
    {
        "id": "mrl_ws_server",
        "type": "websocket-listener",
        "path": "/things/mainroomlight/lightStateChanged",
        "wholemsg": "false"
    },
    {
        "id": "ms_ws_server",
        "type": "websocket-listener",
        "path": "/things/motionsensor/motiondetected",
        "wholemsg": "false"
    },
    {
        "id": "b929aa6c1471be56",
        "type": "websocket-listener",
        "path": "/things/alarm/ringing",
        "wholemsg": "false"
    },
    {
        "id": "c53c11b411a8dbad",
        "type": "websocket-client",
        "path": "ws:http://localhost:1880/things/wm/finishedCycle",
        "tls": "",
        "wholemsg": "false",
        "hb": "0",
        "subprotocol": "",
        "headers": []
    },
    {
        "id": "91c8ec522b374b97",
        "type": "websocket-client",
        "path": "ws://localhost:1880/things/alarm/ringing",
        "tls": "",
        "wholemsg": "false",
        "hb": "0",
        "subprotocol": "",
        "headers": []
    },
    {
        "id": "459ec480e7d4d173",
        "type": "websocket-listener",
        "path": "/things/wm/finishedCycle",
        "wholemsg": "false"
    },
    {
        "id": "3373b7e3eaad3463",
        "type": "websocket-listener",
        "path": "/things/doorbell/rung",
        "wholemsg": "false"
    },
    {
        "id": "19b93c24ab8e2161",
        "type": "websocket-listener",
        "path": "ws://localhost:1880/things/doorbell/rung",
        "wholemsg": "false"
    },
   
    {
        "id": "a6b14e74ad9fe7ac",
        "type": "http response",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 730,
        "y": 400,
        "wires": []
    },
  
    
    {
        "id": "307dbda4d8a76975",
        "type": "sqlite",
        "z": "2f8fa64411c4e91f",
        "mydb": "",
        "sqlquery": "fixed",
        "sql": "SELECT rowid, * FROM feed",
        "name": "db",
        "x": 430,
        "y": 400,
        "wires": [
            [
                "cc3a889258fa43f5"
            ]
        ]
    },
    {
        "id": "acf2916d00c75435",
        "type": "debug",
        "z": "2f8fa64411c4e91f",
        "name": "debug 2",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 520,
        "wires": []
    },
    
    {
        "id": "4210a65b74195fd6",
        "type": "template",
        "z": "2f8fa64411c4e91f",
        "name": "INSERT",
        "field": "topic",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "INSERT INTO feed VALUES ('{{{payload.name}}}', '{{{payload.url}}}')",
        "output": "str",
        "x": 440,
        "y": 460,
        "wires": [
            [
                "ce30774f5d0ea9e9"
            ]
        ]
    },
    {
        "id": "ce30774f5d0ea9e9",
        "type": "sqlite",
        "z": "2f8fa64411c4e91f",
        "mydb": "",
        "sqlquery": "msg.topic",
        "sql": "SELECT * FROM feed",
        "name": "db",
        "x": 590,
        "y": 460,
        "wires": [
            [
                "307dbda4d8a76975"
            ]
        ]
    },
    
    {
        "id": "909a241581cca457",
        "type": "http response",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 740,
        "y": 720,
        "wires": []
    },

    {
        "id": "6ffc61b5552bb009",
        "type": "debug",
        "z": "2f8fa64411c4e91f",
        "name": "debug 4",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 800,
        "y": 840,
        "wires": []
    },
    
    {
        "id": "08e6c9142189376d",
        "type": "comment",
        "z": "2f8fa64411c4e91f",
        "name": "monitor",
        "info": "",
        "x": 130,
        "y": 60,
        "wires": []
    },
    {
        "id": "e5efc9498b0bbc67",
        "type": "http in",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "url": "/monitor",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 120,
        "wires": [
            [
                "4afb2899ff6cc25f"
            ]
        ]
    },
    {
        "id": "e3a4b56d84f8ece9",
        "type": "template",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html>\n    <head>\n        <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/slate/bootstrap.min.css\" integrity=\"sha384-8iuq0iaMHpnH2vSyvZMSIqQuUnQA7QM+f6srIdlgBrTSEyd//AWNMyEaSF2yPzNQ\" crossorigin=\"anonymous\">\n    </head>\n    <body>\n        <nav class=\"navbar navbar-expand-lg bg-primary\" data-bs-theme=\"dark\">\n            <div class=\"container-fluid\">\n                <a class=\"navbar-brand\" href=\"/monitor\">RSS Monitor</a>\n                <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarColor01\" aria-controls=\"navbarColor01\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n                </button>\n                <div class=\"collapse navbar-collapse\" id=\"navbarColor01\">\n                    <ul class=\"navbar-nav me-auto\">\n                        <li class=\"nav-item\">\n                        <a class=\"nav-link active\" href=\"#\">Home\n                            <span class=\"visually-hidden\">(current)</span>\n                        </a>\n                        </li>\n                        <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"/monitor/feed\">Feed</a>\n                        </li>\n                        <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"/monitor/Keyword\">Keywords</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </nav>\n        <div class=\"container\">\n            <div class=\"row\">\n                <h1>Latest Stories</h1>\n                <div class=\"col-md-12\">\n                    <div class=\"table-responsive\">\n                        <table class=\"table table-sm\">\n                            <thead>\n                                <tr>\n                                    <th scope=\"col\">Headline</th>\n                                    <th scope=\"col\">Summary</th>\n                                    <th scope=\"col\">Sent</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {{#payload}}\n                                <tr class=\"table-primary\">\n                                    <td><a href=\"{{link}}\">{{title}}</a></td>\n                                    <td>{{description}}</td>\n                                    <td>{{sent}}</td>\n                                </tr>\n                                {{/payload}}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n    </body>\n</html>",
        "output": "str",
        "x": 340,
        "y": 200,
        "wires": [
            [
                "17970e87624224f9"
            ]
        ]
    },
    {
        "id": "17970e87624224f9",
        "type": "http response",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 650,
        "y": 160,
        "wires": []
    },
    {
        "id": "4afb2899ff6cc25f",
        "type": "sqlite",
        "z": "2f8fa64411c4e91f",
        "mydb": "",
        "sqlquery": "fixed",
        "sql": "SELECT rowid, * FROM match\nORDER BY rowid DESC",
        "name": "db",
        "x": 170,
        "y": 200,
        "wires": [
            [
                "e3a4b56d84f8ece9",
                "151115fa863c54f5"
            ]
        ]
    },
    {
        "id": "151115fa863c54f5",
        "type": "debug",
        "z": "2f8fa64411c4e91f",
        "name": "debug 6",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 260,
        "wires": []
    },
    {
        "id": "7e448cb921f02719",
        "type": "feedparse",
        "z": "1086946b1acd1c45",
        "name": "espnSports",
        "url": "https://www.espn.com/espn/rss/news",
        "interval": "1",
        "ignorefirst": false,
        "x": 290,
        "y": 340,
        "wires": [
            [
                "56b6d95d87b265fd"
            ]
        ]
    },
    {
        "id": "56b6d95d87b265fd",
        "type": "switch",
        "z": "1086946b1acd1c45",
        "name": "",
        "property": "article.description",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "nfl",
                "vt": "str",
                "case": true
            },
            {
                "t": "regex",
                "v": "soccer",
                "vt": "str",
                "case": true
            },
            {
                "t": "regex",
                "v": "nba",
                "vt": "str",
                "case": true
            },
            {
                "t": "regex",
                "v": "superbowl",
                "vt": "str",
                "case": true
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 490,
        "y": 380,
        "wires": [
            [
                "4f212f8073dadb3b"
            ],
            [
                "4f212f8073dadb3b"
            ],
            [
                "4f212f8073dadb3b"
            ],
            [
                "4f212f8073dadb3b"
            ],
            []
        ]
    },

   
    
    {
        "id": "9b152eaa55d9e4f9",
        "type": "xml",
        "z": "1086946b1acd1c45",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 1250,
        "y": 80,
        "wires": [
            [
                "8016da3f69059762"
            ]
        ]
    },
    {
        "id": "8016da3f69059762",
        "type": "change",
        "z": "1086946b1acd1c45",
        "name": "read item",
        "rules": [
            {
                "t": "move",
                "p": "payload.rss.channel[0].item",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 80,
        "wires": [
            [
                "fdfda343e23ae1ae"
            ]
        ]
    },
    {
        "id": "fdfda343e23ae1ae",
        "type": "split",
        "z": "1086946b1acd1c45",
        "name": "split articles",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "property": "payload",
        "x": 1550,
        "y": 80,
        "wires": [
            [
                "14e108bada9af884"
            ]
        ]
    },
    {
        "id": "14e108bada9af884",
        "type": "switch",
        "z": "1086946b1acd1c45",
        "name": "match?",
        "property": "payload.description[0]",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "keyword",
                "vt": "msg",
                "case": true
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 280,
        "y": 200,
        "wires": [
            [
                "f7dfc0780169f43e"
            ],
            []
        ]
    },
    {
        "id": "f7dfc0780169f43e",
        "type": "template",
        "z": "1086946b1acd1c45",
        "name": "INSERT",
        "field": "topic",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "INSERT OR IGNORE INTO match VALUES (\n    '{{{payload.link.0}}}',\n    '{{{payload.title.0}}}',\n    '{{{payload.description.0}}}',\n    0\n    )",
        "output": "str",
        "x": 460,
        "y": 200,
        "wires": [
            [
                "e48ad60ebe289d4e"
            ]
        ]
    },
    {
        "id": "e48ad60ebe289d4e",
        "type": "sqlite",
        "z": "1086946b1acd1c45",
        "mydb": "",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "db",
        "x": 590,
        "y": 200,
        "wires": [
            [
                "116ca2f2b9f17b18"
            ]
        ]
    },
    {
        "id": "f03193a6b30ee14c",
        "type": "sqlite",
        "z": "25f9976e4245e54a",
        "mydb": "",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "db",
        "x": 490,
        "y": 260,
        "wires": [
            [
                "4d68165d1052f4d3"
            ]
        ]
    },
    {
        "id": "9e44fc5529c079b3",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "create feed",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "CREATE TABLE feed (name, url)",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 240,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "581d96fef6d96f6c",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "create keywords",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "CREATE TABLE keyword (expression)",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 280,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "743a0368088a1d0c",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "create match",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "CREATE TABLE match (link, title, description, sent, UNIQUE(link))",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 320,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "a2b962f082a0d473",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "drop match",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "DROP TABLE match",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 540,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "790e17ceae1e8530",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "drop keywords",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "DROP TABLE keyword",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 580,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "233c00a9d25780dc",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "drop feed",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "DROP TABLE feed",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 620,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "26e55acf8ef3a451",
        "type": "comment",
        "z": "25f9976e4245e54a",
        "name": "table creation",
        "info": "",
        "x": 170,
        "y": 200,
        "wires": []
    },
    {
        "id": "85643a0b029e4458",
        "type": "comment",
        "z": "25f9976e4245e54a",
        "name": "table deletion",
        "info": "",
        "x": 190,
        "y": 500,
        "wires": []
    },
    {
        "id": "4d68165d1052f4d3",
        "type": "debug",
        "z": "25f9976e4245e54a",
        "name": "debug 3",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 320,
        "wires": []
    },
   
    {
        "id": "httpin-resources",
        "type": "http in",
        "z": "cc64ed2b39bf39cc",
        "name": "GET resources",
        "url": "/coffee-machine/properties/resources/",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 410,
        "y": 380,
        "wires": [
            [
                "function-get-resources"
            ]
        ]
    },
    {
        "id": "function-get-resources",
        "type": "function",
        "z": "cc64ed2b39bf39cc",
        "name": "Read resources",
        "func": "msg.payload = flow.get(\"coffee.resources\");\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 620,
        "y": 380,
        "wires": [
            [
                "http-response"
            ]
        ]
    },
    {
        "id": "http-response",
        "type": "http response",
        "z": "cc64ed2b39bf39cc",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 820,
        "y": 380,
        "wires": []
    },
    {
        "id": "httpin-brew",
        "type": "http in",
        "z": "cc64ed2b39bf39cc",
        "name": "POST brew",
        "url": "/coffee-machine/actions/brew/",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 400,
        "y": 480,
        "wires": [
            [
                "function-brew"
            ]
        ]
    },
    {
        "id": "function-brew",
        "type": "function",
        "z": "cc64ed2b39bf39cc",
        "name": "Handle brew",
        "func": "let state = flow.get(\"coffee.resources\") || { milk: 0, beans: 0, water: 0 };\n\n// Accept empty payload\nlet drink = msg.payload || \"espresso\";  // default to espresso\n\n// simple resource consumption\nif (state.water >= 10 && state.beans >= 5) {\n    state.water -= 10;\n    state.beans -= 5;\n    msg.payload = { result: `Brewed ${drink}`, resources: state };\n} else {\n    msg.payload = { error: \"Not enough resources\" };\n}\n\nflow.set(\"coffee.resources\", state);\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 620,
        "y": 480,
        "wires": [
            [
                "http-response"
            ]
        ]
    },
    {
        "id": "httpin-refill",
        "type": "http in",
        "z": "cc64ed2b39bf39cc",
        "name": "POST refill",
        "url": "/coffee-machine/actions/refill/",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 400,
        "y": 580,
        "wires": [
            [
                "function-refill"
            ]
        ]
    },
    {
        "id": "function-refill",
        "type": "function",
        "z": "cc64ed2b39bf39cc",
        "name": "Handle refill",
        "func": "let state = flow.get(\"coffee.resources\") || { milk:0, beans:0, water:0 };\nlet item = msg.payload;\nconsole.log(item)\nif ([\"milk\", \"beans\", \"water\"].includes(item)) {\n    state[item] = 100;\n    msg.payload = { result: `Refilled ${item}`, resources: state };\n} else {\n    msg.payload = { error: \"Unknown refill item\" };\n}\nflow.set(\"coffee.resources\", state);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 620,
        "y": 580,
        "wires": [
            [
                "http-response"
            ]
        ]
    },
    {
        "id": "httpin-td",
        "type": "http in",
        "z": "cc64ed2b39bf39cc",
        "name": "GET TD",
        "url": "/coffee-machine/td/",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 390,
        "y": 680,
        "wires": [
            [
                "function-td"
            ]
        ]
    },
    {
        "id": "function-td",
        "type": "function",
        "z": "cc64ed2b39bf39cc",
        "name": "Return TD",
        "func": "msg.payload = {\n  \"@context\": \"https://www.w3.org/2022/wot/td/v1.1\",\n  \"title\": \"Coffee Machine\",\n  \"id\": \"urn:uuid:local-coffee-machine\",\n  \"security\": [\"nosec\"],\n  \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n  \"properties\": {\n    \"resources\": {\n      \"type\": \"object\",\n      \"forms\": [\n        { \"op\": [\"readproperty\"], \"href\": \"http://localhost:1880/coffee-machine/properties/resources\", \"contentType\": \"application/json\" }\n      ]\n    }\n  },\n  \"actions\": {\n    \"brew\": {\n      \"forms\": [\n        { \"op\": [\"invokeaction\"], \"href\": \"http://localhost:1880/coffee-machine/actions/brew\", \"contentType\": \"application/json\", \"htv:methodName\": \"POST\" }\n      ]\n    },\n    \"refill\": {\n      \"forms\": [\n        { \"op\": [\"invokeaction\"], \"href\": \"http://localhost:1880/coffee-machine/actions/refill\", \"contentType\": \"application/json\", \"htv:methodName\": \"POST\" }\n      ]\n    }\n  }\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 680,
        "wires": [
            [
                "http-response"
            ]
        ]
    },
    {
        "id": "16fcdb9b72e5303d",
        "type": "http in",
        "z": "cc64ed2b39bf39cc",
        "name": "simple",
        "url": "/coffee-machine/",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 510,
        "y": 840,
        "wires": [
            [
                "fbd8dcb0b0457e6b"
            ]
        ]
    },
    {
        "id": "fbd8dcb0b0457e6b",
        "type": "function",
        "z": "cc64ed2b39bf39cc",
        "name": "description",
        "func": "msg.payload = \"simple coffee machine\"\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 690,
        "y": 840,
        "wires": [
            [
                "http-response"
            ]
        ]
    },
    {
        "id": "e9da25bf173cd0d5",
        "type": "function",
        "z": "ff0f90c1e6ac2159",
        "name": "function 1",
        "func": "msg.payload = \"Simple light üí°\"\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 440,
        "wires": [
            [
                "3b54fc8e264c8d54"
            ]
        ]
    },
    {
        "id": "3b54fc8e264c8d54",
        "type": "http response",
        "z": "ff0f90c1e6ac2159",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1090,
        "y": 660,
        "wires": []
    },
    {
        "id": "de3d0e9532dc658c",
        "type": "http in",
        "z": "ff0f90c1e6ac2159",
        "name": "Light",
        "url": "/light",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 630,
        "y": 440,
        "wires": [
            [
                "e9da25bf173cd0d5"
            ]
        ]
    },
    {
        "id": "2cc128ece6210ea2",
        "type": "http in",
        "z": "ff0f90c1e6ac2159",
        "name": "GET TD",
        "url": "/light/td/",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 620,
        "y": 520,
        "wires": [
            [
                "51f8da90bd956473"
            ]
        ]
    },
    {
        "id": "51f8da90bd956473",
        "type": "function",
        "z": "ff0f90c1e6ac2159",
        "name": "Return TD",
        "func": "msg.payload = {\n  \"id\": \"urn:uuid:1234-light\",\n  \"@context\": \"https://www.w3.org/2022/wot/td/v1.1\",\n  \"title\": \"SimpleLight\",\n  \"security\": [\"nosec\"],\n  \"securityDefinitions\": {\n    \"nosec\": { \"scheme\": \"nosec\" }\n  },\n  \"properties\": {\n    \"on\": {\n      \"type\": \"boolean\",\n      \"forms\": [\n        {\n          \"href\": \"http://localhost:1880/light/on\",\n          \"op\": [\"readproperty\", \"writeproperty\"],\n          \"contentType\": \"application/json\"\n        }\n      ]\n    }\n  },\n  \"actions\": {\n    \"toggle\": {\n      \"forms\": [\n        {\n          \"href\": \"http://localhost:1880/light/toggle\",\n          \"op\": [\"invokeaction\"],\n          \"htv:methodName\": \"POST\",\n          \"contentType\": \"application/json\"\n        }\n      ]\n    }\n  }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 520,
        "wires": [
            [
                "3b54fc8e264c8d54"
            ]
        ]
    },
    {
        "id": "d9e396bd2b1d3b95",
        "type": "http in",
        "z": "ff0f90c1e6ac2159",
        "name": "GET STATUS",
        "url": "/light/on/",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 610,
        "y": 600,
        "wires": [
            [
                "cb7ebe6da4936478"
            ]
        ]
    },
    {
        "id": "cb7ebe6da4936478",
        "type": "function",
        "z": "ff0f90c1e6ac2159",
        "name": "get status",
        "func": "// GET /light/on\n// let lightState = flow.get(\"light.on\") || false;\n// msg.payload = JSON.stringify({ on: lightState }); // wrap in object and stringify\n// return msg;\nmsg.payload= flow.get(\"light.on\")\nreturn msg",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 600,
        "wires": [
            [
                "3b54fc8e264c8d54"
            ]
        ]
    },
    {
        "id": "6302b437b6a04b84",
        "type": "inject",
        "z": "ff0f90c1e6ac2159",
        "name": "Init state",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 660,
        "y": 360,
        "wires": [
            [
                "a3a80162769c68a1"
            ]
        ]
    },
    {
        "id": "a3a80162769c68a1",
        "type": "function",
        "z": "ff0f90c1e6ac2159",
        "name": "Set initial state",
        "func": "flow.set(\"lightOn\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 860,
        "y": 360,
        "wires": [
            [
                "21433652205778be"
            ]
        ]
    },
    {
        "id": "21433652205778be",
        "type": "debug",
        "z": "ff0f90c1e6ac2159",
        "name": "debug 7",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1100,
        "y": 360,
        "wires": []
    },
    {
        "id": "2efa3c19758259b8",
        "type": "http in",
        "z": "ff0f90c1e6ac2159",
        "name": "SET STATUS",
        "url": "/light/on/",
        "method": "put",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 610,
        "y": 700,
        "wires": [
            [
                "cf3436bd1f71c15e"
            ]
        ]
    },
    {
        "id": "cf3436bd1f71c15e",
        "type": "function",
        "z": "ff0f90c1e6ac2159",
        "name": "set status",
        "func": "let body = msg.payload;  // expects JSON { \"on\": true/false }\nif (typeof body.on === \"boolean\") {\n    flow.set(\"lightOn\", body.on);\n    msg.payload = { on: body.on };\n} else {\n    msg.statusCode = 400;\n    msg.payload = { error: \"Expected JSON { on: true/false }\" };\n}\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 700,
        "wires": [
            [
                "3b54fc8e264c8d54"
            ]
        ]
    },
    {
        "id": "a6c033e603a68ed8",
        "type": "http in",
        "z": "ff0f90c1e6ac2159",
        "name": "TOGGLE",
        "url": "/light/toggle",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 600,
        "y": 780,
        "wires": [
            [
                "32e7e99319e953a1"
            ]
        ]
    },
    {
        "id": "32e7e99319e953a1",
        "type": "function",
        "z": "ff0f90c1e6ac2159",
        "name": "toggle status",
        "func": "// POST /light/toggle\nlet current = flow.get(\"light.on\") || false;\ncurrent = !current;\nflow.set(\"light.on\", current);\nmsg.payload = JSON.stringify({ on: current }); // wrap in object\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 780,
        "wires": [
            [
                "3b54fc8e264c8d54"
            ]
        ]
    },
    {
        "id": "27499b9f22421b38",
        "type": "comment",
        "z": "292a46ef9ad25949",
        "name": "Inject ‚Üí Toggle Light ‚Üí Read Light ‚Üí Store in flow context ‚Üí Function check ‚Üí Set drink ‚Üí Invoke Coffee Machine ‚Üí Debug",
        "info": "Inject ‚Üí Toggle Light ‚Üí Read Light ‚Üí Store in flow context ‚Üí Function check ‚Üí Set drink ‚Üí Invoke Coffee Machine ‚Üí Debug",
        "x": 520,
        "y": 340,
        "wires": []
    },
    {
        "id": "inject-toggle",
        "type": "inject",
        "z": "292a46ef9ad25949",
        "name": "Start sequence",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 180,
        "y": 680,
        "wires": [
            [
                "invoke-toggle"
            ]
        ]
    },
    {
        "id": "invoke-toggle",
        "type": "invoke-action",
        "z": "292a46ef9ad25949",
        "name": "Toggle Light",
        "topic": "",
        "thing": "",
        "action": "toggle",
        "uriVariables": "{}",
        "x": 400,
        "y": 680,
        "wires": [
            [
                "read-light"
            ]
        ]
    },
    {
        "id": "read-light",
        "type": "read-property",
        "z": "292a46ef9ad25949",
        "name": "Read Light State",
        "topic": "",
        "thing": "",
        "property": "on",
        "uriVariables": "",
        "observe": false,
        "x": 620,
        "y": 680,
        "wires": [
            [
                "store-light"
            ]
        ]
    },
    {
        "id": "store-light",
        "type": "function",
        "z": "292a46ef9ad25949",
        "name": "Store Light State",
        "func": "flow.set(\"light.on\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 840,
        "y": 680,
        "wires": [
            [
                "check-light"
            ]
        ]
    },
    {
        "id": "check-light",
        "type": "function",
        "z": "292a46ef9ad25949",
        "name": "Check Light and Set Drink",
        "func": "// Get light state\nlet lightState = flow.get(\"light.on\");\nif (lightState !== true) {\n    msg.payload = { error: \"Light is off, cannot brew coffee\" };\n    return msg;\n}\n\n// Light is on, set default drink\nmsg.payload = \"espresso\";\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1080,
        "y": 680,
        "wires": [
            [
                "invoke-brew"
            ]
        ]
    },
    {
        "id": "invoke-brew",
        "type": "invoke-action",
        "z": "292a46ef9ad25949",
        "name": "Brew Coffee",
        "topic": "",
        "thing": "",
        "action": "brew",
        "uriVariables": "",
        "x": 1280,
        "y": 680,
        "wires": [
            [
                "3613d4f551f0cdf9"
            ]
        ]
    },
    {
        "id": "debug-output",
        "type": "debug",
        "z": "292a46ef9ad25949",
        "name": "Debug",
        "active": true,
        "tosidebar": true,
        "console": true,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1620,
        "y": 680,
        "wires": []
    },
    {
        "id": "3613d4f551f0cdf9",
        "type": "function",
        "z": "292a46ef9ad25949",
        "name": "function 2",
        "func": "let lightState = flow.get(\"light.on\");\nlet coffeeResources = flow.get(\"coffee.resources\");\nlet lastDrink = msg.payload.result || null;\n\nmsg.payload = {\n    light: lightState,\n    coffee: coffeeResources,\n    brewed: lastDrink\n};\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 680,
        "wires": [
            [
                "debug-output"
            ]
        ]
    },
    {
        "id": "8a4ed3ab187dfd8b",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "/things/thing1",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 350,
        "y": 120,
        "wires": [
            [
                "735641927add8ab9"
            ]
        ]
    },
    {
        "id": "41d680860e0e195e",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 830,
        "y": 120,
        "wires": []
    },
    {
        "id": "735641927add8ab9",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 3",
        "func": "msg.payload = {\n    \"@context\": \"https://www.w3.org/2019/wot/td/v1\",\n    \"id\": \"urn:dev:ops:virtual-thing1\",\n    \"title\": \"LED\",\n    \"security\": [\"nosec\"],\n    \"properties\": {\n        \"status\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"status\": {\"type\": \"number\"}\n            },\n            \"description\": \"LED 0 (OFF) / 1 (ON) status\",\n            \"observable\": false,\n            \"forms\": [{\n                \"href\": \"http://localhost:1880/things/thing1/properties/status\",\n                \"contentType\": \"application/json\",\n                \"op\": [\"readproperty\", \"writeproperty\"] // specifies the kind of operation you can perform on that Thing‚Äôs property\n            }]\n        }\n    },\n    \"actions\": {\n        \"toggle\": {\n            \"description\": \"Toggle LED state\",\n            \"forms\": [{\n                \"href\": \"http://localhost:1880/things/thing1/actions/toggle\",\n                \"contentType\": \"application/json\",\n                \"op\": \"invokeaction\"\n            }],\n            \"output\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"result\": { \"type\": \"number\" }\n                },\n                \"required\": [\"result\"]\n            }\n        }\n    },\n    \"forms\": [{ \"href\": \"http://localhost:1880/things/thing1\", \"contentType\": \"application/td+json\" }]\n};\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 120,
        "wires": [
            [
                "41d680860e0e195e"
            ]
        ]
    },
    {
        "id": "5e91093c6b8a70ae",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing1/properties/status",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 300,
        "y": 160,
        "wires": [
            [
                "b94d44c7adbdaba0"
            ]
        ]
    },
    {
        "id": "e6d69e5b33ca9ada",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 830,
        "y": 160,
        "wires": []
    },
    {
        "id": "b94d44c7adbdaba0",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 4",
        "func": "let status = flow.get(\"thing1_status\") || 0;\n// ensure response header says JSON and payload is a valid JSON string\n// JSON.stringify produces a quoted JSON string, e.g. \"\\\"off\\\"\" so the body is valid JSON\n// msg.payload = JSON.stringify(status);\nmsg.headers = { \"Content-Type\": \"application/json\" };\n\nmsg.payload = {status: status};\n// msg.payload = {\"ashfaq\":\"gujjar\"};\nreturn msg;\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 160,
        "wires": [
            [
                "e6d69e5b33ca9ada"
            ]
        ]
    },
    {
        "id": "b92daf6a9f3e6c73",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing1/actions/toggle",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 300,
        "y": 240,
        "wires": [
            [
                "81d2cd6d030718e5"
            ]
        ]
    },
    {
        "id": "1859bf9eb5c050a8",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 830,
        "y": 240,
        "wires": []
    },
    {
        "id": "81d2cd6d030718e5",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 5",
        "func": "let cur = flow.get(\"thing1_status\") || 0;\nlet next = (cur === 1) ? 0 : 1;\nflow.set(\"thing1_status\", next);\nmsg.headers = { \"Content-Type\": \"application/json\" };\n\nmsg.payload = { result: next };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 240,
        "wires": [
            [
                "1859bf9eb5c050a8"
            ]
        ]
    },
    {
        "id": "110888335b4af917",
        "type": "comment",
        "z": "cc58a035b207933b",
        "name": "Thing 1 üî≥",
        "info": "",
        "x": 580,
        "y": 80,
        "wires": []
    },
    {
        "id": "18a236a5e192c745",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing2",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1170,
        "y": 120,
        "wires": [
            [
                "07a80a53dbc61b60"
            ]
        ]
    },
    {
        "id": "2443f335f3fb2757",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1650,
        "y": 120,
        "wires": []
    },
    {
        "id": "07a80a53dbc61b60",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 6",
        "func": "msg.payload = {\n    \"@context\": \"https://www.w3.org/2019/wot/td/v1\",\n    \"id\": \"urn:dev:ops:virtual-thing1\",\n    \"title\": \"Thing2\",\n    \"security\": [\"nosec\"],\n    \"properties\": {\n        \"level\": {\n            \"type\": \"object\",\n            \"forms\": [{ \"href\": \"http://localhost:1880/things/thing2/properties/level\", \"contentType\": \"application/json\" }]\n        }\n    },\n    \"actions\": {\n        \"set\": {\n            \"input\": {\n                \"level\": {\"type\": \"number\"}\n            },\n            \"output\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"result\": { \"type\": \"number\" }\n                },\n                \"required\": [\"result\"]\n            },\n            \"forms\": [{ \"href\": \"http://localhost:1880/things/thing2/actions/set\", \"contentType\": \"application/json\" }]\n        }\n    },\n    \"forms\": [{ \"href\": \"http://localhost:1880/things/thing2\", \"contentType\": \"application/td+json\" }]\n};\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1420,
        "y": 120,
        "wires": [
            [
                "2443f335f3fb2757"
            ]
        ]
    },
    {
        "id": "fd1854ec23d71b72",
        "type": "comment",
        "z": "cc58a035b207933b",
        "name": "Thing 2 üéöÔ∏è",
        "info": "",
        "x": 1400,
        "y": 80,
        "wires": []
    },
    {
        "id": "79b91ce738277634",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing2/properties/level",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1120,
        "y": 160,
        "wires": [
            [
                "7a9f57cf7c56f67d"
            ]
        ]
    },
    {
        "id": "7a9f57cf7c56f67d",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 7",
        "func": "let level = flow.get(\"thing2_level\") || 0;\n\n// msg.payload = { level: level };\nmsg.headers = { \"Content-Type\": \"application/json\" };\n\nmsg.payload = {level: level};\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1420,
        "y": 160,
        "wires": [
            [
                "d2c1f5509c1f3f92"
            ]
        ]
    },
    {
        "id": "d2c1f5509c1f3f92",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1650,
        "y": 160,
        "wires": []
    },
    {
        "id": "562be972678c59cd",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing2/actions/set",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1110,
        "y": 200,
        "wires": [
            [
                "9b8e98b60114d9b4"
            ]
        ]
    },
    {
        "id": "9b8e98b60114d9b4",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 8",
        "func": "let cur = flow.get(\"thing2_level\") || 0;\n\nlet newLevel = msg.payload.level;\n\n\nconsole.log(newLevel)\n\nflow.set(\"thing2_level\", newLevel);\nmsg.payload = { result: newLevel };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1420,
        "y": 200,
        "wires": [
            [
                "929f1e32310d68b7"
            ]
        ]
    },
    {
        "id": "929f1e32310d68b7",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1650,
        "y": 200,
        "wires": []
    },
    {
        "id": "fd11f7859657f741",
        "type": "read-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "consumedThing1",
        "property": "status",
        "uriVariables": "",
        "observe": false,
        "x": 500,
        "y": 320,
        "wires": [
            [
                "a60daa69daa3cf43"
            ]
        ]
    },
    {
        "id": "c66d34f9ca38d310",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 320,
        "wires": [
            [
                "fd11f7859657f741"
            ]
        ]
    },
    {
        "id": "a60daa69daa3cf43",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 8",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 320,
        "wires": []
    },
    {
        "id": "ada70435dcfb16c4",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{}",
        "payloadType": "json",
        "x": 270,
        "y": 460,
        "wires": [
            [
                "607169cd341ea1a7"
            ]
        ]
    },
    {
        "id": "607169cd341ea1a7",
        "type": "invoke-action",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "consumedThing1",
        "action": "toggle",
        "uriVariables": "",
        "x": 480,
        "y": 460,
        "wires": [
            [
                "acedfeb0872ebb01"
            ]
        ]
    },
    {
        "id": "acedfeb0872ebb01",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 9",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 700,
        "y": 460,
        "wires": []
    },
    {
        "id": "edf8d1051173eff9",
        "type": "read-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "6b22e72718942046",
        "property": "level",
        "uriVariables": "",
        "observe": false,
        "x": 1320,
        "y": 280,
        "wires": [
            [
                "ea324ebd27dd734d"
            ]
        ]
    },
    {
        "id": "ea324ebd27dd734d",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 10",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1480,
        "y": 280,
        "wires": []
    },
    {
        "id": "4249fad72e3668d8",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1120,
        "y": 280,
        "wires": [
            [
                "edf8d1051173eff9"
            ]
        ]
    },
    {
        "id": "528c5db4cdf5a59b",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload.level",
                "v": "4365",
                "vt": "json"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 1090,
        "y": 340,
        "wires": [
            [
                "f0585aa67aae714a"
            ]
        ]
    },
    {
        "id": "fff44dee89347b97",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 11",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1520,
        "y": 340,
        "wires": []
    },
    {
        "id": "f0585aa67aae714a",
        "type": "invoke-action",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "6b22e72718942046",
        "action": "set",
        "uriVariables": "",
        "x": 1310,
        "y": 340,
        "wires": [
            [
                "fff44dee89347b97"
            ]
        ]
    },
    {
        "id": "60d12f375dd04ea7",
        "type": "comment",
        "z": "cc58a035b207933b",
        "name": "Thing 3 üå°Ô∏è",
        "info": "",
        "x": 440,
        "y": 520,
        "wires": []
    },
    {
        "id": "878984fcb3e7fa2b",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing3",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 250,
        "y": 560,
        "wires": [
            [
                "da4a056474c12939"
            ]
        ]
    },
    {
        "id": "da4a056474c12939",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 9",
        "func": "msg.payload = {\n    \"@context\": \"https://www.w3.org/2019/wot/td/v1\",\n    \"id\": \"urn:dev:ops:thing1-temperature\",\n    \"title\": \"Temperature Sensor\",\n    \"@type\": \"TemperatureSensor\",\n    \"securityDefinitions\": {\n        \"nosec_sc\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"nosec_sc\",\n    \"properties\": {\n        \"temperature\": {\n            \"type\": \"number\",\n            \"description\": \"Current temperature in Celsius\",\n            \"observable\": false,\n            \"readOnly\": true,\n            \"forms\": [{\n                \"href\": \"http://localhost:1880/things/thing3/properties/temperature\",\n                \"contentType\": \"application/json\",\n                \"op\": \"readproperty\"\n            }]\n        }\n    }\n};\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 560,
        "wires": [
            [
                "9d77375305af9a1d"
            ]
        ]
    },
    {
        "id": "9d77375305af9a1d",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 730,
        "y": 560,
        "wires": []
    },
    {
        "id": "08b16fa03c92e05b",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing3/properties/temperature",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 180,
        "y": 600,
        "wires": [
            [
                "447a9a189fea64d9"
            ]
        ]
    },
    {
        "id": "447a9a189fea64d9",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 10",
        "func": "msg.headers = { \"Content-Type\": \"application/json\" };\n// Simulate temperature reading\nconst temperature = 20 + Math.random() * 10;\nmsg.payload = Math.round(temperature * 10) / 10\nreturn msg;\n\n\n\n\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 600,
        "wires": [
            [
                "61feeb5ff26d5844"
            ]
        ]
    },
    {
        "id": "61feeb5ff26d5844",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 730,
        "y": 600,
        "wires": []
    },
    {
        "id": "96c3630454762ddf",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing1/properties/status",
        "method": "put",
        "upload": false,
        "skipBodyParsing": true,
        "swaggerDoc": "",
        "x": 300,
        "y": 200,
        "wires": [
            [
                "501e5a45a73d651f"
            ]
        ]
    },
    {
        "id": "501e5a45a73d651f",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "PUT handler",
        "func": "let status = flow.get(\"thing1_status\") || 0;\n\nlet newStatus = msg.payload.status\n\nflow.set(\"thing1_status\", newStatus);\nmsg.headers = { \"Content-Type\": \"application/json\" };\nmsg.payload = {status: newStatus} ;\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 200,
        "wires": [
            [
                "aad25915a2c2cba2"
            ]
        ]
    },
    {
        "id": "aad25915a2c2cba2",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 830,
        "y": 200,
        "wires": []
    },
    {
        "id": "8858f4411b173d13",
        "type": "read-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "2805a003dbd2b617",
        "property": "temperature",
        "uriVariables": "",
        "observe": false,
        "x": 440,
        "y": 660,
        "wires": [
            [
                "0bdacab4ec4673c8"
            ]
        ]
    },
    {
        "id": "10baf861736e045b",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 660,
        "wires": [
            [
                "8858f4411b173d13"
            ]
        ]
    },
    {
        "id": "0bdacab4ec4673c8",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 12",
        "func": "const temp = msg.payload;\n\n// Turn LED on if temperature > 25¬∞C\nif (temp > 25) {\n    msg.payload = 1 ;\n} else {\n    msg.payload =  0;\n}\n\nnode.warn(`Temperature: ${temp}¬∞C, Turn LED: ${msg.payload.status ? 'ON' : 'OFF'}`);\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 690,
        "y": 660,
        "wires": [
            [
                "495b54d09868f344"
            ]
        ]
    },
    {
        "id": "495b54d09868f344",
        "type": "write-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "consumedThing1",
        "property": "status",
        "uriVariables": "",
        "x": 960,
        "y": 660,
        "wires": []
    },
    {
        "id": "8661bb87d65b7663",
        "type": "write-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "consumedThing1",
        "property": "status",
        "uriVariables": "",
        "x": 540,
        "y": 380,
        "wires": []
    },
    {
        "id": "9b071c87e279cfde",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 290,
        "y": 380,
        "wires": [
            [
                "8661bb87d65b7663"
            ]
        ]
    },
    {
        "id": "9408e25e2a656703",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 12",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 380,
        "wires": []
    },
    {
        "id": "d7435c30d7469770",
        "type": "write-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "consumedThing1",
        "property": "status",
        "uriVariables": "",
        "x": 540,
        "y": 420,
        "wires": []
    },
    {
        "id": "e3fc01ca972fe8bf",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 290,
        "y": 420,
        "wires": [
            [
                "d7435c30d7469770"
            ]
        ]
    },
    {
        "id": "4aec44236b06503c",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 13",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 420,
        "wires": []
    },
    {
        "id": "f1ca173d4329c4dc",
        "type": "comment",
        "z": "cc58a035b207933b",
        "name": "bad request",
        "info": "xpress / Node-RED‚Äôs JSON body parser rejects top-level JSON primitives (like true, false, 1) by default, so when the WoT client (or curl -d true) sends a bare boolean or number the server returns 400 Bad Request. That‚Äôs why \"true\" as a string or sending JSON objects sometimes ‚Äúworked‚Äù\n\nNode-RED/Express uses body-parser (express.json) with strict: true by default ‚Äî that only accepts objects and arrays as top-level JSON. Top-level primitives (boolean/number/string) are parsed as invalid JSON and the middleware rejects them with HTTP 400.",
        "x": 110,
        "y": 380,
        "wires": []
    },
    {
        "id": "17afd3b606e9bbe3",
        "type": "wot-fetch",
        "z": "cc58a035b207933b",
        "name": "",
        "tdUrl": "http://localhost:1880/things/thing1",
        "outputVar": "thingDescription",
        "outputVarType": "msg",
        "cacheTds": true,
        "cacheMinutes": 15,
        "x": 1180,
        "y": 860,
        "wires": [
            [
                "5f1e1995dbf9e016"
            ]
        ]
    },
    {
        "id": "5f1e1995dbf9e016",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 14",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1360,
        "y": 860,
        "wires": []
    },
    {
        "id": "c821d2bd8de98d11",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 980,
        "y": 860,
        "wires": [
            [
                "17afd3b606e9bbe3"
            ]
        ]
    },
    {
        "id": "da3ede03624ac29b",
        "type": "wot-discovery",
        "z": "cc58a035b207933b",
        "name": "",
        "useCoap": true,
        "coapUseIPv6": true,
        "coapIPv6Address": "all",
        "coapUseIPv4": false,
        "coapIPv4Address": "all",
        "useMqtt": "",
        "mqttBrokerAddress": "",
        "timeoutRemoval": true,
        "removalTime": 15,
        "msgOrContext": "msg",
        "msgProperty": "",
        "msgPropertyType": "msg",
        "contextVar": "",
        "contextVarType": "flow",
        "deleteExistingTDs": true,
        "coreURI": false,
        "tdURI": true,
        "useCoreRD": false,
        "coreRDUseIPv6": false,
        "coreRDUseIPv4": false,
        "x": 1180,
        "y": 800,
        "wires": [
            [
                "a21a20ce3d96a2c8"
            ]
        ]
    },
    {
        "id": "7aca786b1826d882",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 980,
        "y": 800,
        "wires": [
            [
                "da3ede03624ac29b"
            ]
        ]
    },
    {
        "id": "a21a20ce3d96a2c8",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 15",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1360,
        "y": 800,
        "wires": []
    },
    {
        "id": "0b93049c3525debd",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 11",
        "func": "msg.payload = {\n    \"thing1\": {\n        \"id\": \"urn:dev:ops:thing1\",\n            \"title\": \"Thing1\",\n                \"properties\": {\n            \"status\": {\n                \"type\": \"string\",\n                    \"forms\": [\n                        { \"href\": \"http://localhost:1880/things/thing1/properties/status\" }\n                    ]\n            }\n        },\n        \"actions\": {\n            \"toggle\": {\n                \"forms\": [\n                    { \"href\": \"http://localhost:1880/things/thing1/actions/toggle\" }\n                ]\n            }\n        }\n    },\n    \"thing2\": {\n        \"id\": \"urn:dev:ops:thing2\",\n            \"title\": \"Thing2\",\n                \"properties\": {\n            \"level\": {\n                \"type\": \"number\",\n                    \"forms\": [\n                        { \"href\": \"http://localhost:1880/things/thing2/properties/level\" }\n                    ]\n            }\n        },\n        \"actions\": {\n            \"set\": {\n                \"forms\": [\n                    { \"href\": \"http://localhost:1880/things/thing2/actions/set\" }\n                ]\n            }\n        }\n    },\n    \"thing3\": {\n        \"id\": \"urn:dev:ops:thing3\",\n            \"title\": \"Thing3\",\n                \"properties\": { /* ... */ },\n        \"actions\": { /* ... */ }\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 840,
        "wires": [
            [
                "7d8b07e0d66891f6"
            ]
        ]
    },
    {
        "id": "aabd9587c0606980",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "/things",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 190,
        "y": 840,
        "wires": [
            [
                "0b93049c3525debd"
            ]
        ]
    },
    {
        "id": "7d8b07e0d66891f6",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 550,
        "y": 840,
        "wires": []
    },
    {
        "id": "a1b2c3d4e5f6g7h8",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "Poll Thing2 level",
        "props": [
            {
                "p": "interval",
                "v": "",
                "vt": "date"
            }
        ],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": "1",
        "topic": "",
        "x": 350,
        "y": 1040,
        "wires": [
            [
                "b2c3d4e5f6g7h8i9"
            ]
        ]
    },
    {
        "id": "b2c3d4e5f6g7h8i9",
        "type": "http request",
        "z": "cc58a035b207933b",
        "name": "Get Thing2 level",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/thing2/properties/level",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 550,
        "y": 1040,
        "wires": [
            [
                "c3d4e5f6g7h8i9j0"
            ]
        ]
    },
    {
        "id": "c3d4e5f6g7h8i9j0",
        "type": "switch",
        "z": "cc58a035b207933b",
        "name": "level > 5?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gt",
                "v": "5",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 750,
        "y": 1040,
        "wires": [
            [
                "d4e5f6g7h8i9j0k1"
            ]
        ]
    },
    {
        "id": "d4e5f6g7h8i9j0k1",
        "type": "change",
        "z": "cc58a035b207933b",
        "name": "Set LED ON payload",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "1",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 1040,
        "wires": [
            [
                "e5f6g7h8i9j0k1l2"
            ]
        ]
    },
    {
        "id": "e5f6g7h8i9j0k1l2",
        "type": "http request",
        "z": "cc58a035b207933b",
        "name": "Set Thing1 LED ON",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/thing1/properties/status",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "headers": {
            "Content-Type": "application/json"
        },
        "x": 1180,
        "y": 1040,
        "wires": [
            [
                "ee1a68c5326d7f73"
            ]
        ]
    },
    {
        "id": "ee1a68c5326d7f73",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 16",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1400,
        "y": 1040,
        "wires": []
    },
    {
        "id": "739d9c8003e4c39e",
        "type": "comment",
        "z": "03751bef0ed5432b",
        "name": "general",
        "info": "",
        "x": 730,
        "y": 200,
        "wires": []
    },
    {
        "id": "c3a206c85ac10da8",
        "type": "http in",
        "z": "03751bef0ed5432b",
        "name": "",
        "url": "/things",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 510,
        "y": 240,
        "wires": [
            [
                "703d79273ef1bebf"
            ]
        ]
    },
    {
        "id": "703d79273ef1bebf",
        "type": "function",
        "z": "03751bef0ed5432b",
        "name": "function 13",
        "func": "\nconst smartHomeTDs = [\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:alarm\",\n        \"title\": \"Alarm\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"events\": {\n            \"alarmRinging\": {\n                \"title\": \"Alarm Ringing\",\n                \"description\": \"This alarm has started ringing\",\n                \"data\": { \"type\": \"object\", \"properties\": { \"since\": { \"type\": \"string\", \"format\": \"date-time\" } } },\n                \"forms\": [\n                    {\n                        \"href\": \"http://localhost:1880/things/alarm/events/alarmRinging\",\n                        \"contentType\": \"text/event-stream\",\n                        \"op\": [\"subscribeevent\"]\n                    }\n                ]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/alarm\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:doorbell\",\n        \"title\": \"DoorBell\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"events\": {\n            \"bellRung\": {\n                \"title\": \"Bell rung\",\n                \"description\": \"The bell was rung\",\n                \"data\": { \"type\": \"object\", \"properties\": { \"when\": { \"type\": \"string\", \"format\": \"date-time\" } } },\n                \"forms\": [\n                    {\n                        \"href\": \"http://localhost:1880/things/doorbell/events/bellRung\",\n                        \"contentType\": \"text/event-stream\",\n                        \"op\": [\"subscribeevent\"]\n                    }\n                ]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/doorbell\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:heater\",\n        \"title\": \"Heater\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"actions\": {\n            \"startHeater\": {\n                \"title\": \"Start heater\",\n                \"description\": \"Starts the heater at the given temperature for the given time\",\n                \"input\": { \"type\": \"object\", \"properties\": { \"temperature\": { \"type\": \"integer\" }, \"timeHeating\": { \"type\": \"integer\" } }, \"required\": [\"temperature\"] },\n                \"output\": { \"type\": \"object\", \"properties\": { \"status\": { \"type\": \"string\" } } },\n                \"forms\": [\n                    { \"href\": \"http://localhost:1880/things/heater/actions/startHeater\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }\n                ]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/heater\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:leds\",\n        \"title\": \"LEDs\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"actions\": {\n            \"blink\": { \"title\": \"Blink LEDs\", \"input\": { \"type\": \"object\", \"properties\": { \"times\": { \"type\": \"integer\" } } }, \"forms\": [{ \"href\": \"http://localhost:1880/things/leds/actions/blink\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] },\n            \"LEDsOn\": { \"title\": \"Turn LEDs on\", \"forms\": [{ \"href\": \"http://localhost:1880/things/leds/actions/LEDsOn\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] },\n            \"LEDsOff\": { \"title\": \"Turn LEDs off\", \"forms\": [{ \"href\": \"http://localhost:1880/things/leds/actions/LEDsOff\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/leds\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:mainroomlight\",\n        \"title\": \"MainRoomLight\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"actions\": {\n            \"lightOn\": { \"title\": \"Turn light on\", \"forms\": [{ \"href\": \"http://localhost:1880/things/mainroomlight/actions/lightOn\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] },\n            \"lightOff\": { \"title\": \"Turn light off\", \"forms\": [{ \"href\": \"http://localhost:1880/things/mainroomlight/actions/lightOff\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/mainroomlight\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:motionsensor\",\n        \"title\": \"MotionSensor\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"events\": {\n            \"motionDetected\": {\n                \"title\": \"Motion detected\",\n                \"description\": \"An event made when motion is detected\",\n                \"data\": { \"type\": \"object\", \"properties\": { \"when\": { \"type\": \"string\", \"format\": \"date-time\" } } },\n                \"forms\": [{ \"href\": \"http://localhost:1880/things/motionsensor/events/motionDetected\", \"contentType\": \"text/event-stream\", \"op\": [\"subscribeevent\"] }]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/motionsensor\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:smartassistant\",\n        \"title\": \"SmartAssistant\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"actions\": {\n            \"say\": {\n                \"title\": \"Say phrase\",\n                \"input\": { \"type\": \"object\", \"properties\": { \"phrase\": { \"type\": \"string\" } }, \"required\": [\"phrase\"] },\n                \"forms\": [{ \"href\": \"http://localhost:1880/things/smartassistant/actions/say\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/smartassistant\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:speaker\",\n        \"title\": \"Speaker\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"actions\": {\n            \"setVolume\": { \"title\": \"Set volume\", \"input\": { \"type\": \"object\", \"properties\": { \"percentage\": { \"type\": \"integer\", \"minimum\": 0, \"maximum\": 100 } }, \"required\": [\"percentage\"] }, \"forms\": [{ \"href\": \"http://localhost:1880/things/speaker/actions/setVolume\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] },\n            \"getVolume\": { \"title\": \"Get volume\", \"output\": { \"type\": \"integer\" }, \"forms\": [{ \"href\": \"http://localhost:1880/things/speaker/actions/getVolume\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] }\n        },\n        \"properties\": {\n            \"volume\": {\n                \"type\": \"integer\",\n                \"forms\": [{ \"href\": \"http://localhost:1880/things/speaker/properties/volume\", \"contentType\": \"application/json\", \"op\": [\"readproperty\", \"writeproperty\"], \"htv:methodName\": \"GET\" }]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/speaker\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:washingmachine\",\n        \"title\": \"WashingMachine\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"events\": {\n            \"finishedCycle\": {\n                \"title\": \"Wash cycle complete\",\n                \"description\": \"Sends a notification at the end of a wash cycle\",\n                \"data\": { \"type\": \"object\", \"properties\": { \"when\": { \"type\": \"string\", \"format\": \"date-time\" } } },\n                \"forms\": [{ \"href\": \"http://localhost:1880/things/washingmachine/events/finishedCycle\", \"contentType\": \"text/event-stream\", \"op\": [\"subscribeevent\"] }]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/washingmachine\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    }\n]\n\n\nflow.set(\"smartHomeTDs\", smartHomeTDs);\n\nmsg.payload = smartHomeTDs\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 240,
        "wires": [
            [
                "eff6097109cf9c60"
            ]
        ]
    },
    {
        "id": "eff6097109cf9c60",
        "type": "http response",
        "z": "03751bef0ed5432b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 970,
        "y": 240,
        "wires": []
    },
    {
        "id": "77179733c4cfcc89",
        "type": "http in",
        "z": "03751bef0ed5432b",
        "name": "",
        "url": "/things/:thingName",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 540,
        "y": 280,
        "wires": [
            [
                "eafddef2298f49ca"
            ]
        ]
    },
    {
        "id": "eafddef2298f49ca",
        "type": "function",
        "z": "03751bef0ed5432b",
        "name": "function 14",
        "func": "const thingName = msg.req.params.thingName\n\nconst smartHomeTDs = flow.get('smartHomeTDs')\n\nconst res = smartHomeTDs.find(obj => obj.title.toLowerCase() === thingName.toLowerCase());\n\nmsg.payload = res\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 280,
        "wires": [
            [
                "bd671f9ec0775ded"
            ]
        ]
    },
    {
        "id": "bd671f9ec0775ded",
        "type": "http response",
        "z": "03751bef0ed5432b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 970,
        "y": 280,
        "wires": []
    },
    {
        "id": "f64b900a257005c8",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 15",
        "func": "\nconst washingMachineTD = {\n    \"@context\": \"http://www.w3.org/ns/td\",\n    \"@type\": [\"Thing\"],\n    \"title\": \"WashingMachine\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"status\": {\n            \"title\": \"Machine Status\",\n            \"description\": \"Current state of the washing machine\",\n            \"type\": \"string\",\n            \"enum\": [\"idle\", \"running\", \"finished\"],\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/wm/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        },\n        \"remainingTime\": {\n            \"title\": \"Time Left\",\n            \"description\": \"Remaining wash cycle time in minutes\",\n            \"type\": \"integer\",\n            \"unit\": \"minutes\",\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/wm/remainingTime\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"start\": {\n            \"title\": \"Start Washing Cycle\",\n            \"description\": \"Start a new wash program\",\n            \"input\": {\n                \"type\": \"string\",\n                \"enum\": [\"quick\", \"cotton\", \"wool\"]\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/wm/start\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"stop\": {\n            \"title\": \"Stop Cycle\",\n            \"description\": \"Immediately stop the wash program\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/wm/stop\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"finishedCycle\": {\n            \"title\": \"Wash cycle complete\",\n            \"description\": \"Sends a notification at the end of a wash cycle\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"ws://localhost:1880/things/wm/finishedCycle\",\n                    \"subprotocol\": \"websocket\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"subscribeevent\"]\n                },\n                {\n                    \"href\": \"http://localhost:1880/things/wm/finishedCycle\",\n                    \"subprotocol\": \"longpoll\"\n                }\n            ]\n        }\n    }\n}\n\n\n\nflow.set(\"washingMachineTD\", washingMachineTD);\n\nmsg.payload = washingMachineTD\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 220,
        "wires": [
            [
                "980a988016981af5"
            ]
        ]
    },
    {
        "id": "0db8ee0958e1ef02",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/wm",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 100,
        "y": 220,
        "wires": [
            [
                "f64b900a257005c8"
            ]
        ]
    },
    {
        "id": "0c1d3eb21c52f30b",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Washing Machine",
        "info": "",
        "x": 350,
        "y": 180,
        "wires": []
    },
    {
        "id": "1c85c21946fc3c7e",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 16",
        "func": "\n\nmsg.payload = \"test\"\n\n\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 330,
        "y": 80,
        "wires": [
            [
                "05a8bf26fa44989b",
                "c1376a597a4c11f1"
            ]
        ]
    },
    {
        "id": "05a8bf26fa44989b",
        "type": "debug",
        "z": "7e0f78b972841d3a",
        "name": "debug 17",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 80,
        "wires": []
    },
    {
        "id": "4ca82008fa95bfb8",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/test",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 100,
        "y": 80,
        "wires": [
            [
                "1c85c21946fc3c7e"
            ]
        ]
    },
    {
        "id": "c1376a597a4c11f1",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 550,
        "y": 120,
        "wires": []
    },
    {
        "id": "f79ce0f087c8a386",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "test",
        "info": "",
        "x": 310,
        "y": 40,
        "wires": []
    },
    {
        "id": "1b2b88797d05b5cc",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/wm/status",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 260,
        "wires": [
            [
                "c7c33a5af005f2f8"
            ]
        ]
    },
    {
        "id": "c7c33a5af005f2f8",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 17",
        "func": "msg.payload = { status: flow.get(\"wm_status\") || \"idle\" };\n\nmsg.headers = {\"Content-Type\": \"application/json\"};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 260,
        "wires": [
            [
                "980a988016981af5"
            ]
        ]
    },
    {
        "id": "ec15c7294110d82a",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/wm/remainingTime",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 300,
        "wires": [
            [
                "466337878f69cc40"
            ]
        ]
    },
    {
        "id": "466337878f69cc40",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 18",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\nmsg.payload = { remainingTime: flow.get(\"wm_time\") || 0 };\nreturn msg;\n\n\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 300,
        "wires": [
            [
                "980a988016981af5"
            ]
        ]
    },
    {
        "id": "980a988016981af5",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 590,
        "y": 300,
        "wires": []
    },
    {
        "id": "1047a1d416b06ec0",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/wm/start",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 340,
        "wires": [
            [
                "bab3d529a04c8321"
            ]
        ]
    },
    {
        "id": "bab3d529a04c8321",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 19",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\nlet program = msg.payload.program || \"quick\";\nflow.set(\"wm_status\", \"running\");\nflow.set(\"wm_time\", 30);   // default minutes for cycle\nmsg.payload = { message: \"Started program: \" + program };\nreturn msg;\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 340,
        "wires": [
            [
                "980a988016981af5"
            ]
        ]
    },
    {
        "id": "3bdb1f6328e8abd1",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/wm/stop",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 380,
        "wires": [
            [
                "7a59bddf7efa02c7"
            ]
        ]
    },
    {
        "id": "7a59bddf7efa02c7",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 20",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\nflow.set(\"wm_status\", \"idle\");\nflow.set(\"wm_time\", 0);\nmsg.payload = { message: \"Cycle stopped\" };\nreturn msg;\n\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 380,
        "wires": [
            [
                "980a988016981af5"
            ]
        ]
    },
    {
        "id": "bafc632bd18a7754",
        "type": "inject",
        "z": "7e0f78b972841d3a",
        "name": "cyclefinished",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 460,
        "wires": [
            [
                "f9b4498b4c077e78"
            ]
        ]
    },
    {
        "id": "f9b4498b4c077e78",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 21",
        "func": "let status = flow.get(\"wm_status\") || \"idle\";\nlet time = flow.get(\"wm_time\") || 0;\n\nif (status === \"running\") {\n    if (time > 0) {\n        flow.set(\"wm_time\", time - 1);\n    } else {\n        flow.set(\"wm_status\", \"finished\");\n        msg.payload = \"Cycle finished!\";\n        return msg;  // this triggers the event\n    }\n}\nreturn null;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 460,
        "wires": [
            [
                "cf86740517719117",
                "b7614e84e21bc41c"
            ]
        ]
    },
    {
        "id": "cf86740517719117",
        "type": "debug",
        "z": "7e0f78b972841d3a",
        "name": "debug 19",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 420,
        "wires": []
    },
    {
        "id": "d9158db16b493f76",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Alarm ‚è∞",
        "info": "",
        "x": 1260,
        "y": 40,
        "wires": []
    },
    {
        "id": "a88c5e8116986d94",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 22",
        "func": "\nconst alarmTD = {\n    \"@context\": [\n        \"[http://www.w3.org/ns/td](http://www.w3.org/ns/td)\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"Alarm\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"time\": {\n            \"title\": \"Alarm Time\",\n            \"description\": \"The scheduled alarm time in HH:MM format\",\n            \"type\": \"string\",\n            \"readOnly\": false,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/time\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\", \"writeproperty\"]\n                }\n            ]\n        },\n        \"enabled\": {\n            \"title\": \"Enabled\",\n            \"description\": \"Whether the alarm is active\",\n            \"type\": \"boolean\",\n            \"readOnly\": false,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/enabled\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\", \"writeproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"setTime\": {\n            \"title\": \"Set Alarm Time\",\n            \"input\": {\n                \"type\": \"string\",\n                \"pattern\": \"^([01]?[0-9]|2[0-3]):[0-5][0-9]$\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/setTime\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"toggle\": {\n            \"title\": \"Enable/Disable Alarm\",\n            \"input\": {\n                \"type\": \"boolean\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/toggle\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"stop\": {\n            \"title\": \"Stop Alarm\",\n            \"description\": \"Stops the ringing alarm\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/stop\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"alarmRinging\": {\n            \"title\": \"Alarm Ringing\",\n            \"description\": \"This alarm has started ringing\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/ringing\",\n                    \"subprotocol\": \"longpoll\"\n                }\n            ]\n        }\n    }\n}\n\n\n\n\nflow.set(\"alarmTD\", alarmTD);\n\nmsg.payload = alarmTD\n\n\nmsg.headers = {\"Content-Type\": \"application/td+json\"};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 100,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "3ee26586773f6ed6",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 990,
        "y": 100,
        "wires": [
            [
                "a88c5e8116986d94"
            ]
        ]
    },
    {
        "id": "09d90a7cda6f68bc",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 23",
        "func": "msg.headers = { \"Content-Type\": \"application/json\" };\n\nmsg.payload = { time: flow.get(\"alarm_time\") || \"07:00\" };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 140,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "8d8b844de244e471",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/time",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1000,
        "y": 140,
        "wires": [
            [
                "09d90a7cda6f68bc"
            ]
        ]
    },
    {
        "id": "e7034e583b904992",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 24",
        "func": "msg.headers = { \"Content-Type\": \"application/json\" };\n\n\nlet body = msg.payload;\nif (body && body.time) {\n    flow.set(\"alarm_time\", body.time);\n    msg.payload = { message: \"Alarm time set\", time: body.time };\n} else {\n    msg.payload = { error: \"Missing 'time' in payload\" };\n}\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 180,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "dec2294db8a50b06",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/time",
        "method": "put",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1000,
        "y": 180,
        "wires": [
            [
                "e7034e583b904992"
            ]
        ]
    },
    {
        "id": "5fc2563290de565a",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 25",
        "func": "msg.headers = { \"Content-Type\": \"application/json\" };\n\n\nmsg.payload = { enabled: flow.get(\"alarm_enabled\") || false };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 220,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "2c5c35b270e4fcd7",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/enabled",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 220,
        "wires": [
            [
                "5fc2563290de565a"
            ]
        ]
    },
    {
        "id": "7bdda896bc3a199a",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 26",
        "func": "msg.headers = { \"Content-Type\": \"application/json\" };\n\nlet body = msg.payload;\nif (typeof body.enabled === \"boolean\") {\n    flow.set(\"alarm_enabled\", body.enabled);\n    msg.payload = { message: \"Alarm state updated\", enabled: body.enabled };\n} else {\n    msg.payload = { error: \"Missing or invalid 'enabled' in payload\" };\n}\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 260,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "1558a1c9dd212174",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/enabled",
        "method": "put",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 260,
        "wires": [
            [
                "7bdda896bc3a199a"
            ]
        ]
    },
    {
        "id": "0c6ae03bc072140c",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1450,
        "y": 260,
        "wires": []
    },
    {
        "id": "9894c0ca898663cf",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/setTime",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1020,
        "y": 300,
        "wires": [
            [
                "bb7c8dc0c0046fad"
            ]
        ]
    },
    {
        "id": "bb7c8dc0c0046fad",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 27",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\nlet time = msg.payload.time;\nif (time) {\n    flow.set(\"alarm_time\", time);\n    msg.payload = { message: \"Alarm time set via action\", time: time };\n} else {\n    msg.payload = { error: \"Missing 'time' in payload\" };\n}\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 300,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "0e4613bcaa286270",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/toggle",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 340,
        "wires": [
            [
                "12b38ddbfce5a278"
            ]
        ]
    },
    {
        "id": "12b38ddbfce5a278",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 28",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\n// Get current state, default to false\nlet enabled = flow.get(\"alarm_enabled\") || false;\n\n// Reverse the state\nenabled = !enabled;\n\n// Save back to context\nflow.set(\"alarm_enabled\", enabled);\n\n// Return message\nmsg.payload = { message: \"Alarm \" + (enabled ? \"enabled\" : \"disabled\"), enabled: enabled };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 340,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "e26a5e445f1f8c37",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/stop",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1000,
        "y": 380,
        "wires": [
            [
                "8ea75e45c1e6b679"
            ]
        ]
    },
    {
        "id": "8ea75e45c1e6b679",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 29",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\nflow.set(\"alarm_ringing\", false);\nmsg.payload = { message: \"Alarm stopped\" };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 380,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "38c7f7332ac7bf1b",
        "type": "inject",
        "z": "7e0f78b972841d3a",
        "name": "alarmRinging",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1000,
        "y": 420,
        "wires": [
            [
                "24deede65dbf99b6"
            ]
        ]
    },
    {
        "id": "24deede65dbf99b6",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 30",
        "func": "let enabled = flow.get(\"alarm_enabled\") || false;\nlet alarmTime = flow.get(\"alarm_time\") || \"07:00\";\nlet ringing = flow.get(\"alarm_ringing\") || false;\n\nlet now = new Date();\nlet currentTime = now.getHours().toString().padStart(2, \"0\") + \":\" +\n    now.getMinutes().toString().padStart(2, \"0\");\n\nif (enabled && currentTime === alarmTime && !ringing) {\n    flow.set(\"alarm_ringing\", true);\n    msg.payload = \"Alarm ringing at \" + alarmTime;\n    return msg;  // emit event\n} else {\n    return null; // no event\n}\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 420,
        "wires": [
            [
                "2e37ea10f2d1ca2a",
                "0c6ae03bc072140c",
                "0916e7905bc65d3d"
            ]
        ]
    },
    {
        "id": "2e37ea10f2d1ca2a",
        "type": "debug",
        "z": "7e0f78b972841d3a",
        "name": "debug 18",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1460,
        "y": 420,
        "wires": []
    },
    {
        "id": "22c9bce343b64adb",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Door Bell üîî",
        "info": "",
        "x": 250,
        "y": 640,
        "wires": []
    },
    {
        "id": "304d9139fb042253",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/doorbell",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 680,
        "wires": [
            [
                "7e68f9973188a586"
            ]
        ]
    },
    {
        "id": "7e68f9973188a586",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 31",
        "func": "\nconst doorBellTD = {\n    \"@context\": [\n        \"http://www.w3.org/ns/td\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"DoorBell\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"enabled\": {\n            \"title\": \"Enabled\",\n            \"description\": \"Whether the doorbell is active\",\n            \"type\": \"boolean\",\n            \"readOnly\": false,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/doorbell/enabled\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\", \"writeproperty\"]\n                }\n            ]\n        },\n        \"lastRung\": {\n            \"title\": \"Last Rung\",\n            \"description\": \"Timestamp of the last ring\",\n            \"type\": \"string\",\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/doorbell/lastRung\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"toggle\": {\n            \"title\": \"Enable/Disable Doorbell\",\n            \"description\": \"Invert the current enabled state\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/doorbell/toggle\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"ring\": {\n            \"title\": \"Ring Doorbell\",\n            \"description\": \"Manually trigger the bell\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/doorbell/ring\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"bellRung\": {\n            \"title\": \"Bell rung\",\n            \"description\": \"The bell was rung\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/doorbell/bellRung\",\n                    \"subprotocol\": \"longpoll\"\n                }\n            ]\n        }\n    }\n}\n\n\nflow.set(\"doorBellTD\", doorBellTD);\n\nmsg.payload = doorBellTD\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 680,
        "wires": [
            [
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "db1_http_enabled_get",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "things/doorbell/enabled",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 720,
        "wires": [
            [
                "db1_func_enabled_get"
            ]
        ]
    },
    {
        "id": "db1_func_enabled_get",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Return enabled",
        "func": "msg.payload = { enabled: flow.get('doorbell_enabled') || true };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 380,
        "y": 720,
        "wires": [
            [
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "db1_http_enabled_put",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/doorbell/enabled",
        "method": "put",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 760,
        "wires": [
            [
                "db1_func_enabled_put"
            ]
        ]
    },
    {
        "id": "db1_func_enabled_put",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Update enabled",
        "func": "let body = msg.payload;\nif(typeof body.enabled === 'boolean'){\n    flow.set('doorbell_enabled', body.enabled);\n    msg.payload = { message: 'Doorbell ' + (body.enabled ? 'enabled' : 'disabled'), enabled: body.enabled };\n}else{\n    msg.payload = { error: 'Missing or invalid enabled' };\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 760,
        "wires": [
            [
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "db1_http_response_enabled_put",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 590,
        "y": 760,
        "wires": []
    },
    {
        "id": "db1_http_lastRung_get",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/doorbell/lastRung",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 800,
        "wires": [
            [
                "db1_func_lastRung_get"
            ]
        ]
    },
    {
        "id": "db1_func_lastRung_get",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Return lastRung",
        "func": "msg.payload = { lastRung: flow.get('doorbell_lastRung') || null };\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 800,
        "wires": [
            [
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "db1_http_toggle_post",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/doorbell/toggle",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 840,
        "wires": [
            [
                "db1_func_toggle"
            ]
        ]
    },
    {
        "id": "db1_func_toggle",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Toggle ",
        "func": "let enabled = flow.get('doorbell_enabled');\nif (enabled === undefined) {\n    enabled = true; // default first-time state\n}\nenabled = !enabled;\nflow.set('doorbell_enabled', enabled);\nmsg.payload = { message: 'Doorbell ' + (enabled ? 'enabled' : 'disabled'), enabled: enabled };\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 840,
        "wires": [
            [
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "c11848e672c4c22f",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/doorbell/ring",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 880,
        "wires": [
            [
                "6030e858ea7bc03e"
            ]
        ]
    },
    {
        "id": "6030e858ea7bc03e",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Ring bell",
        "func": "if(flow.get('doorbell_enabled')){\n    let now = new Date().toISOString();\n    flow.set('doorbell_lastRung', now);\n    msg.payload = 'Doorbell rang at ' + now;\n    return msg;\n} else {\n    msg.payload = 'Doorbell is disabled';\n    return msg;\n}",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 880,
        "wires": [
            [
                "674597642f429fbd",
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "674597642f429fbd",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "",
        "server": "3373b7e3eaad3463",
        "client": "",
        "x": 610,
        "y": 860,
        "wires": []
    },
    {
        "id": "261fc1d97f1959b7",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Heater üî•",
        "info": "",
        "x": 1140,
        "y": 520,
        "wires": []
    },
    {
        "id": "999a16fd3ea27dc6",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/heater",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 990,
        "y": 580,
        "wires": [
            [
                "9bbc9801e3348ec8"
            ]
        ]
    },
    {
        "id": "243260ce44651b69",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1470,
        "y": 580,
        "wires": []
    },
    {
        "id": "heater_start_http",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/heater/start",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 700,
        "wires": [
            [
                "heater_start_func"
            ]
        ]
    },
    {
        "id": "heater_start_func",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Start heater",
        "func": "let body = msg.payload;\nif (typeof body.temperature === 'number' && typeof body.timeHeating === 'number') {\n    flow.set('heater_temperature', body.temperature);\n    flow.set('heater_timeHeating', body.timeHeating);\n    flow.set('heater_status', 'on');\n\n    // set timeout to stop heater\n    let timeout = body.timeHeating * 60000; // minutes ‚Üí ms\n    setTimeout(() => {\n        flow.set('heater_status', 'off');\n        flow.set('heater_timeHeating', 0);\n        let eventMsg = { payload: 'Heater stopped after timeout' };\n        node.send([null, eventMsg]);\n    }, timeout);\n\n    msg.payload = { message: 'Heater started', temperature: body.temperature, timeHeating: body.timeHeating };\n    return [msg, null];\n} else {\n    msg.payload = { error: 'Invalid input: expected {temperature:int, timeHeating:int}' };\n    return [msg, null];\n}",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 700,
        "wires": [
            [
                "243260ce44651b69"
            ],
            [
                "heater_ws_event"
            ]
        ]
    },
    {
        "id": "heater_stop_http",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/heater/stop",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 760,
        "wires": [
            [
                "heater_stop_func"
            ]
        ]
    },
    {
        "id": "heater_stop_func",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Stop heater",
        "func": "flow.set('heater_status', 'off');\nflow.set('heater_timeHeating', 0);\nmsg.payload = { message: 'Heater stopped manually' };\nreturn [msg, msg];",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 760,
        "wires": [
            [
                "243260ce44651b69"
            ],
            [
                "heater_ws_event"
            ]
        ]
    },
    {
        "id": "heater_status_http",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/heater/status",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 640,
        "wires": [
            [
                "heater_status_func"
            ]
        ]
    },
    {
        "id": "heater_status_func",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Return status",
        "func": "msg.payload = {\n  status: flow.get('heater_status') || 'off',\n  temperature: flow.get('heater_temperature') || 0,\n  timeHeating: flow.get('heater_timeHeating') || 0\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 640,
        "wires": [
            [
                "243260ce44651b69"
            ]
        ]
    },
    {
        "id": "heater_ws_event",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "heaterStopped event",
        "server": "heater_ws_server",
        "client": "",
        "x": 1520,
        "y": 740,
        "wires": []
    },
    {
        "id": "0b6c4efab6f01c4a",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "LED üí°",
        "info": "",
        "x": 1150,
        "y": 840,
        "wires": []
    },
    {
        "id": "a864210a8a3b6ce4",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/leds",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1000,
        "y": 900,
        "wires": [
            [
                "0308d90b5f2edb1d"
            ]
        ]
    },
    {
        "id": "275c4552aa1ace35",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1510,
        "y": 940,
        "wires": []
    },
    {
        "id": "leds_http_status",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/leds/status",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1020,
        "y": 940,
        "wires": [
            [
                "leds_func_status"
            ]
        ]
    },
    {
        "id": "leds_func_status",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Get LED status",
        "func": "msg.payload = { status: flow.get('leds_status') || 'off' };\nreturn msg;",
        "outputs": 1,
        "x": 1260,
        "y": 940,
        "wires": [
            [
                "275c4552aa1ace35"
            ]
        ]
    },
    {
        "id": "leds_http_on",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/leds/on",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 980,
        "wires": [
            [
                "leds_func_on"
            ]
        ]
    },
    {
        "id": "leds_func_on",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Turn ON",
        "func": "flow.set('leds_status', 'on');\nmsg.payload = { result: 'LEDs turned on' };\nnode.send([msg, {payload:'on'}]);\nreturn;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1240,
        "y": 980,
        "wires": [
            [
                "275c4552aa1ace35"
            ],
            [
                "leds_ws_event"
            ]
        ]
    },
    {
        "id": "leds_http_off",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/leds/off",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 1020,
        "wires": [
            [
                "leds_func_off"
            ]
        ]
    },
    {
        "id": "leds_func_off",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Turn OFF",
        "func": "flow.set('leds_status', 'off');\nmsg.payload = { result: 'LEDs turned off' };\nnode.send([msg, {payload:'off'}]);\nreturn;",
        "outputs": 2,
        "x": 1240,
        "y": 1020,
        "wires": [
            [
                "275c4552aa1ace35"
            ],
            [
                "leds_ws_event"
            ]
        ]
    },
    {
        "id": "leds_http_blink",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/leds/blink",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1020,
        "y": 1060,
        "wires": [
            [
                "leds_func_blink"
            ]
        ]
    },
    {
        "id": "leds_func_blink",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Blink LEDs",
        "func": "flow.set('leds_status', 'blinking');\nmsg.payload = { result: 'LEDs are blinking' };\nnode.send([msg, {payload:'blinking'}]);\nreturn;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 1060,
        "wires": [
            [
                "275c4552aa1ace35"
            ],
            [
                "leds_ws_event"
            ]
        ]
    },
    {
        "id": "leds_ws_event",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "ledStateChanged event",
        "server": "leds_ws_server",
        "client": "",
        "x": 1550,
        "y": 1020,
        "wires": []
    },
    {
        "id": "9bbc9801e3348ec8",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 34",
        "func": "\nconst heaterTD = {\n    \"@context\": [\n        \"[http://www.w3.org/ns/td](http://www.w3.org/ns/td)\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"Heater\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"temperature\": {\n            \"title\": \"Current temperature\",\n            \"description\": \"Shows the target temperature of the heater (¬∞C)\",\n            \"type\": \"integer\",\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/heater/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"readproperty\"\n                    ]\n                }\n            ]\n        },\n        \"timeHeating\": {\n            \"title\": \"Time heating\",\n            \"description\": \"Remaining heating time in minutes\",\n            \"type\": \"integer\",\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/heater/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"readproperty\"\n                    ]\n                }\n            ]\n        },\n        \"status\": {\n            \"title\": \"Status\",\n            \"description\": \"Current heater status\",\n            \"type\": \"string\",\n            \"enum\": [\n                \"on\",\n                \"off\"\n            ],\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/heater/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"readproperty\"\n                    ]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"startHeater\": {\n            \"title\": \"Start heater\",\n            \"description\": \"Starts the heater at the given temperature for the given time\",\n            \"input\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"temperature\": {\n                        \"type\": \"integer\",\n                        \"description\": \"The temperature in degrees C\"\n                    },\n                    \"timeHeating\": {\n                        \"type\": \"integer\",\n                        \"description\": \"Minutes to keep heater on\"\n                    }\n                },\n                \"required\": [\n                    \"temperature\",\n                    \"timeHeating\"\n                ]\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/heater/startHeater\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"invokeaction\"\n                    ]\n                }\n            ]\n        },\n        \"stopHeater\": {\n            \"title\": \"Stop heater\",\n            \"description\": \"Stops the heater immediately\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/heater/stopHeater\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"invokeaction\"\n                    ]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"heaterStopped\": {\n            \"title\": \"Heater stopped\",\n            \"description\": \"Raised when the heater stops (timeout or manual stop)\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"ws://localhost:1880/things/heater/heaterStopped\",\n                    \"subprotocol\": \"websocket\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"subscribeevent\"\n                    ]\n                }\n            ]\n        }\n    }\n}\n\n\n\n\nflow.set(\"heaterTD\", heaterTD);\n\nmsg.payload = heaterTD\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 580,
        "wires": [
            [
                "243260ce44651b69"
            ]
        ]
    },
    {
        "id": "0308d90b5f2edb1d",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 33",
        "func": "\nconst ledsTD = {\n    \"@context\": [\n        \"[http://www.w3.org/ns/td](http://www.w3.org/ns/td)\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"LEDs\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"status\": {\n            \"title\": \"LED Status\",\n            \"description\": \"Current state of the LEDs\",\n            \"type\": \"string\",\n            \"enum\": [\"on\", \"off\", \"blinking\"],\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/leds/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"blink\": {\n            \"title\": \"Blink LEDs\",\n            \"description\": \"Blinks the LEDs\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/leds/blink\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"LEDsOn\": {\n            \"title\": \"Turn LEDs on\",\n            \"description\": \"Turns on the LEDs\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/leds/on\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"LEDsOff\": {\n            \"title\": \"Turn LEDs off\",\n            \"description\": \"Turns off the LEDs\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/leds/off\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"ledStateChanged\": {\n            \"title\": \"LED state changed\",\n            \"description\": \"Emitted when the LED status changes\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"ws://localhost:1880/things/leds/ledStateChanged\",\n                    \"subprotocol\": \"websocket\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"subscribeevent\"]\n                }\n            ]\n        }\n    }\n}\n\n\n\n\n\nflow.set(\"ledsTD\", ledsTD);\n\nmsg.payload = ledsTD\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 900,
        "wires": [
            [
                "275c4552aa1ace35"
            ]
        ]
    },
    {
        "id": "d7ce2041238cba7b",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Main Room LightüèÆ",
        "info": "",
        "x": 290,
        "y": 940,
        "wires": []
    },
    {
        "id": "b4cfa409b44f5158",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/mainroomlight",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 1000,
        "wires": [
            [
                "ac8331939a955d42"
            ]
        ]
    },
    {
        "id": "ac8331939a955d42",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 32",
        "func": "\nconst mainRoomLight = {\n    \"@context\": [\n        \"[http://www.w3.org/ns/td](http://www.w3.org/ns/td)\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"MainRoomLight\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"status\": {\n            \"title\": \"Light status\",\n            \"description\": \"Current state of the main room light\",\n            \"type\": \"string\",\n            \"enum\": [\"on\", \"off\"],\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/mainroomlight/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"lightOn\": {\n            \"title\": \"Turn light on\",\n            \"description\": \"Turns the light on\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/mainroomlight/on\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"lightOff\": {\n            \"title\": \"Turn light off\",\n            \"description\": \"Turns the light off\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/mainroomlight/off\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"lightStateChanged\": {\n            \"title\": \"Light state changed\",\n            \"description\": \"Emitted whenever the main room light changes state\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"ws://localhost:1880/things/mainroomlight/lightStateChanged\",\n                    \"subprotocol\": \"websocket\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"subscribeevent\"]\n                }\n            ]\n        }\n    }\n}\n\n\n\n\n\n\nflow.set(\"mainRoomLight\", mainRoomLight);\n\nmsg.payload = mainRoomLight\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 1000,
        "wires": [
            [
                "e0bac71316f1678e"
            ]
        ]
    },
    {
        "id": "e0bac71316f1678e",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 590,
        "y": 1000,
        "wires": []
    },
    {
        "id": "mrl_http_status",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/mainroomlight/status",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 1060,
        "wires": [
            [
                "mrl_func_status"
            ]
        ]
    },
    {
        "id": "mrl_func_status",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Get status",
        "func": "msg.payload = { status: flow.get('mrl_status') || 'off' };\nreturn msg;",
        "outputs": 1,
        "x": 370,
        "y": 1060,
        "wires": [
            [
                "e0bac71316f1678e"
            ]
        ]
    },
    {
        "id": "mrl_http_on",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/mainroomlight/on",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 1140,
        "wires": [
            [
                "mrl_func_on"
            ]
        ]
    },
    {
        "id": "mrl_func_on",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Turn ON",
        "func": "flow.set('mrl_status', 'on');\nmsg.payload = { result: 'Main room light turned on' };\nnode.send([msg, {payload: 'on'}]);\nreturn;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 1140,
        "wires": [
            [
                "e0bac71316f1678e"
            ],
            [
                "mrl_ws_event"
            ]
        ]
    },
    {
        "id": "mrl_http_off",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/mainroomlight/off",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 1220,
        "wires": [
            [
                "mrl_func_off"
            ]
        ]
    },
    {
        "id": "mrl_func_off",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Turn OFF",
        "func": "flow.set('mrl_status', 'off');\nmsg.payload = { result: 'Main room light turned off' };\nnode.send([msg, {payload: 'off'}]);\nreturn;",
        "outputs": 2,
        "x": 360,
        "y": 1220,
        "wires": [
            [
                "e0bac71316f1678e"
            ],
            [
                "mrl_ws_event"
            ]
        ]
    },
    {
        "id": "mrl_ws_event",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "lightStateChanged event",
        "server": "mrl_ws_server",
        "client": "",
        "x": 650,
        "y": 1160,
        "wires": []
    },
    {
        "id": "daa8773bee0aa4b8",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Motion Sensor üèÉ‚Äç‚ôÇÔ∏è",
        "info": "",
        "x": 1190,
        "y": 1120,
        "wires": []
    },
    {
        "id": "a4f21a3fddc74c14",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/MotionSensor",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1030,
        "y": 1180,
        "wires": [
            [
                "983aba754cc04d05"
            ]
        ]
    },
    {
        "id": "983aba754cc04d05",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 35",
        "func": "\nconst motionSensor = {\n    \"@context\": [\n        \"[http://www.w3.org/ns/td](http://www.w3.org/ns/td)\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"MotionSensor\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {},\n    \"actions\": {},\n    \"events\": {\n        \"motionDetected\": {\n            \"title\": \"Motion detected\",\n            \"description\": \"An event emitted when motion is detected\",\n            \"data\": {\n                \"type\": \"string\",\n                \"description\": \"Timestamp when motion was detected\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"ws://localhost:1880/things/motionsensor/motiondetected\",\n                    \"subprotocol\": \"wot\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"subscribeevent\",\n                        \"unsubscribeevent\"\n                    ]\n                }\n            ]\n        }\n    }\n}\n\n\n\n\n\n\nflow.set(\"motionSensor\", motionSensor);\n\nmsg.payload = motionSensor\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 1180,
        "wires": [
            [
                "e939c9b93b4fc4e9"
            ]
        ]
    },
    {
        "id": "e939c9b93b4fc4e9",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1490,
        "y": 1180,
        "wires": []
    },
    {
        "id": "ms_inject_motion",
        "type": "inject",
        "z": "7e0f78b972841d3a",
        "name": "Simulate motion",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 1000,
        "y": 1240,
        "wires": [
            [
                "ms_func_motion"
            ]
        ]
    },
    {
        "id": "ms_func_motion",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Generate event",
        "func": "let now = new Date().toISOString();\nmsg.payload = { \"event\": \"motionDetected\", \"time\": now };\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1280,
        "y": 1240,
        "wires": [
            [
                "ms_ws_motion"
            ]
        ]
    },
    {
        "id": "ms_ws_motion",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "",
        "server": "ms_ws_server",
        "client": "",
        "x": 1560,
        "y": 1240,
        "wires": []
    },
    {
        "id": "36811e5482c2a320",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Smart Assistant ü§ñ",
        "info": "",
        "x": 1190,
        "y": 1300,
        "wires": []
    },
    {
        "id": "c3bf5be4af0a0aef",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/smartassistant",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1030,
        "y": 1360,
        "wires": [
            [
                "c11051e1c8c3b9d5"
            ]
        ]
    },
    {
        "id": "c11051e1c8c3b9d5",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 36",
        "func": "\nconst smartAssistant = {\n    \"@context\": [\n        \"http://www.w3.org/ns/td\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"SmartAssistant\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"actions\": {\n        \"say\": {\n            \"title\": \"Say phrase\",\n            \"description\": \"Makes the assistant say the given phrase\",\n            \"input\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"phrase\": {\n                        \"type\": \"string\",\n                        \"description\": \"The phrase to be spoken by this assistant\"\n                    }\n                },\n                \"required\": [\"phrase\"]\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/smartassistant/say\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"properties\": {},\n    \"events\": {}\n}\n\n\n\n\n\n\n\nflow.set(\"smartAssistant\", smartAssistant);\n\nmsg.payload = smartAssistant\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1270,
        "y": 1360,
        "wires": [
            [
                "6b2c0c5eddf92660"
            ]
        ]
    },
    {
        "id": "6b2c0c5eddf92660",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1490,
        "y": 1380,
        "wires": []
    },
    {
        "id": "sa_http_say",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/smartassistant/say",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1050,
        "y": 1420,
        "wires": [
            [
                "sa_func_say"
            ]
        ]
    },
    {
        "id": "sa_func_say",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Handle phrase",
        "func": "let body = msg.payload;\n\nif(body && body.phrase){\n    node.status({fill:\"green\",shape:\"dot\",text:\"Saying: \" + body.phrase});\n    msg.payload = { \"result\": \"Assistant said: \" + body.phrase };\n} else {\n    msg.statusCode = 400;\n    msg.payload = { \"error\": \"Missing 'phrase' in body\" };\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1280,
        "y": 1420,
        "wires": [
            [
                "6b2c0c5eddf92660"
            ]
        ]
    },
    {
        "id": "538907384348d888",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Speaker üîä",
        "info": "",
        "x": 270,
        "y": 1280,
        "wires": []
    },
    {
        "id": "c411a6b92a5be8c4",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/speaker",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 1340,
        "wires": [
            [
                "d5ce126e1d9311d9"
            ]
        ]
    },
    {
        "id": "d5ce126e1d9311d9",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 37",
        "func": "\nconst speaker = {\n    \"@context\": [\n        \"http://www.w3.org/ns/td\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"Speaker\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"volume\": {\n            \"title\": \"Volume\",\n            \"description\": \"The current volume percentage\",\n            \"type\": \"integer\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/speaker/volume\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"setVolume\": {\n            \"title\": \"Set volume\",\n            \"description\": \"Sets the volume of this speaker\",\n            \"input\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"percentage\": {\n                        \"type\": \"integer\",\n                        \"minimum\": 0,\n                        \"maximum\": 100,\n                        \"description\": \"The volume percentage (0‚Äì100)\"\n                    }\n                },\n                \"required\": [\"percentage\"]\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/speaker/setVolume\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"getVolume\": {\n            \"title\": \"Get volume\",\n            \"description\": \"Gets the current volume of this speaker\",\n            \"output\": {\n                \"type\": \"integer\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/speaker/getVolume\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {}\n}\n\n\n\n\n\n\n\nflow.set(\"speaker\", speaker);\n\nmsg.payload = speaker\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 1340,
        "wires": [
            [
                "18531c0c2853be4a"
            ]
        ]
    },
    {
        "id": "18531c0c2853be4a",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 590,
        "y": 1400,
        "wires": []
    },
    {
        "id": "sp_http_setVolume",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/speaker/setVolume",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 1400,
        "wires": [
            [
                "sp_func_setVolume"
            ]
        ]
    },
    {
        "id": "sp_func_setVolume",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Set volume",
        "func": "let body = msg.payload;\nif(body && body.percentage !== undefined){\n    let vol = parseInt(body.percentage);\n    if(vol < 0) vol = 0;\n    if(vol > 100) vol = 100;\n    flow.set(\"speaker_volume\", vol);\n    msg.payload = { \"result\": \"Volume set to \" + vol, \"volume\": vol };\n} else {\n    msg.statusCode = 400;\n    msg.payload = { \"error\": \"Missing 'percentage' in body\" };\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 1400,
        "wires": [
            [
                "18531c0c2853be4a"
            ]
        ]
    },
    {
        "id": "sp_http_getVolume",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/speaker/getVolume",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 160,
        "y": 1460,
        "wires": [
            [
                "sp_func_getVolume"
            ]
        ]
    },
    {
        "id": "sp_func_getVolume",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Get volume",
        "func": "let vol = flow.get(\"speaker_volume\") || 50; // default 50\nmsg.payload = { \"volume\": vol };\nreturn msg;",
        "outputs": 1,
        "x": 410,
        "y": 1460,
        "wires": [
            [
                "18531c0c2853be4a"
            ]
        ]
    },
    {
        "id": "sp_http_getVolume_property",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/speaker/volume",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 1520,
        "wires": [
            [
                "sp_func_getVolume"
            ]
        ]
    },
    {
        "id": "5464a89eb7ef0bda",
        "type": "http request",
        "z": "7e0f78b972841d3a",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/wm/status",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 390,
        "y": 420,
        "wires": [
            [
                "cf86740517719117"
            ]
        ]
    },
    {
        "id": "11eb8ebcf326cd85",
        "type": "inject",
        "z": "7e0f78b972841d3a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 420,
        "wires": [
            [
                "5464a89eb7ef0bda"
            ]
        ]
    },
    {
        "id": "b7614e84e21bc41c",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "",
        "server": "459ec480e7d4d173",
        "client": "",
        "x": 640,
        "y": 480,
        "wires": []
    },
    {
        "id": "0916e7905bc65d3d",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "",
        "server": "b929aa6c1471be56",
        "client": "",
        "x": 1510,
        "y": 480,
        "wires": []
    },
    {
        "id": "n3_motion_detected",
        "type": "websocket in",
        "z": "884a6474ca06ebd3",
        "name": "",
        "server": "",
        "client": "91c8ec522b374b97",
        "x": 330,
        "y": 340,
        "wires": [
            [
                "n4_light_on"
            ]
        ]
    },
    {
        "id": "n4_light_on",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Turn Main Room Light On",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/mainroomlight/on",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 710,
        "y": 340,
        "wires": [
            [
                "beb18f02d4914e95"
            ]
        ]
    },
    {
        "id": "n6_get_volume",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Get Speaker Volume",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/speaker/volume",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 260,
        "y": 680,
        "wires": [
            [
                "n7_store_volume",
                "94079233a707c01d"
            ]
        ]
    },
    {
        "id": "n7_store_volume",
        "type": "function",
        "z": "884a6474ca06ebd3",
        "name": "Store Volume",
        "func": "flow.set('prevVolume', msg.payload);\nmsg.payload = {\"percentage\": 10}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 280,
        "y": 740,
        "wires": [
            [
                "n8_set_low_volume"
            ]
        ]
    },
    {
        "id": "n8_set_low_volume",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Set Speaker Volume Low",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/speaker/setVolume",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 250,
        "y": 800,
        "wires": [
            [
                "b5ad05a01ef47912",
                "363aaeed881bc84d"
            ]
        ]
    },
    {
        "id": "n9_say_doorbell",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "SmartAssistant Say Doorbell",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/smartassistant/say",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 240,
        "y": 960,
        "wires": [
            [
                "n10_restore_volume",
                "c2c7e445eb8b8101"
            ]
        ]
    },
    {
        "id": "n10_restore_volume",
        "type": "function",
        "z": "884a6474ca06ebd3",
        "name": "Restore Volume Payload",
        "func": "var prev = flow.get('prevVolume');\nif (typeof prev === 'object' && prev !== null && prev.hasOwnProperty('volume')) {\n    msg.payload = { \"percentage\": prev.volume };\n} else if (typeof prev === 'number') {\n    msg.payload = { \"percentage\": prev };\n} else {\n    msg.payload = { \"percentage\": 50 };\n}\nreturn msg;",
        "outputs": 1,
        "x": 250,
        "y": 1020,
        "wires": [
            [
                "n11_set_restore_volume"
            ]
        ]
    },
    {
        "id": "n11_set_restore_volume",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Restore Speaker Volume",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/speaker/setVolume",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 250,
        "y": 1080,
        "wires": [
            [
                "7772f383032adf6d"
            ]
        ]
    },
    {
        "id": "n13_start_heater",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Start Heater 30C 20min",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/heater/start",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 830,
        "y": 460,
        "wires": [
            [
                "2eb5592b3e331dc8"
            ]
        ]
    },
    {
        "id": "e7f0e6696fc45206",
        "type": "websocket in",
        "z": "884a6474ca06ebd3",
        "name": "",
        "server": "",
        "client": "c53c11b411a8dbad",
        "x": 350,
        "y": 220,
        "wires": [
            [
                "d54d7e2b17b5b6cf"
            ]
        ]
    },
    {
        "id": "d54d7e2b17b5b6cf",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Blink LEDs",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/leds/blink",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 690,
        "y": 200,
        "wires": [
            [
                "1e28f9495e35705c"
            ]
        ]
    },
    {
        "id": "1e28f9495e35705c",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 20",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 880,
        "y": 200,
        "wires": []
    },
    {
        "id": "d174306ab43da204",
        "type": "inject",
        "z": "884a6474ca06ebd3",
        "name": "Manual blink (test)",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "payload": "",
        "payloadType": "date",
        "x": 450,
        "y": 180,
        "wires": [
            [
                "d54d7e2b17b5b6cf"
            ]
        ]
    },
    {
        "id": "beb18f02d4914e95",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 21",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 940,
        "y": 340,
        "wires": []
    },
    {
        "id": "4c6d6713bf9f27a0",
        "type": "inject",
        "z": "884a6474ca06ebd3",
        "name": "Manual Test",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 350,
        "y": 400,
        "wires": [
            [
                "4f317d9f70b6a0bb"
            ]
        ]
    },
    {
        "id": "6a82f47ba7f6d6be",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 22",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 280,
        "y": 520,
        "wires": []
    },
    {
        "id": "2eb5592b3e331dc8",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 23",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1100,
        "y": 440,
        "wires": []
    },
    {
        "id": "60dcc738f1b793a5",
        "type": "websocket in",
        "z": "884a6474ca06ebd3",
        "name": "",
        "server": "",
        "client": "91c8ec522b374b97",
        "x": 210,
        "y": 460,
        "wires": [
            [
                "6a82f47ba7f6d6be",
                "4f317d9f70b6a0bb"
            ]
        ]
    },
    {
        "id": "4f317d9f70b6a0bb",
        "type": "function",
        "z": "884a6474ca06ebd3",
        "name": "set params",
        "func": "msg.payload = {\n    \"temperature\": 30,\n    \"timeHeating\": 30\n}",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 460,
        "wires": [
            [
                "n13_start_heater"
            ]
        ]
    },
    {
        "id": "34d007d424e5561a",
        "type": "websocket in",
        "z": "884a6474ca06ebd3",
        "name": "",
        "server": "19b93c24ab8e2161",
        "client": "",
        "x": 210,
        "y": 620,
        "wires": [
            [
                "n6_get_volume",
                "351060c42d2d5285"
            ]
        ]
    },
    {
        "id": "351060c42d2d5285",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 24",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 620,
        "wires": []
    },
    {
        "id": "94079233a707c01d",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 25",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 680,
        "wires": []
    },
    {
        "id": "b5ad05a01ef47912",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 26",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 800,
        "wires": []
    },
    {
        "id": "cc64ed2b39bf39cc",
        "type": "tab",
        "label": "Coffee Machine",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "ff0f90c1e6ac2159",
        "type": "tab",
        "label": "Light",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "292a46ef9ad25949",
        "type": "tab",
        "label": "smart home",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "cc58a035b207933b",
        "type": "tab",
        "label": "virtual things",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "a97c70509c313bc5",
        "type": "tab",
        "label": "Flow 2",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "03751bef0ed5432b",
        "type": "tab",
        "label": "Flow 1",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "7e0f78b972841d3a",
        "type": "tab",
        "label": "SmartHome Setup",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "884a6474ca06ebd3",
        "type": "tab",
        "label": "SmartHome Apps",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "consumedThing1",
        "type": "consumed-thing",
        "tdLink": "/things/thing1",
        "td": "{\"@context\":\"https://www.w3.org/2019/wot/td/v1\",\"id\":\"urn:dev:ops:virtual-thing1\",\"title\":\"LED\",\"security\":[\"nosec\"],\"properties\":{\"status\":{\"type\":\"object\",\"properties\":{\"status\":{\"type\":\"number\"}},\"description\":\"LED 0 (OFF) / 1 (ON) status\",\"observable\":false,\"forms\":[{\"href\":\"http://localhost:1880/things/thing1/properties/status\",\"contentType\":\"application/json\",\"op\":[\"readproperty\",\"writeproperty\"]}]}},\"actions\":{\"toggle\":{\"description\":\"Toggle LED state\",\"forms\":[{\"href\":\"http://localhost:1880/things/thing1/actions/toggle\",\"contentType\":\"application/json\",\"op\":\"invokeaction\"}],\"output\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"number\"}},\"required\":[\"result\"]}}},\"forms\":[{\"href\":\"http://localhost:1880/things/thing1\",\"contentType\":\"application/td+json\"}]}",
        "http": true,
        "ws": false,
        "coap": false,
        "mqtt": false,
        "opcua": false,
        "modbus": false,
        "basicAuth": false,
        "username": "",
        "password": ""
    },
    {
        "id": "6b22e72718942046",
        "type": "consumed-thing",
        "tdLink": "http://localhost:1880/things/thing2",
        "td": "{\"@context\":\"https://www.w3.org/2019/wot/td/v1\",\"id\":\"urn:dev:ops:virtual-thing1\",\"title\":\"Thing2\",\"security\":[\"nosec\"],\"properties\":{\"level\":{\"type\":\"object\",\"forms\":[{\"href\":\"http://localhost:1880/things/thing2/properties/level\",\"contentType\":\"application/json\"}]}},\"actions\":{\"set\":{\"input\":{\"level\":{\"type\":\"number\"}},\"output\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"number\"}},\"required\":[\"result\"]},\"forms\":[{\"href\":\"http://localhost:1880/things/thing2/actions/set\",\"contentType\":\"application/json\"}]}},\"forms\":[{\"href\":\"http://localhost:1880/things/thing2\",\"contentType\":\"application/td+json\"}]}",
        "http": true,
        "ws": false,
        "coap": false,
        "mqtt": false,
        "opcua": false,
        "modbus": false,
        "basicAuth": false,
        "username": "",
        "password": ""
    },
    {
        "id": "2805a003dbd2b617",
        "type": "consumed-thing",
        "tdLink": "/things/thing3",
        "td": "{\"@context\":\"https://www.w3.org/2019/wot/td/v1\",\"id\":\"urn:dev:ops:thing1-temperature\",\"title\":\"Temperature Sensor\",\"@type\":\"TemperatureSensor\",\"securityDefinitions\":{\"nosec_sc\":{\"scheme\":\"nosec\"}},\"security\":\"nosec_sc\",\"properties\":{\"temperature\":{\"type\":\"number\",\"description\":\"Current temperature in Celsius\",\"observable\":false,\"readOnly\":true,\"forms\":[{\"href\":\"http://localhost:1880/things/thing3/properties/temperature\",\"contentType\":\"application/json\",\"op\":\"readproperty\"}]}}}",
        "http": true,
        "ws": false,
        "coap": false,
        "mqtt": false,
        "opcua": false,
        "modbus": false,
        "basicAuth": false,
        "username": "",
        "password": ""
    },
    {
        "id": "ac55d78eefcd2910",
        "type": "wot-server-config",
        "name": "test",
        "bindingType": "http",
        "bindingConfigType": "json",
        "bindingConfigConstValue": "{\"port\":8080,\"allowSelfSigned\":true}"
    },
    {
        "id": "44c6b99c601f73e9",
        "type": "wot-thing-config",
        "name": "test_thing1_title",
        "description": "test_thing1_description",
        "thingId": "test_thing1_id",
        "basicAuth": false,
        "basicAuthUsername": "",
        "basicAuthPassword": ""
    },
    {
        "id": "wot-server-config",
        "type": "wot-server-config",
        "name": "HTTP Server",
        "bindingType": "http",
        "bindingConfigType": "json",
        "bindingConfigConstValue": "{\"port\":8080,\"allowSelfSigned\":true}"
    },
    {
        "id": "4dbe15cf1fe3bdcf",
        "type": "wot-thing-config",
        "name": "LED",
        "description": "LED Thing",
        "thingId": "urn:dev:ops:virtual-thing1",
        "basicAuth": false,
        "basicAuthUsername": "",
        "basicAuthPassword": ""
    },
    {
        "id": "7e5ac8c08c681ae6",
        "type": "global-config",
        "env": [],
        "modules": {}
    },
    {
        "id": "a0db95b029fcfd65",
        "type": "websocket-listener",
        "path": "things/doorbell/bellrung",
        "wholemsg": "false"
    },
    {
        "id": "63485395a50b29c0",
        "type": "websocket-client",
        "path": "ws:http://localhost:1880/things/doorbell/bellrung",
        "tls": "",
        "wholemsg": "false",
        "hb": "0",
        "subprotocol": "",
        "headers": []
    },
    {
        "id": "heater_ws_server",
        "type": "websocket-listener",
        "path": "/things/heater/heaterStopped",
        "wholemsg": "false"
    },
    {
        "id": "leds_ws_server",
        "type": "websocket-listener",
        "path": "/things/leds/ledStateChanged",
        "wholemsg": "false"
    },
    {
        "id": "mrl_ws_server",
        "type": "websocket-listener",
        "path": "/things/mainroomlight/lightStateChanged",
        "wholemsg": "false"
    },
    {
        "id": "ms_ws_server",
        "type": "websocket-listener",
        "path": "/things/motionsensor/motiondetected",
        "wholemsg": "false"
    },
    {
        "id": "b929aa6c1471be56",
        "type": "websocket-listener",
        "path": "/things/alarm/ringing",
        "wholemsg": "false"
    },
    {
        "id": "c53c11b411a8dbad",
        "type": "websocket-client",
        "path": "ws:http://localhost:1880/things/wm/finishedCycle",
        "tls": "",
        "wholemsg": "false",
        "hb": "0",
        "subprotocol": "",
        "headers": []
    },
    {
        "id": "91c8ec522b374b97",
        "type": "websocket-client",
        "path": "ws://localhost:1880/things/alarm/ringing",
        "tls": "",
        "wholemsg": "false",
        "hb": "0",
        "subprotocol": "",
        "headers": []
    },
    {
        "id": "459ec480e7d4d173",
        "type": "websocket-listener",
        "path": "/things/wm/finishedCycle",
        "wholemsg": "false"
    },
    {
        "id": "3373b7e3eaad3463",
        "type": "websocket-listener",
        "path": "/things/doorbell/rung",
        "wholemsg": "false"
    },
    {
        "id": "19b93c24ab8e2161",
        "type": "websocket-listener",
        "path": "ws://localhost:1880/things/doorbell/rung",
        "wholemsg": "false"
    },
    {
        "id": "e53a62303d308de7",
        "type": "http in",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "url": "/monitor/feed",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 250,
        "y": 400,
        "wires": [
            [
                "307dbda4d8a76975"
            ]
        ]
    },
    {
        "id": "a6b14e74ad9fe7ac",
        "type": "http response",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 730,
        "y": 400,
        "wires": []
    },
    {
        "id": "cc3a889258fa43f5",
        "type": "template",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html>\n    <head>\n        <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/slate/bootstrap.min.css\" integrity=\"sha384-8iuq0iaMHpnH2vSyvZMSIqQuUnQA7QM+f6srIdlgBrTSEyd//AWNMyEaSF2yPzNQ\" crossorigin=\"anonymous\">\n    </head>\n    <body class=\"container\">\n        <div class=\"row\">\n            <h1>Feed</h1>\n        </div>\n        <div class=\"row\">\n            <div class=\"col-md-6\">\n                <div class=\"table-responsive\">\n                    <table class=\"table table-sm\">\n                        <thead>\n                            <tr>\n                                <th scope=\"col\">Name</th>\n                                <th scope=\"col\">URL</th>\n                                <th scope=\"col\">Actions</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {{#payload}}\n                            <tr class=\"table-primary\">\n                                <td>{{name}}</th>\n                                <td>{{url}}</td>\n                                <td>\n                                    <a href=\"/monitor/feed/delete/{{rowid}}\" class=\"btn btn-outline-danger\">Delete</a>\n                                </td>\n                            </tr>\n                            {{/payload}}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n            <div class=\"col-md-6\">\n                <form method=\"post\" action=\"/monitor/feed\">\n                    <label for=\"name\" class=\"col-form-label\">Name</label>\n                    <input type=\"text\" class=\"form-control\" id=\"name\" name=\"name\">\n\n                    <label for=\"url\" class=\"col-form-label\">URL</label>\n                    <input type=\"text\" class=\"form-control\" id=\"url\" name=\"url\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Add</button>\n\n                </form>\n            </div>\n        </div>\n    </body>\n</html>",
        "output": "str",
        "x": 580,
        "y": 400,
        "wires": [
            [
                "a6b14e74ad9fe7ac"
            ]
        ]
    },
    {
        "id": "307dbda4d8a76975",
        "type": "sqlite",
        "z": "2f8fa64411c4e91f",
        "mydb": "",
        "sqlquery": "fixed",
        "sql": "SELECT rowid, * FROM feed",
        "name": "db",
        "x": 430,
        "y": 400,
        "wires": [
            [
                "cc3a889258fa43f5"
            ]
        ]
    },
    {
        "id": "acf2916d00c75435",
        "type": "debug",
        "z": "2f8fa64411c4e91f",
        "name": "debug 2",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 520,
        "wires": []
    },
    {
        "id": "80fe5eb505233305",
        "type": "http in",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "url": "/monitor/feed",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 230,
        "y": 460,
        "wires": [
            [
                "4210a65b74195fd6"
            ]
        ]
    },
    {
        "id": "4210a65b74195fd6",
        "type": "template",
        "z": "2f8fa64411c4e91f",
        "name": "INSERT",
        "field": "topic",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "INSERT INTO feed VALUES ('{{{payload.name}}}', '{{{payload.url}}}')",
        "output": "str",
        "x": 440,
        "y": 460,
        "wires": [
            [
                "ce30774f5d0ea9e9"
            ]
        ]
    },
    {
        "id": "ce30774f5d0ea9e9",
        "type": "sqlite",
        "z": "2f8fa64411c4e91f",
        "mydb": "",
        "sqlquery": "msg.topic",
        "sql": "SELECT * FROM feed",
        "name": "db",
        "x": 590,
        "y": 460,
        "wires": [
            [
                "307dbda4d8a76975"
            ]
        ]
    },
    {
        "id": "7889f917e3e89641",
        "type": "http in",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "url": "/monitor/feed/delete/:rowid",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 190,
        "y": 520,
        "wires": [
            [
                "3ecf1fbe82d0684a"
            ]
        ]
    },
    {
        "id": "3ecf1fbe82d0684a",
        "type": "template",
        "z": "2f8fa64411c4e91f",
        "name": "DELETE",
        "field": "topic",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "DELETE FROM feed WHERE rowid = {{req.params.rowid}}",
        "output": "str",
        "x": 440,
        "y": 520,
        "wires": [
            [
                "acf2916d00c75435",
                "ce30774f5d0ea9e9"
            ]
        ]
    },
    {
        "id": "b98c5489c7a9100d",
        "type": "comment",
        "z": "2f8fa64411c4e91f",
        "name": "monitor/feed",
        "info": "",
        "x": 210,
        "y": 360,
        "wires": []
    },
    {
        "id": "c37f29a95c56cc33",
        "type": "comment",
        "z": "2f8fa64411c4e91f",
        "name": "monitor/keyword",
        "info": "",
        "x": 200,
        "y": 680,
        "wires": []
    },
    {
        "id": "5b82f3c27011e01b",
        "type": "http in",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "url": "/monitor/keyword",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 220,
        "y": 720,
        "wires": [
            [
                "2495b60ef64202e1"
            ]
        ]
    },
    {
        "id": "909a241581cca457",
        "type": "http response",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 740,
        "y": 720,
        "wires": []
    },
    {
        "id": "aac2fc05a4f4b451",
        "type": "template",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html>\n    <head>\n        <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/slate/bootstrap.min.css\" integrity=\"sha384-8iuq0iaMHpnH2vSyvZMSIqQuUnQA7QM+f6srIdlgBrTSEyd//AWNMyEaSF2yPzNQ\" crossorigin=\"anonymous\">\n    </head>\n    <body class=\"container\">\n        <div class=\"row\">\n            <h1>keyword</h1>\n        </div>\n        <div class=\"row\">\n            <div class=\"col-md-6\">\n                <div class=\"table-responsive\">\n                    <table class=\"table table-sm\">\n                        <thead>\n                            <tr>\n                                <th scope=\"col\">Expression</th>\n                                <th scope=\"col\">Actions</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {{#payload}}\n                            <tr class=\"table-primary\">\n                                <td>{{expression}}</th>\n                                <td>\n                                    <a href=\"/monitor/keyword/delete/{{rowid}}\" class=\"btn btn-outline-danger\">Delete</a>\n                                </td>\n                            </tr>\n                            {{/payload}}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n            <div class=\"col-md-6\">\n                <form method=\"post\" action=\"/monitor/keyword\">\n                    <label for=\"expression\" class=\"col-form-label\">Expression</label>\n                    <input type=\"text\" class=\"form-control\" id=\"expression\" name=\"expression\">\n\n                    <button type=\"submit\" class=\"btn btn-primary\">Add</button>\n\n                </form>\n            </div>\n        </div>\n    </body>\n</html>",
        "output": "str",
        "x": 590,
        "y": 720,
        "wires": [
            [
                "909a241581cca457"
            ]
        ]
    },
    {
        "id": "2495b60ef64202e1",
        "type": "sqlite",
        "z": "2f8fa64411c4e91f",
        "mydb": "",
        "sqlquery": "fixed",
        "sql": "SELECT rowid, * FROM keyword",
        "name": "db",
        "x": 440,
        "y": 720,
        "wires": [
            [
                "aac2fc05a4f4b451",
                "6ffc61b5552bb009"
            ]
        ]
    },
    {
        "id": "6ffc61b5552bb009",
        "type": "debug",
        "z": "2f8fa64411c4e91f",
        "name": "debug 4",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 800,
        "y": 840,
        "wires": []
    },
    {
        "id": "1e5bfc8973fad8e1",
        "type": "http in",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "url": "/monitor/keyword",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 240,
        "y": 780,
        "wires": [
            [
                "9e0b0b0f1bf3c685"
            ]
        ]
    },
    {
        "id": "9e0b0b0f1bf3c685",
        "type": "template",
        "z": "2f8fa64411c4e91f",
        "name": "INSERT",
        "field": "topic",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "INSERT INTO keyword VALUES ('{{{payload.expression}}}')",
        "output": "str",
        "x": 450,
        "y": 780,
        "wires": [
            [
                "2a8f3ed49fcdd8f1"
            ]
        ]
    },
    {
        "id": "2a8f3ed49fcdd8f1",
        "type": "sqlite",
        "z": "2f8fa64411c4e91f",
        "mydb": "",
        "sqlquery": "msg.topic",
        "sql": "SELECT * FROM keyword",
        "name": "db",
        "x": 600,
        "y": 780,
        "wires": [
            [
                "2495b60ef64202e1"
            ]
        ]
    },
    {
        "id": "3e0e6259c95bd951",
        "type": "http in",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "url": "/monitor/keyword/delete/:rowid",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 200,
        "y": 840,
        "wires": [
            [
                "6aca4d8220e706bb"
            ]
        ]
    },
    {
        "id": "6aca4d8220e706bb",
        "type": "template",
        "z": "2f8fa64411c4e91f",
        "name": "DELETE",
        "field": "topic",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "DELETE FROM keyword WHERE rowid = {{req.params.rowid}}",
        "output": "str",
        "x": 450,
        "y": 840,
        "wires": [
            [
                "6ffc61b5552bb009",
                "2a8f3ed49fcdd8f1"
            ]
        ]
    },
    {
        "id": "08e6c9142189376d",
        "type": "comment",
        "z": "2f8fa64411c4e91f",
        "name": "monitor",
        "info": "",
        "x": 130,
        "y": 60,
        "wires": []
    },
    {
        "id": "e5efc9498b0bbc67",
        "type": "http in",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "url": "/monitor",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 120,
        "wires": [
            [
                "4afb2899ff6cc25f"
            ]
        ]
    },
    {
        "id": "e3a4b56d84f8ece9",
        "type": "template",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html>\n    <head>\n        <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/slate/bootstrap.min.css\" integrity=\"sha384-8iuq0iaMHpnH2vSyvZMSIqQuUnQA7QM+f6srIdlgBrTSEyd//AWNMyEaSF2yPzNQ\" crossorigin=\"anonymous\">\n    </head>\n    <body>\n        <nav class=\"navbar navbar-expand-lg bg-primary\" data-bs-theme=\"dark\">\n            <div class=\"container-fluid\">\n                <a class=\"navbar-brand\" href=\"/monitor\">RSS Monitor</a>\n                <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarColor01\" aria-controls=\"navbarColor01\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span class=\"navbar-toggler-icon\"></span>\n                </button>\n                <div class=\"collapse navbar-collapse\" id=\"navbarColor01\">\n                    <ul class=\"navbar-nav me-auto\">\n                        <li class=\"nav-item\">\n                        <a class=\"nav-link active\" href=\"#\">Home\n                            <span class=\"visually-hidden\">(current)</span>\n                        </a>\n                        </li>\n                        <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"/monitor/feed\">Feed</a>\n                        </li>\n                        <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"/monitor/Keyword\">Keywords</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </nav>\n        <div class=\"container\">\n            <div class=\"row\">\n                <h1>Latest Stories</h1>\n                <div class=\"col-md-12\">\n                    <div class=\"table-responsive\">\n                        <table class=\"table table-sm\">\n                            <thead>\n                                <tr>\n                                    <th scope=\"col\">Headline</th>\n                                    <th scope=\"col\">Summary</th>\n                                    <th scope=\"col\">Sent</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {{#payload}}\n                                <tr class=\"table-primary\">\n                                    <td><a href=\"{{link}}\">{{title}}</a></td>\n                                    <td>{{description}}</td>\n                                    <td>{{sent}}</td>\n                                </tr>\n                                {{/payload}}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n    </body>\n</html>",
        "output": "str",
        "x": 340,
        "y": 200,
        "wires": [
            [
                "17970e87624224f9"
            ]
        ]
    },
    {
        "id": "17970e87624224f9",
        "type": "http response",
        "z": "2f8fa64411c4e91f",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 650,
        "y": 160,
        "wires": []
    },
    {
        "id": "4afb2899ff6cc25f",
        "type": "sqlite",
        "z": "2f8fa64411c4e91f",
        "mydb": "",
        "sqlquery": "fixed",
        "sql": "SELECT rowid, * FROM match\nORDER BY rowid DESC",
        "name": "db",
        "x": 170,
        "y": 200,
        "wires": [
            [
                "e3a4b56d84f8ece9",
                "151115fa863c54f5"
            ]
        ]
    },
    {
        "id": "151115fa863c54f5",
        "type": "debug",
        "z": "2f8fa64411c4e91f",
        "name": "debug 6",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 260,
        "wires": []
    },
    {
        "id": "7e448cb921f02719",
        "type": "feedparse",
        "z": "1086946b1acd1c45",
        "name": "espnSports",
        "url": "https://www.espn.com/espn/rss/news",
        "interval": "1",
        "ignorefirst": false,
        "x": 290,
        "y": 340,
        "wires": [
            [
                "56b6d95d87b265fd"
            ]
        ]
    },
    {
        "id": "56b6d95d87b265fd",
        "type": "switch",
        "z": "1086946b1acd1c45",
        "name": "",
        "property": "article.description",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "nfl",
                "vt": "str",
                "case": true
            },
            {
                "t": "regex",
                "v": "soccer",
                "vt": "str",
                "case": true
            },
            {
                "t": "regex",
                "v": "nba",
                "vt": "str",
                "case": true
            },
            {
                "t": "regex",
                "v": "superbowl",
                "vt": "str",
                "case": true
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 490,
        "y": 380,
        "wires": [
            [
                "4f212f8073dadb3b"
            ],
            [
                "4f212f8073dadb3b"
            ],
            [
                "4f212f8073dadb3b"
            ],
            [
                "4f212f8073dadb3b"
            ],
            []
        ]
    },
    {
        "id": "6e420775b906034a",
        "type": "e-mail",
        "z": "1086946b1acd1c45",
        "server": "smtp.gmail.com",
        "port": "465",
        "authtype": "BASIC",
        "saslformat": true,
        "token": "oauth2Response.access_token",
        "secure": true,
        "tls": true,
        "name": "qudoos92@gmail.com",
        "dname": "qudoos92@gmail.com",
        "x": 280,
        "y": 700,
        "wires": []
    },
    {
        "id": "4f212f8073dadb3b",
        "type": "change",
        "z": "1086946b1acd1c45",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "article.title",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "from",
                "pt": "msg",
                "to": "\"RSS Alert\" <rss-alert@noreply.com>",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 900,
        "y": 360,
        "wires": [
            [
                "ab259da0e45f7a7e"
            ]
        ]
    },
    {
        "id": "ab259da0e45f7a7e",
        "type": "template",
        "z": "1086946b1acd1c45",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{article.description}}\n\nRead more: {{{article.link}}}",
        "output": "str",
        "x": 940,
        "y": 440,
        "wires": [
            [
                "b46c435fe139eb57"
            ]
        ]
    },
    {
        "id": "b46c435fe139eb57",
        "type": "debug",
        "z": "1086946b1acd1c45",
        "name": "debug 1",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1240,
        "y": 600,
        "wires": []
    },
    {
        "id": "dcedc831fd3250f6",
        "type": "feedparse",
        "z": "1086946b1acd1c45",
        "name": "foxSports",
        "url": "https://api.foxsports.com/v2/content/optimized-rss?partnerKey=MB0Wehpmuj2lUhuRhQaafhBjAJqaPU244mlTDK1i&size=30",
        "interval": "1",
        "ignorefirst": false,
        "x": 260,
        "y": 440,
        "wires": [
            [
                "56b6d95d87b265fd"
            ]
        ]
    },
    {
        "id": "5ddd6be6d28d1633",
        "type": "comment",
        "z": "1086946b1acd1c45",
        "name": "RSS Reader (old hardcoded)",
        "info": "",
        "x": 340,
        "y": 300,
        "wires": []
    },
    {
        "id": "473f8c695590a0a6",
        "type": "inject",
        "z": "1086946b1acd1c45",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 80,
        "wires": [
            [
                "552f820dc96c8c24"
            ]
        ]
    },
    {
        "id": "552f820dc96c8c24",
        "type": "sqlite",
        "z": "1086946b1acd1c45",
        "mydb": "",
        "sqlquery": "fixed",
        "sql": "SELECT rowid, * FROM keyword",
        "name": "db",
        "x": 330,
        "y": 80,
        "wires": [
            [
                "715709815b8c6fa4"
            ]
        ]
    },
    {
        "id": "116ca2f2b9f17b18",
        "type": "debug",
        "z": "1086946b1acd1c45",
        "name": "debug 5",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 200,
        "wires": []
    },
    {
        "id": "715709815b8c6fa4",
        "type": "change",
        "z": "1086946b1acd1c45",
        "name": "keyword",
        "rules": [
            {
                "t": "set",
                "p": "keyword",
                "pt": "msg",
                "to": "$join(payload.expression, \"|\")",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 80,
        "wires": [
            [
                "5ff94b3fd31bd4ed"
            ]
        ]
    },
    {
        "id": "5ff94b3fd31bd4ed",
        "type": "sqlite",
        "z": "1086946b1acd1c45",
        "mydb": "",
        "sqlquery": "fixed",
        "sql": "SELECT rowid, * FROM feed",
        "name": "db",
        "x": 630,
        "y": 80,
        "wires": [
            [
                "89313d2bb8e13570"
            ]
        ]
    },
    {
        "id": "cbeb9d458de4311b",
        "type": "comment",
        "z": "1086946b1acd1c45",
        "name": "reading keywords",
        "info": "",
        "x": 320,
        "y": 40,
        "wires": []
    },
    {
        "id": "2efc380456e97a92",
        "type": "comment",
        "z": "1086946b1acd1c45",
        "name": "reading feed urls",
        "info": "",
        "x": 620,
        "y": 40,
        "wires": []
    },
    {
        "id": "89313d2bb8e13570",
        "type": "split",
        "z": "1086946b1acd1c45",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "property": "payload",
        "x": 810,
        "y": 80,
        "wires": [
            [
                "6a79874374f0148d"
            ]
        ]
    },
    {
        "id": "92eef555a1f1f2ee",
        "type": "http request",
        "z": "1086946b1acd1c45",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 1110,
        "y": 80,
        "wires": [
            [
                "9b152eaa55d9e4f9"
            ]
        ]
    },
    {
        "id": "6a79874374f0148d",
        "type": "change",
        "z": "1086946b1acd1c45",
        "name": "read url",
        "rules": [
            {
                "t": "move",
                "p": "payload.url",
                "pt": "msg",
                "to": "url",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 80,
        "wires": [
            [
                "92eef555a1f1f2ee"
            ]
        ]
    },
    {
        "id": "9b152eaa55d9e4f9",
        "type": "xml",
        "z": "1086946b1acd1c45",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 1250,
        "y": 80,
        "wires": [
            [
                "8016da3f69059762"
            ]
        ]
    },
    {
        "id": "8016da3f69059762",
        "type": "change",
        "z": "1086946b1acd1c45",
        "name": "read item",
        "rules": [
            {
                "t": "move",
                "p": "payload.rss.channel[0].item",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 80,
        "wires": [
            [
                "fdfda343e23ae1ae"
            ]
        ]
    },
    {
        "id": "fdfda343e23ae1ae",
        "type": "split",
        "z": "1086946b1acd1c45",
        "name": "split articles",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "property": "payload",
        "x": 1550,
        "y": 80,
        "wires": [
            [
                "14e108bada9af884"
            ]
        ]
    },
    {
        "id": "14e108bada9af884",
        "type": "switch",
        "z": "1086946b1acd1c45",
        "name": "match?",
        "property": "payload.description[0]",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "keyword",
                "vt": "msg",
                "case": true
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 280,
        "y": 200,
        "wires": [
            [
                "f7dfc0780169f43e"
            ],
            []
        ]
    },
    {
        "id": "f7dfc0780169f43e",
        "type": "template",
        "z": "1086946b1acd1c45",
        "name": "INSERT",
        "field": "topic",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "INSERT OR IGNORE INTO match VALUES (\n    '{{{payload.link.0}}}',\n    '{{{payload.title.0}}}',\n    '{{{payload.description.0}}}',\n    0\n    )",
        "output": "str",
        "x": 460,
        "y": 200,
        "wires": [
            [
                "e48ad60ebe289d4e"
            ]
        ]
    },
    {
        "id": "e48ad60ebe289d4e",
        "type": "sqlite",
        "z": "1086946b1acd1c45",
        "mydb": "",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "db",
        "x": 590,
        "y": 200,
        "wires": [
            [
                "116ca2f2b9f17b18"
            ]
        ]
    },
    {
        "id": "f03193a6b30ee14c",
        "type": "sqlite",
        "z": "25f9976e4245e54a",
        "mydb": "",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "db",
        "x": 490,
        "y": 260,
        "wires": [
            [
                "4d68165d1052f4d3"
            ]
        ]
    },
    {
        "id": "9e44fc5529c079b3",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "create feed",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "CREATE TABLE feed (name, url)",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 240,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "581d96fef6d96f6c",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "create keywords",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "CREATE TABLE keyword (expression)",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 280,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "743a0368088a1d0c",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "create match",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "CREATE TABLE match (link, title, description, sent, UNIQUE(link))",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 320,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "a2b962f082a0d473",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "drop match",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "DROP TABLE match",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 540,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "790e17ceae1e8530",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "drop keywords",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "DROP TABLE keyword",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 580,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "233c00a9d25780dc",
        "type": "inject",
        "z": "25f9976e4245e54a",
        "name": "drop feed",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "DROP TABLE feed",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 620,
        "wires": [
            [
                "f03193a6b30ee14c"
            ]
        ]
    },
    {
        "id": "26e55acf8ef3a451",
        "type": "comment",
        "z": "25f9976e4245e54a",
        "name": "table creation",
        "info": "",
        "x": 170,
        "y": 200,
        "wires": []
    },
    {
        "id": "85643a0b029e4458",
        "type": "comment",
        "z": "25f9976e4245e54a",
        "name": "table deletion",
        "info": "",
        "x": 190,
        "y": 500,
        "wires": []
    },
    {
        "id": "4d68165d1052f4d3",
        "type": "debug",
        "z": "25f9976e4245e54a",
        "name": "debug 3",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 320,
        "wires": []
    },
    
    
   
    {
        "id": "8a4ed3ab187dfd8b",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "/things/thing1",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 350,
        "y": 120,
        "wires": [
            [
                "735641927add8ab9"
            ]
        ]
    },
    {
        "id": "41d680860e0e195e",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 830,
        "y": 120,
        "wires": []
    },
    {
        "id": "735641927add8ab9",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 3",
        "func": "msg.payload = {\n    \"@context\": \"https://www.w3.org/2019/wot/td/v1\",\n    \"id\": \"urn:dev:ops:virtual-thing1\",\n    \"title\": \"LED\",\n    \"security\": [\"nosec\"],\n    \"properties\": {\n        \"status\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"status\": {\"type\": \"number\"}\n            },\n            \"description\": \"LED 0 (OFF) / 1 (ON) status\",\n            \"observable\": false,\n            \"forms\": [{\n                \"href\": \"http://localhost:1880/things/thing1/properties/status\",\n                \"contentType\": \"application/json\",\n                \"op\": [\"readproperty\", \"writeproperty\"] // specifies the kind of operation you can perform on that Thing‚Äôs property\n            }]\n        }\n    },\n    \"actions\": {\n        \"toggle\": {\n            \"description\": \"Toggle LED state\",\n            \"forms\": [{\n                \"href\": \"http://localhost:1880/things/thing1/actions/toggle\",\n                \"contentType\": \"application/json\",\n                \"op\": \"invokeaction\"\n            }],\n            \"output\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"result\": { \"type\": \"number\" }\n                },\n                \"required\": [\"result\"]\n            }\n        }\n    },\n    \"forms\": [{ \"href\": \"http://localhost:1880/things/thing1\", \"contentType\": \"application/td+json\" }]\n};\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 120,
        "wires": [
            [
                "41d680860e0e195e"
            ]
        ]
    },
    {
        "id": "5e91093c6b8a70ae",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing1/properties/status",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 300,
        "y": 160,
        "wires": [
            [
                "b94d44c7adbdaba0"
            ]
        ]
    },
    {
        "id": "e6d69e5b33ca9ada",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 830,
        "y": 160,
        "wires": []
    },
    {
        "id": "b94d44c7adbdaba0",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 4",
        "func": "let status = flow.get(\"thing1_status\") || 0;\n// ensure response header says JSON and payload is a valid JSON string\n// JSON.stringify produces a quoted JSON string, e.g. \"\\\"off\\\"\" so the body is valid JSON\n// msg.payload = JSON.stringify(status);\nmsg.headers = { \"Content-Type\": \"application/json\" };\n\nmsg.payload = {status: status};\n// msg.payload = {\"ashfaq\":\"gujjar\"};\nreturn msg;\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 160,
        "wires": [
            [
                "e6d69e5b33ca9ada"
            ]
        ]
    },
    {
        "id": "b92daf6a9f3e6c73",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing1/actions/toggle",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 300,
        "y": 240,
        "wires": [
            [
                "81d2cd6d030718e5"
            ]
        ]
    },
    {
        "id": "1859bf9eb5c050a8",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 830,
        "y": 240,
        "wires": []
    },
    {
        "id": "81d2cd6d030718e5",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 5",
        "func": "let cur = flow.get(\"thing1_status\") || 0;\nlet next = (cur === 1) ? 0 : 1;\nflow.set(\"thing1_status\", next);\nmsg.headers = { \"Content-Type\": \"application/json\" };\n\nmsg.payload = { result: next };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 240,
        "wires": [
            [
                "1859bf9eb5c050a8"
            ]
        ]
    },
    {
        "id": "110888335b4af917",
        "type": "comment",
        "z": "cc58a035b207933b",
        "name": "Thing 1 üî≥",
        "info": "",
        "x": 580,
        "y": 80,
        "wires": []
    },
    {
        "id": "18a236a5e192c745",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing2",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1170,
        "y": 120,
        "wires": [
            [
                "07a80a53dbc61b60"
            ]
        ]
    },
    {
        "id": "2443f335f3fb2757",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1650,
        "y": 120,
        "wires": []
    },
    {
        "id": "07a80a53dbc61b60",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 6",
        "func": "msg.payload = {\n    \"@context\": \"https://www.w3.org/2019/wot/td/v1\",\n    \"id\": \"urn:dev:ops:virtual-thing1\",\n    \"title\": \"Thing2\",\n    \"security\": [\"nosec\"],\n    \"properties\": {\n        \"level\": {\n            \"type\": \"object\",\n            \"forms\": [{ \"href\": \"http://localhost:1880/things/thing2/properties/level\", \"contentType\": \"application/json\" }]\n        }\n    },\n    \"actions\": {\n        \"set\": {\n            \"input\": {\n                \"level\": {\"type\": \"number\"}\n            },\n            \"output\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"result\": { \"type\": \"number\" }\n                },\n                \"required\": [\"result\"]\n            },\n            \"forms\": [{ \"href\": \"http://localhost:1880/things/thing2/actions/set\", \"contentType\": \"application/json\" }]\n        }\n    },\n    \"forms\": [{ \"href\": \"http://localhost:1880/things/thing2\", \"contentType\": \"application/td+json\" }]\n};\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1420,
        "y": 120,
        "wires": [
            [
                "2443f335f3fb2757"
            ]
        ]
    },
    {
        "id": "fd1854ec23d71b72",
        "type": "comment",
        "z": "cc58a035b207933b",
        "name": "Thing 2 üéöÔ∏è",
        "info": "",
        "x": 1400,
        "y": 80,
        "wires": []
    },
    {
        "id": "79b91ce738277634",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing2/properties/level",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1120,
        "y": 160,
        "wires": [
            [
                "7a9f57cf7c56f67d"
            ]
        ]
    },
    {
        "id": "7a9f57cf7c56f67d",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 7",
        "func": "let level = flow.get(\"thing2_level\") || 0;\n\n// msg.payload = { level: level };\nmsg.headers = { \"Content-Type\": \"application/json\" };\n\nmsg.payload = {level: level};\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1420,
        "y": 160,
        "wires": [
            [
                "d2c1f5509c1f3f92"
            ]
        ]
    },
    {
        "id": "d2c1f5509c1f3f92",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1650,
        "y": 160,
        "wires": []
    },
    {
        "id": "562be972678c59cd",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing2/actions/set",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1110,
        "y": 200,
        "wires": [
            [
                "9b8e98b60114d9b4"
            ]
        ]
    },
    {
        "id": "9b8e98b60114d9b4",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 8",
        "func": "let cur = flow.get(\"thing2_level\") || 0;\n\nlet newLevel = msg.payload.level;\n\n\nconsole.log(newLevel)\n\nflow.set(\"thing2_level\", newLevel);\nmsg.payload = { result: newLevel };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1420,
        "y": 200,
        "wires": [
            [
                "929f1e32310d68b7"
            ]
        ]
    },
    {
        "id": "929f1e32310d68b7",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1650,
        "y": 200,
        "wires": []
    },
    {
        "id": "fd11f7859657f741",
        "type": "read-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "consumedThing1",
        "property": "status",
        "uriVariables": "",
        "observe": false,
        "x": 500,
        "y": 320,
        "wires": [
            [
                "a60daa69daa3cf43"
            ]
        ]
    },
    {
        "id": "c66d34f9ca38d310",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 320,
        "wires": [
            [
                "fd11f7859657f741"
            ]
        ]
    },
    {
        "id": "a60daa69daa3cf43",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 8",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 320,
        "wires": []
    },
    {
        "id": "ada70435dcfb16c4",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{}",
        "payloadType": "json",
        "x": 270,
        "y": 460,
        "wires": [
            [
                "607169cd341ea1a7"
            ]
        ]
    },
    {
        "id": "607169cd341ea1a7",
        "type": "invoke-action",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "consumedThing1",
        "action": "toggle",
        "uriVariables": "",
        "x": 480,
        "y": 460,
        "wires": [
            [
                "acedfeb0872ebb01"
            ]
        ]
    },
    {
        "id": "acedfeb0872ebb01",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 9",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 700,
        "y": 460,
        "wires": []
    },
    {
        "id": "edf8d1051173eff9",
        "type": "read-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "6b22e72718942046",
        "property": "level",
        "uriVariables": "",
        "observe": false,
        "x": 1320,
        "y": 280,
        "wires": [
            [
                "ea324ebd27dd734d"
            ]
        ]
    },
    {
        "id": "ea324ebd27dd734d",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 10",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1480,
        "y": 280,
        "wires": []
    },
    {
        "id": "4249fad72e3668d8",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1120,
        "y": 280,
        "wires": [
            [
                "edf8d1051173eff9"
            ]
        ]
    },
    {
        "id": "528c5db4cdf5a59b",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload.level",
                "v": "4365",
                "vt": "json"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 1090,
        "y": 340,
        "wires": [
            [
                "f0585aa67aae714a"
            ]
        ]
    },
    {
        "id": "fff44dee89347b97",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 11",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1520,
        "y": 340,
        "wires": []
    },
    {
        "id": "f0585aa67aae714a",
        "type": "invoke-action",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "6b22e72718942046",
        "action": "set",
        "uriVariables": "",
        "x": 1310,
        "y": 340,
        "wires": [
            [
                "fff44dee89347b97"
            ]
        ]
    },
    {
        "id": "60d12f375dd04ea7",
        "type": "comment",
        "z": "cc58a035b207933b",
        "name": "Thing 3 üå°Ô∏è",
        "info": "",
        "x": 440,
        "y": 520,
        "wires": []
    },
    {
        "id": "878984fcb3e7fa2b",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing3",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 250,
        "y": 560,
        "wires": [
            [
                "da4a056474c12939"
            ]
        ]
    },
    {
        "id": "da4a056474c12939",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 9",
        "func": "msg.payload = {\n    \"@context\": \"https://www.w3.org/2019/wot/td/v1\",\n    \"id\": \"urn:dev:ops:thing1-temperature\",\n    \"title\": \"Temperature Sensor\",\n    \"@type\": \"TemperatureSensor\",\n    \"securityDefinitions\": {\n        \"nosec_sc\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"nosec_sc\",\n    \"properties\": {\n        \"temperature\": {\n            \"type\": \"number\",\n            \"description\": \"Current temperature in Celsius\",\n            \"observable\": false,\n            \"readOnly\": true,\n            \"forms\": [{\n                \"href\": \"http://localhost:1880/things/thing3/properties/temperature\",\n                \"contentType\": \"application/json\",\n                \"op\": \"readproperty\"\n            }]\n        }\n    }\n};\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 560,
        "wires": [
            [
                "9d77375305af9a1d"
            ]
        ]
    },
    {
        "id": "9d77375305af9a1d",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 730,
        "y": 560,
        "wires": []
    },
    {
        "id": "08b16fa03c92e05b",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing3/properties/temperature",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 180,
        "y": 600,
        "wires": [
            [
                "447a9a189fea64d9"
            ]
        ]
    },
    {
        "id": "447a9a189fea64d9",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 10",
        "func": "msg.headers = { \"Content-Type\": \"application/json\" };\n// Simulate temperature reading\nconst temperature = 20 + Math.random() * 10;\nmsg.payload = Math.round(temperature * 10) / 10\nreturn msg;\n\n\n\n\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 600,
        "wires": [
            [
                "61feeb5ff26d5844"
            ]
        ]
    },
    {
        "id": "61feeb5ff26d5844",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 730,
        "y": 600,
        "wires": []
    },
    {
        "id": "96c3630454762ddf",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "things/thing1/properties/status",
        "method": "put",
        "upload": false,
        "skipBodyParsing": true,
        "swaggerDoc": "",
        "x": 300,
        "y": 200,
        "wires": [
            [
                "501e5a45a73d651f"
            ]
        ]
    },
    {
        "id": "501e5a45a73d651f",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "PUT handler",
        "func": "let status = flow.get(\"thing1_status\") || 0;\n\nlet newStatus = msg.payload.status\n\nflow.set(\"thing1_status\", newStatus);\nmsg.headers = { \"Content-Type\": \"application/json\" };\nmsg.payload = {status: newStatus} ;\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 200,
        "wires": [
            [
                "aad25915a2c2cba2"
            ]
        ]
    },
    {
        "id": "aad25915a2c2cba2",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 830,
        "y": 200,
        "wires": []
    },
    {
        "id": "8858f4411b173d13",
        "type": "read-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "2805a003dbd2b617",
        "property": "temperature",
        "uriVariables": "",
        "observe": false,
        "x": 440,
        "y": 660,
        "wires": [
            [
                "0bdacab4ec4673c8"
            ]
        ]
    },
    {
        "id": "10baf861736e045b",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 660,
        "wires": [
            [
                "8858f4411b173d13"
            ]
        ]
    },
    {
        "id": "0bdacab4ec4673c8",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 12",
        "func": "const temp = msg.payload;\n\n// Turn LED on if temperature > 25¬∞C\nif (temp > 25) {\n    msg.payload = 1 ;\n} else {\n    msg.payload =  0;\n}\n\nnode.warn(`Temperature: ${temp}¬∞C, Turn LED: ${msg.payload.status ? 'ON' : 'OFF'}`);\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 690,
        "y": 660,
        "wires": [
            [
                "495b54d09868f344"
            ]
        ]
    },
    {
        "id": "495b54d09868f344",
        "type": "write-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "consumedThing1",
        "property": "status",
        "uriVariables": "",
        "x": 960,
        "y": 660,
        "wires": []
    },
    {
        "id": "8661bb87d65b7663",
        "type": "write-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "consumedThing1",
        "property": "status",
        "uriVariables": "",
        "x": 540,
        "y": 380,
        "wires": []
    },
    {
        "id": "9b071c87e279cfde",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 290,
        "y": 380,
        "wires": [
            [
                "8661bb87d65b7663"
            ]
        ]
    },
    {
        "id": "9408e25e2a656703",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 12",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 380,
        "wires": []
    },
    {
        "id": "d7435c30d7469770",
        "type": "write-property",
        "z": "cc58a035b207933b",
        "name": "",
        "topic": "",
        "thing": "consumedThing1",
        "property": "status",
        "uriVariables": "",
        "x": 540,
        "y": 420,
        "wires": []
    },
    {
        "id": "e3fc01ca972fe8bf",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 290,
        "y": 420,
        "wires": [
            [
                "d7435c30d7469770"
            ]
        ]
    },
    {
        "id": "4aec44236b06503c",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 13",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 420,
        "wires": []
    },
    {
        "id": "f1ca173d4329c4dc",
        "type": "comment",
        "z": "cc58a035b207933b",
        "name": "bad request",
        "info": "xpress / Node-RED‚Äôs JSON body parser rejects top-level JSON primitives (like true, false, 1) by default, so when the WoT client (or curl -d true) sends a bare boolean or number the server returns 400 Bad Request. That‚Äôs why \"true\" as a string or sending JSON objects sometimes ‚Äúworked‚Äù\n\nNode-RED/Express uses body-parser (express.json) with strict: true by default ‚Äî that only accepts objects and arrays as top-level JSON. Top-level primitives (boolean/number/string) are parsed as invalid JSON and the middleware rejects them with HTTP 400.",
        "x": 110,
        "y": 380,
        "wires": []
    },
    {
        "id": "17afd3b606e9bbe3",
        "type": "wot-fetch",
        "z": "cc58a035b207933b",
        "name": "",
        "tdUrl": "http://localhost:1880/things/thing1",
        "outputVar": "thingDescription",
        "outputVarType": "msg",
        "cacheTds": true,
        "cacheMinutes": 15,
        "x": 1180,
        "y": 860,
        "wires": [
            [
                "5f1e1995dbf9e016"
            ]
        ]
    },
    {
        "id": "5f1e1995dbf9e016",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 14",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1360,
        "y": 860,
        "wires": []
    },
    {
        "id": "c821d2bd8de98d11",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 980,
        "y": 860,
        "wires": [
            [
                "17afd3b606e9bbe3"
            ]
        ]
    },
    {
        "id": "da3ede03624ac29b",
        "type": "wot-discovery",
        "z": "cc58a035b207933b",
        "name": "",
        "useCoap": true,
        "coapUseIPv6": true,
        "coapIPv6Address": "all",
        "coapUseIPv4": false,
        "coapIPv4Address": "all",
        "useMqtt": "",
        "mqttBrokerAddress": "",
        "timeoutRemoval": true,
        "removalTime": 15,
        "msgOrContext": "msg",
        "msgProperty": "",
        "msgPropertyType": "msg",
        "contextVar": "",
        "contextVarType": "flow",
        "deleteExistingTDs": true,
        "coreURI": false,
        "tdURI": true,
        "useCoreRD": false,
        "coreRDUseIPv6": false,
        "coreRDUseIPv4": false,
        "x": 1180,
        "y": 800,
        "wires": [
            [
                "a21a20ce3d96a2c8"
            ]
        ]
    },
    {
        "id": "7aca786b1826d882",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 980,
        "y": 800,
        "wires": [
            [
                "da3ede03624ac29b"
            ]
        ]
    },
    {
        "id": "a21a20ce3d96a2c8",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 15",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1360,
        "y": 800,
        "wires": []
    },
    {
        "id": "0b93049c3525debd",
        "type": "function",
        "z": "cc58a035b207933b",
        "name": "function 11",
        "func": "msg.payload = {\n    \"thing1\": {\n        \"id\": \"urn:dev:ops:thing1\",\n            \"title\": \"Thing1\",\n                \"properties\": {\n            \"status\": {\n                \"type\": \"string\",\n                    \"forms\": [\n                        { \"href\": \"http://localhost:1880/things/thing1/properties/status\" }\n                    ]\n            }\n        },\n        \"actions\": {\n            \"toggle\": {\n                \"forms\": [\n                    { \"href\": \"http://localhost:1880/things/thing1/actions/toggle\" }\n                ]\n            }\n        }\n    },\n    \"thing2\": {\n        \"id\": \"urn:dev:ops:thing2\",\n            \"title\": \"Thing2\",\n                \"properties\": {\n            \"level\": {\n                \"type\": \"number\",\n                    \"forms\": [\n                        { \"href\": \"http://localhost:1880/things/thing2/properties/level\" }\n                    ]\n            }\n        },\n        \"actions\": {\n            \"set\": {\n                \"forms\": [\n                    { \"href\": \"http://localhost:1880/things/thing2/actions/set\" }\n                ]\n            }\n        }\n    },\n    \"thing3\": {\n        \"id\": \"urn:dev:ops:thing3\",\n            \"title\": \"Thing3\",\n                \"properties\": { /* ... */ },\n        \"actions\": { /* ... */ }\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 840,
        "wires": [
            [
                "7d8b07e0d66891f6"
            ]
        ]
    },
    {
        "id": "aabd9587c0606980",
        "type": "http in",
        "z": "cc58a035b207933b",
        "name": "",
        "url": "/things",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 190,
        "y": 840,
        "wires": [
            [
                "0b93049c3525debd"
            ]
        ]
    },
    {
        "id": "7d8b07e0d66891f6",
        "type": "http response",
        "z": "cc58a035b207933b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 550,
        "y": 840,
        "wires": []
    },
    {
        "id": "a1b2c3d4e5f6g7h8",
        "type": "inject",
        "z": "cc58a035b207933b",
        "name": "Poll Thing2 level",
        "props": [
            {
                "p": "interval",
                "v": "",
                "vt": "date"
            }
        ],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": "1",
        "topic": "",
        "x": 350,
        "y": 1040,
        "wires": [
            [
                "b2c3d4e5f6g7h8i9"
            ]
        ]
    },
    {
        "id": "b2c3d4e5f6g7h8i9",
        "type": "http request",
        "z": "cc58a035b207933b",
        "name": "Get Thing2 level",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/thing2/properties/level",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 550,
        "y": 1040,
        "wires": [
            [
                "c3d4e5f6g7h8i9j0"
            ]
        ]
    },
    {
        "id": "c3d4e5f6g7h8i9j0",
        "type": "switch",
        "z": "cc58a035b207933b",
        "name": "level > 5?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gt",
                "v": "5",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 750,
        "y": 1040,
        "wires": [
            [
                "d4e5f6g7h8i9j0k1"
            ]
        ]
    },
    {
        "id": "d4e5f6g7h8i9j0k1",
        "type": "change",
        "z": "cc58a035b207933b",
        "name": "Set LED ON payload",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "1",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 1040,
        "wires": [
            [
                "e5f6g7h8i9j0k1l2"
            ]
        ]
    },
    {
        "id": "e5f6g7h8i9j0k1l2",
        "type": "http request",
        "z": "cc58a035b207933b",
        "name": "Set Thing1 LED ON",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/thing1/properties/status",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "headers": {
            "Content-Type": "application/json"
        },
        "x": 1180,
        "y": 1040,
        "wires": [
            [
                "ee1a68c5326d7f73"
            ]
        ]
    },
    {
        "id": "ee1a68c5326d7f73",
        "type": "debug",
        "z": "cc58a035b207933b",
        "name": "debug 16",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1400,
        "y": 1040,
        "wires": []
    },
    {
        "id": "739d9c8003e4c39e",
        "type": "comment",
        "z": "03751bef0ed5432b",
        "name": "general",
        "info": "",
        "x": 730,
        "y": 200,
        "wires": []
    },
    {
        "id": "c3a206c85ac10da8",
        "type": "http in",
        "z": "03751bef0ed5432b",
        "name": "",
        "url": "/things",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 510,
        "y": 240,
        "wires": [
            [
                "703d79273ef1bebf"
            ]
        ]
    },
    {
        "id": "703d79273ef1bebf",
        "type": "function",
        "z": "03751bef0ed5432b",
        "name": "function 13",
        "func": "\nconst smartHomeTDs = [\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:alarm\",\n        \"title\": \"Alarm\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"events\": {\n            \"alarmRinging\": {\n                \"title\": \"Alarm Ringing\",\n                \"description\": \"This alarm has started ringing\",\n                \"data\": { \"type\": \"object\", \"properties\": { \"since\": { \"type\": \"string\", \"format\": \"date-time\" } } },\n                \"forms\": [\n                    {\n                        \"href\": \"http://localhost:1880/things/alarm/events/alarmRinging\",\n                        \"contentType\": \"text/event-stream\",\n                        \"op\": [\"subscribeevent\"]\n                    }\n                ]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/alarm\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:doorbell\",\n        \"title\": \"DoorBell\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"events\": {\n            \"bellRung\": {\n                \"title\": \"Bell rung\",\n                \"description\": \"The bell was rung\",\n                \"data\": { \"type\": \"object\", \"properties\": { \"when\": { \"type\": \"string\", \"format\": \"date-time\" } } },\n                \"forms\": [\n                    {\n                        \"href\": \"http://localhost:1880/things/doorbell/events/bellRung\",\n                        \"contentType\": \"text/event-stream\",\n                        \"op\": [\"subscribeevent\"]\n                    }\n                ]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/doorbell\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:heater\",\n        \"title\": \"Heater\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"actions\": {\n            \"startHeater\": {\n                \"title\": \"Start heater\",\n                \"description\": \"Starts the heater at the given temperature for the given time\",\n                \"input\": { \"type\": \"object\", \"properties\": { \"temperature\": { \"type\": \"integer\" }, \"timeHeating\": { \"type\": \"integer\" } }, \"required\": [\"temperature\"] },\n                \"output\": { \"type\": \"object\", \"properties\": { \"status\": { \"type\": \"string\" } } },\n                \"forms\": [\n                    { \"href\": \"http://localhost:1880/things/heater/actions/startHeater\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }\n                ]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/heater\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:leds\",\n        \"title\": \"LEDs\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"actions\": {\n            \"blink\": { \"title\": \"Blink LEDs\", \"input\": { \"type\": \"object\", \"properties\": { \"times\": { \"type\": \"integer\" } } }, \"forms\": [{ \"href\": \"http://localhost:1880/things/leds/actions/blink\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] },\n            \"LEDsOn\": { \"title\": \"Turn LEDs on\", \"forms\": [{ \"href\": \"http://localhost:1880/things/leds/actions/LEDsOn\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] },\n            \"LEDsOff\": { \"title\": \"Turn LEDs off\", \"forms\": [{ \"href\": \"http://localhost:1880/things/leds/actions/LEDsOff\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/leds\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:mainroomlight\",\n        \"title\": \"MainRoomLight\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"actions\": {\n            \"lightOn\": { \"title\": \"Turn light on\", \"forms\": [{ \"href\": \"http://localhost:1880/things/mainroomlight/actions/lightOn\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] },\n            \"lightOff\": { \"title\": \"Turn light off\", \"forms\": [{ \"href\": \"http://localhost:1880/things/mainroomlight/actions/lightOff\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/mainroomlight\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:motionsensor\",\n        \"title\": \"MotionSensor\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"events\": {\n            \"motionDetected\": {\n                \"title\": \"Motion detected\",\n                \"description\": \"An event made when motion is detected\",\n                \"data\": { \"type\": \"object\", \"properties\": { \"when\": { \"type\": \"string\", \"format\": \"date-time\" } } },\n                \"forms\": [{ \"href\": \"http://localhost:1880/things/motionsensor/events/motionDetected\", \"contentType\": \"text/event-stream\", \"op\": [\"subscribeevent\"] }]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/motionsensor\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:smartassistant\",\n        \"title\": \"SmartAssistant\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"actions\": {\n            \"say\": {\n                \"title\": \"Say phrase\",\n                \"input\": { \"type\": \"object\", \"properties\": { \"phrase\": { \"type\": \"string\" } }, \"required\": [\"phrase\"] },\n                \"forms\": [{ \"href\": \"http://localhost:1880/things/smartassistant/actions/say\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/smartassistant\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:speaker\",\n        \"title\": \"Speaker\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"actions\": {\n            \"setVolume\": { \"title\": \"Set volume\", \"input\": { \"type\": \"object\", \"properties\": { \"percentage\": { \"type\": \"integer\", \"minimum\": 0, \"maximum\": 100 } }, \"required\": [\"percentage\"] }, \"forms\": [{ \"href\": \"http://localhost:1880/things/speaker/actions/setVolume\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] },\n            \"getVolume\": { \"title\": \"Get volume\", \"output\": { \"type\": \"integer\" }, \"forms\": [{ \"href\": \"http://localhost:1880/things/speaker/actions/getVolume\", \"contentType\": \"application/json\", \"op\": [\"invokeaction\"], \"htv:methodName\": \"POST\" }] }\n        },\n        \"properties\": {\n            \"volume\": {\n                \"type\": \"integer\",\n                \"forms\": [{ \"href\": \"http://localhost:1880/things/speaker/properties/volume\", \"contentType\": \"application/json\", \"op\": [\"readproperty\", \"writeproperty\"], \"htv:methodName\": \"GET\" }]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/speaker\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    },\n\n    {\n        \"@context\": [\"https://www.w3.org/2019/wot/td/v1\"],\n        \"id\": \"urn:dev:ops:washingmachine\",\n        \"title\": \"WashingMachine\",\n        \"securityDefinitions\": { \"nosec\": { \"scheme\": \"nosec\" } },\n        \"security\": \"nosec\",\n        \"events\": {\n            \"finishedCycle\": {\n                \"title\": \"Wash cycle complete\",\n                \"description\": \"Sends a notification at the end of a wash cycle\",\n                \"data\": { \"type\": \"object\", \"properties\": { \"when\": { \"type\": \"string\", \"format\": \"date-time\" } } },\n                \"forms\": [{ \"href\": \"http://localhost:1880/things/washingmachine/events/finishedCycle\", \"contentType\": \"text/event-stream\", \"op\": [\"subscribeevent\"] }]\n            }\n        },\n        \"forms\": [{ \"href\": \"http://localhost:1880/things/washingmachine\", \"contentType\": \"application/td+json\", \"htv:methodName\": \"GET\" }]\n    }\n]\n\n\nflow.set(\"smartHomeTDs\", smartHomeTDs);\n\nmsg.payload = smartHomeTDs\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 240,
        "wires": [
            [
                "eff6097109cf9c60"
            ]
        ]
    },
    {
        "id": "eff6097109cf9c60",
        "type": "http response",
        "z": "03751bef0ed5432b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 970,
        "y": 240,
        "wires": []
    },
    {
        "id": "77179733c4cfcc89",
        "type": "http in",
        "z": "03751bef0ed5432b",
        "name": "",
        "url": "/things/:thingName",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 540,
        "y": 280,
        "wires": [
            [
                "eafddef2298f49ca"
            ]
        ]
    },
    {
        "id": "eafddef2298f49ca",
        "type": "function",
        "z": "03751bef0ed5432b",
        "name": "function 14",
        "func": "const thingName = msg.req.params.thingName\n\nconst smartHomeTDs = flow.get('smartHomeTDs')\n\nconst res = smartHomeTDs.find(obj => obj.title.toLowerCase() === thingName.toLowerCase());\n\nmsg.payload = res\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 280,
        "wires": [
            [
                "bd671f9ec0775ded"
            ]
        ]
    },
    {
        "id": "bd671f9ec0775ded",
        "type": "http response",
        "z": "03751bef0ed5432b",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 970,
        "y": 280,
        "wires": []
    },
    {
        "id": "f64b900a257005c8",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 15",
        "func": "\nconst washingMachineTD = {\n    \"@context\": \"http://www.w3.org/ns/td\",\n    \"@type\": [\"Thing\"],\n    \"title\": \"WashingMachine\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"status\": {\n            \"title\": \"Machine Status\",\n            \"description\": \"Current state of the washing machine\",\n            \"type\": \"string\",\n            \"enum\": [\"idle\", \"running\", \"finished\"],\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/wm/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        },\n        \"remainingTime\": {\n            \"title\": \"Time Left\",\n            \"description\": \"Remaining wash cycle time in minutes\",\n            \"type\": \"integer\",\n            \"unit\": \"minutes\",\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/wm/remainingTime\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"start\": {\n            \"title\": \"Start Washing Cycle\",\n            \"description\": \"Start a new wash program\",\n            \"input\": {\n                \"type\": \"string\",\n                \"enum\": [\"quick\", \"cotton\", \"wool\"]\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/wm/start\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"stop\": {\n            \"title\": \"Stop Cycle\",\n            \"description\": \"Immediately stop the wash program\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/wm/stop\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"finishedCycle\": {\n            \"title\": \"Wash cycle complete\",\n            \"description\": \"Sends a notification at the end of a wash cycle\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"ws://localhost:1880/things/wm/finishedCycle\",\n                    \"subprotocol\": \"websocket\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"subscribeevent\"]\n                },\n                {\n                    \"href\": \"http://localhost:1880/things/wm/finishedCycle\",\n                    \"subprotocol\": \"longpoll\"\n                }\n            ]\n        }\n    }\n}\n\n\n\nflow.set(\"washingMachineTD\", washingMachineTD);\n\nmsg.payload = washingMachineTD\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 220,
        "wires": [
            [
                "980a988016981af5"
            ]
        ]
    },
    {
        "id": "0db8ee0958e1ef02",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/wm",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 100,
        "y": 220,
        "wires": [
            [
                "f64b900a257005c8"
            ]
        ]
    },
    {
        "id": "0c1d3eb21c52f30b",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Washing Machine",
        "info": "",
        "x": 350,
        "y": 180,
        "wires": []
    },
    {
        "id": "1c85c21946fc3c7e",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 16",
        "func": "\n\nmsg.payload = \"test\"\n\n\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 330,
        "y": 80,
        "wires": [
            [
                "05a8bf26fa44989b",
                "c1376a597a4c11f1"
            ]
        ]
    },
    {
        "id": "05a8bf26fa44989b",
        "type": "debug",
        "z": "7e0f78b972841d3a",
        "name": "debug 17",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 560,
        "y": 80,
        "wires": []
    },
    {
        "id": "4ca82008fa95bfb8",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/test",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 100,
        "y": 80,
        "wires": [
            [
                "1c85c21946fc3c7e"
            ]
        ]
    },
    {
        "id": "c1376a597a4c11f1",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 550,
        "y": 120,
        "wires": []
    },
    {
        "id": "f79ce0f087c8a386",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "test",
        "info": "",
        "x": 310,
        "y": 40,
        "wires": []
    },
    {
        "id": "1b2b88797d05b5cc",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/wm/status",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 260,
        "wires": [
            [
                "c7c33a5af005f2f8"
            ]
        ]
    },
    {
        "id": "c7c33a5af005f2f8",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 17",
        "func": "msg.payload = { status: flow.get(\"wm_status\") || \"idle\" };\n\nmsg.headers = {\"Content-Type\": \"application/json\"};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 260,
        "wires": [
            [
                "980a988016981af5"
            ]
        ]
    },
    {
        "id": "ec15c7294110d82a",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/wm/remainingTime",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 300,
        "wires": [
            [
                "466337878f69cc40"
            ]
        ]
    },
    {
        "id": "466337878f69cc40",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 18",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\nmsg.payload = { remainingTime: flow.get(\"wm_time\") || 0 };\nreturn msg;\n\n\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 300,
        "wires": [
            [
                "980a988016981af5"
            ]
        ]
    },
    {
        "id": "980a988016981af5",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 590,
        "y": 300,
        "wires": []
    },
    {
        "id": "1047a1d416b06ec0",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/wm/start",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 340,
        "wires": [
            [
                "bab3d529a04c8321"
            ]
        ]
    },
    {
        "id": "bab3d529a04c8321",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 19",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\nlet program = msg.payload.program || \"quick\";\nflow.set(\"wm_status\", \"running\");\nflow.set(\"wm_time\", 30);   // default minutes for cycle\nmsg.payload = { message: \"Started program: \" + program };\nreturn msg;\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 340,
        "wires": [
            [
                "980a988016981af5"
            ]
        ]
    },
    {
        "id": "3bdb1f6328e8abd1",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/wm/stop",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 380,
        "wires": [
            [
                "7a59bddf7efa02c7"
            ]
        ]
    },
    {
        "id": "7a59bddf7efa02c7",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 20",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\nflow.set(\"wm_status\", \"idle\");\nflow.set(\"wm_time\", 0);\nmsg.payload = { message: \"Cycle stopped\" };\nreturn msg;\n\n\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 380,
        "wires": [
            [
                "980a988016981af5"
            ]
        ]
    },
    {
        "id": "bafc632bd18a7754",
        "type": "inject",
        "z": "7e0f78b972841d3a",
        "name": "cyclefinished",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 460,
        "wires": [
            [
                "f9b4498b4c077e78"
            ]
        ]
    },
    {
        "id": "f9b4498b4c077e78",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 21",
        "func": "let status = flow.get(\"wm_status\") || \"idle\";\nlet time = flow.get(\"wm_time\") || 0;\n\nif (status === \"running\") {\n    if (time > 0) {\n        flow.set(\"wm_time\", time - 1);\n    } else {\n        flow.set(\"wm_status\", \"finished\");\n        msg.payload = \"Cycle finished!\";\n        return msg;  // this triggers the event\n    }\n}\nreturn null;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 460,
        "wires": [
            [
                "cf86740517719117",
                "b7614e84e21bc41c"
            ]
        ]
    },
    {
        "id": "cf86740517719117",
        "type": "debug",
        "z": "7e0f78b972841d3a",
        "name": "debug 19",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 420,
        "wires": []
    },
    {
        "id": "d9158db16b493f76",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Alarm ‚è∞",
        "info": "",
        "x": 1260,
        "y": 40,
        "wires": []
    },
    {
        "id": "a88c5e8116986d94",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 22",
        "func": "\nconst alarmTD = {\n    \"@context\": [\n        \"[http://www.w3.org/ns/td](http://www.w3.org/ns/td)\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"Alarm\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"time\": {\n            \"title\": \"Alarm Time\",\n            \"description\": \"The scheduled alarm time in HH:MM format\",\n            \"type\": \"string\",\n            \"readOnly\": false,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/time\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\", \"writeproperty\"]\n                }\n            ]\n        },\n        \"enabled\": {\n            \"title\": \"Enabled\",\n            \"description\": \"Whether the alarm is active\",\n            \"type\": \"boolean\",\n            \"readOnly\": false,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/enabled\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\", \"writeproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"setTime\": {\n            \"title\": \"Set Alarm Time\",\n            \"input\": {\n                \"type\": \"string\",\n                \"pattern\": \"^([01]?[0-9]|2[0-3]):[0-5][0-9]$\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/setTime\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"toggle\": {\n            \"title\": \"Enable/Disable Alarm\",\n            \"input\": {\n                \"type\": \"boolean\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/toggle\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"stop\": {\n            \"title\": \"Stop Alarm\",\n            \"description\": \"Stops the ringing alarm\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/stop\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"alarmRinging\": {\n            \"title\": \"Alarm Ringing\",\n            \"description\": \"This alarm has started ringing\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/alarm/ringing\",\n                    \"subprotocol\": \"longpoll\"\n                }\n            ]\n        }\n    }\n}\n\n\n\n\nflow.set(\"alarmTD\", alarmTD);\n\nmsg.payload = alarmTD\n\n\nmsg.headers = {\"Content-Type\": \"application/td+json\"};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 100,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "3ee26586773f6ed6",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 990,
        "y": 100,
        "wires": [
            [
                "a88c5e8116986d94"
            ]
        ]
    },
    {
        "id": "09d90a7cda6f68bc",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 23",
        "func": "msg.headers = { \"Content-Type\": \"application/json\" };\n\nmsg.payload = { time: flow.get(\"alarm_time\") || \"07:00\" };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 140,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "8d8b844de244e471",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/time",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1000,
        "y": 140,
        "wires": [
            [
                "09d90a7cda6f68bc"
            ]
        ]
    },
    {
        "id": "e7034e583b904992",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 24",
        "func": "msg.headers = { \"Content-Type\": \"application/json\" };\n\n\nlet body = msg.payload;\nif (body && body.time) {\n    flow.set(\"alarm_time\", body.time);\n    msg.payload = { message: \"Alarm time set\", time: body.time };\n} else {\n    msg.payload = { error: \"Missing 'time' in payload\" };\n}\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 180,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "dec2294db8a50b06",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/time",
        "method": "put",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1000,
        "y": 180,
        "wires": [
            [
                "e7034e583b904992"
            ]
        ]
    },
    {
        "id": "5fc2563290de565a",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 25",
        "func": "msg.headers = { \"Content-Type\": \"application/json\" };\n\n\nmsg.payload = { enabled: flow.get(\"alarm_enabled\") || false };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 220,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "2c5c35b270e4fcd7",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/enabled",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 220,
        "wires": [
            [
                "5fc2563290de565a"
            ]
        ]
    },
    {
        "id": "7bdda896bc3a199a",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 26",
        "func": "msg.headers = { \"Content-Type\": \"application/json\" };\n\nlet body = msg.payload;\nif (typeof body.enabled === \"boolean\") {\n    flow.set(\"alarm_enabled\", body.enabled);\n    msg.payload = { message: \"Alarm state updated\", enabled: body.enabled };\n} else {\n    msg.payload = { error: \"Missing or invalid 'enabled' in payload\" };\n}\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 260,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "1558a1c9dd212174",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/enabled",
        "method": "put",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 260,
        "wires": [
            [
                "7bdda896bc3a199a"
            ]
        ]
    },
    {
        "id": "0c6ae03bc072140c",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1450,
        "y": 260,
        "wires": []
    },
    {
        "id": "9894c0ca898663cf",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/setTime",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1020,
        "y": 300,
        "wires": [
            [
                "bb7c8dc0c0046fad"
            ]
        ]
    },
    {
        "id": "bb7c8dc0c0046fad",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 27",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\nlet time = msg.payload.time;\nif (time) {\n    flow.set(\"alarm_time\", time);\n    msg.payload = { message: \"Alarm time set via action\", time: time };\n} else {\n    msg.payload = { error: \"Missing 'time' in payload\" };\n}\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 300,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "0e4613bcaa286270",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/toggle",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 340,
        "wires": [
            [
                "12b38ddbfce5a278"
            ]
        ]
    },
    {
        "id": "12b38ddbfce5a278",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 28",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\n// Get current state, default to false\nlet enabled = flow.get(\"alarm_enabled\") || false;\n\n// Reverse the state\nenabled = !enabled;\n\n// Save back to context\nflow.set(\"alarm_enabled\", enabled);\n\n// Return message\nmsg.payload = { message: \"Alarm \" + (enabled ? \"enabled\" : \"disabled\"), enabled: enabled };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 340,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "e26a5e445f1f8c37",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/alarm/stop",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1000,
        "y": 380,
        "wires": [
            [
                "8ea75e45c1e6b679"
            ]
        ]
    },
    {
        "id": "8ea75e45c1e6b679",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 29",
        "func": "msg.headers = {\"Content-Type\": \"application/json\"};\n\nflow.set(\"alarm_ringing\", false);\nmsg.payload = { message: \"Alarm stopped\" };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 380,
        "wires": [
            [
                "0c6ae03bc072140c"
            ]
        ]
    },
    {
        "id": "38c7f7332ac7bf1b",
        "type": "inject",
        "z": "7e0f78b972841d3a",
        "name": "alarmRinging",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1000,
        "y": 420,
        "wires": [
            [
                "24deede65dbf99b6"
            ]
        ]
    },
    {
        "id": "24deede65dbf99b6",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 30",
        "func": "let enabled = flow.get(\"alarm_enabled\") || false;\nlet alarmTime = flow.get(\"alarm_time\") || \"07:00\";\nlet ringing = flow.get(\"alarm_ringing\") || false;\n\nlet now = new Date();\nlet currentTime = now.getHours().toString().padStart(2, \"0\") + \":\" +\n    now.getMinutes().toString().padStart(2, \"0\");\n\nif (enabled && currentTime === alarmTime && !ringing) {\n    flow.set(\"alarm_ringing\", true);\n    msg.payload = \"Alarm ringing at \" + alarmTime;\n    return msg;  // emit event\n} else {\n    return null; // no event\n}\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 420,
        "wires": [
            [
                "2e37ea10f2d1ca2a",
                "0c6ae03bc072140c",
                "0916e7905bc65d3d"
            ]
        ]
    },
    {
        "id": "2e37ea10f2d1ca2a",
        "type": "debug",
        "z": "7e0f78b972841d3a",
        "name": "debug 18",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1460,
        "y": 420,
        "wires": []
    },
    {
        "id": "22c9bce343b64adb",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Door Bell üîî",
        "info": "",
        "x": 250,
        "y": 640,
        "wires": []
    },
    {
        "id": "304d9139fb042253",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/doorbell",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 680,
        "wires": [
            [
                "7e68f9973188a586"
            ]
        ]
    },
    {
        "id": "7e68f9973188a586",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 31",
        "func": "\nconst doorBellTD = {\n    \"@context\": [\n        \"http://www.w3.org/ns/td\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"DoorBell\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"enabled\": {\n            \"title\": \"Enabled\",\n            \"description\": \"Whether the doorbell is active\",\n            \"type\": \"boolean\",\n            \"readOnly\": false,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/doorbell/enabled\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\", \"writeproperty\"]\n                }\n            ]\n        },\n        \"lastRung\": {\n            \"title\": \"Last Rung\",\n            \"description\": \"Timestamp of the last ring\",\n            \"type\": \"string\",\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/doorbell/lastRung\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"toggle\": {\n            \"title\": \"Enable/Disable Doorbell\",\n            \"description\": \"Invert the current enabled state\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/doorbell/toggle\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"ring\": {\n            \"title\": \"Ring Doorbell\",\n            \"description\": \"Manually trigger the bell\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/doorbell/ring\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"bellRung\": {\n            \"title\": \"Bell rung\",\n            \"description\": \"The bell was rung\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/doorbell/bellRung\",\n                    \"subprotocol\": \"longpoll\"\n                }\n            ]\n        }\n    }\n}\n\n\nflow.set(\"doorBellTD\", doorBellTD);\n\nmsg.payload = doorBellTD\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 680,
        "wires": [
            [
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "db1_http_enabled_get",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "things/doorbell/enabled",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 720,
        "wires": [
            [
                "db1_func_enabled_get"
            ]
        ]
    },
    {
        "id": "db1_func_enabled_get",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Return enabled",
        "func": "msg.payload = { enabled: flow.get('doorbell_enabled') || true };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 380,
        "y": 720,
        "wires": [
            [
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "db1_http_enabled_put",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/doorbell/enabled",
        "method": "put",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 760,
        "wires": [
            [
                "db1_func_enabled_put"
            ]
        ]
    },
    {
        "id": "db1_func_enabled_put",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Update enabled",
        "func": "let body = msg.payload;\nif(typeof body.enabled === 'boolean'){\n    flow.set('doorbell_enabled', body.enabled);\n    msg.payload = { message: 'Doorbell ' + (body.enabled ? 'enabled' : 'disabled'), enabled: body.enabled };\n}else{\n    msg.payload = { error: 'Missing or invalid enabled' };\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 760,
        "wires": [
            [
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "db1_http_response_enabled_put",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 590,
        "y": 760,
        "wires": []
    },
    {
        "id": "db1_http_lastRung_get",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/doorbell/lastRung",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 800,
        "wires": [
            [
                "db1_func_lastRung_get"
            ]
        ]
    },
    {
        "id": "db1_func_lastRung_get",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Return lastRung",
        "func": "msg.payload = { lastRung: flow.get('doorbell_lastRung') || null };\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 800,
        "wires": [
            [
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "db1_http_toggle_post",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/doorbell/toggle",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 840,
        "wires": [
            [
                "db1_func_toggle"
            ]
        ]
    },
    {
        "id": "db1_func_toggle",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Toggle ",
        "func": "let enabled = flow.get('doorbell_enabled');\nif (enabled === undefined) {\n    enabled = true; // default first-time state\n}\nenabled = !enabled;\nflow.set('doorbell_enabled', enabled);\nmsg.payload = { message: 'Doorbell ' + (enabled ? 'enabled' : 'disabled'), enabled: enabled };\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 840,
        "wires": [
            [
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "c11848e672c4c22f",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/doorbell/ring",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 880,
        "wires": [
            [
                "6030e858ea7bc03e"
            ]
        ]
    },
    {
        "id": "6030e858ea7bc03e",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Ring bell",
        "func": "if(flow.get('doorbell_enabled')){\n    let now = new Date().toISOString();\n    flow.set('doorbell_lastRung', now);\n    msg.payload = 'Doorbell rang at ' + now;\n    return msg;\n} else {\n    msg.payload = 'Doorbell is disabled';\n    return msg;\n}",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 880,
        "wires": [
            [
                "674597642f429fbd",
                "db1_http_response_enabled_put"
            ]
        ]
    },
    {
        "id": "674597642f429fbd",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "",
        "server": "3373b7e3eaad3463",
        "client": "",
        "x": 610,
        "y": 860,
        "wires": []
    },
    {
        "id": "261fc1d97f1959b7",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Heater üî•",
        "info": "",
        "x": 1140,
        "y": 520,
        "wires": []
    },
    {
        "id": "999a16fd3ea27dc6",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/heater",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 990,
        "y": 580,
        "wires": [
            [
                "9bbc9801e3348ec8"
            ]
        ]
    },
    {
        "id": "243260ce44651b69",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1470,
        "y": 580,
        "wires": []
    },
    {
        "id": "heater_start_http",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/heater/start",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 700,
        "wires": [
            [
                "heater_start_func"
            ]
        ]
    },
    {
        "id": "heater_start_func",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Start heater",
        "func": "let body = msg.payload;\nif (typeof body.temperature === 'number' && typeof body.timeHeating === 'number') {\n    flow.set('heater_temperature', body.temperature);\n    flow.set('heater_timeHeating', body.timeHeating);\n    flow.set('heater_status', 'on');\n\n    // set timeout to stop heater\n    let timeout = body.timeHeating * 60000; // minutes ‚Üí ms\n    setTimeout(() => {\n        flow.set('heater_status', 'off');\n        flow.set('heater_timeHeating', 0);\n        let eventMsg = { payload: 'Heater stopped after timeout' };\n        node.send([null, eventMsg]);\n    }, timeout);\n\n    msg.payload = { message: 'Heater started', temperature: body.temperature, timeHeating: body.timeHeating };\n    return [msg, null];\n} else {\n    msg.payload = { error: 'Invalid input: expected {temperature:int, timeHeating:int}' };\n    return [msg, null];\n}",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 700,
        "wires": [
            [
                "243260ce44651b69"
            ],
            [
                "heater_ws_event"
            ]
        ]
    },
    {
        "id": "heater_stop_http",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/heater/stop",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 760,
        "wires": [
            [
                "heater_stop_func"
            ]
        ]
    },
    {
        "id": "heater_stop_func",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Stop heater",
        "func": "flow.set('heater_status', 'off');\nflow.set('heater_timeHeating', 0);\nmsg.payload = { message: 'Heater stopped manually' };\nreturn [msg, msg];",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 760,
        "wires": [
            [
                "243260ce44651b69"
            ],
            [
                "heater_ws_event"
            ]
        ]
    },
    {
        "id": "heater_status_http",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/heater/status",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 640,
        "wires": [
            [
                "heater_status_func"
            ]
        ]
    },
    {
        "id": "heater_status_func",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Return status",
        "func": "msg.payload = {\n  status: flow.get('heater_status') || 'off',\n  temperature: flow.get('heater_temperature') || 0,\n  timeHeating: flow.get('heater_timeHeating') || 0\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 640,
        "wires": [
            [
                "243260ce44651b69"
            ]
        ]
    },
    {
        "id": "heater_ws_event",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "heaterStopped event",
        "server": "heater_ws_server",
        "client": "",
        "x": 1520,
        "y": 740,
        "wires": []
    },
    {
        "id": "0b6c4efab6f01c4a",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "LED üí°",
        "info": "",
        "x": 1150,
        "y": 840,
        "wires": []
    },
    {
        "id": "a864210a8a3b6ce4",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/leds",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1000,
        "y": 900,
        "wires": [
            [
                "0308d90b5f2edb1d"
            ]
        ]
    },
    {
        "id": "275c4552aa1ace35",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1510,
        "y": 940,
        "wires": []
    },
    {
        "id": "leds_http_status",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/leds/status",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1020,
        "y": 940,
        "wires": [
            [
                "leds_func_status"
            ]
        ]
    },
    {
        "id": "leds_func_status",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Get LED status",
        "func": "msg.payload = { status: flow.get('leds_status') || 'off' };\nreturn msg;",
        "outputs": 1,
        "x": 1260,
        "y": 940,
        "wires": [
            [
                "275c4552aa1ace35"
            ]
        ]
    },
    {
        "id": "leds_http_on",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/leds/on",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 980,
        "wires": [
            [
                "leds_func_on"
            ]
        ]
    },
    {
        "id": "leds_func_on",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Turn ON",
        "func": "flow.set('leds_status', 'on');\nmsg.payload = { result: 'LEDs turned on' };\nnode.send([msg, {payload:'on'}]);\nreturn;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1240,
        "y": 980,
        "wires": [
            [
                "275c4552aa1ace35"
            ],
            [
                "leds_ws_event"
            ]
        ]
    },
    {
        "id": "leds_http_off",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/leds/off",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1010,
        "y": 1020,
        "wires": [
            [
                "leds_func_off"
            ]
        ]
    },
    {
        "id": "leds_func_off",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Turn OFF",
        "func": "flow.set('leds_status', 'off');\nmsg.payload = { result: 'LEDs turned off' };\nnode.send([msg, {payload:'off'}]);\nreturn;",
        "outputs": 2,
        "x": 1240,
        "y": 1020,
        "wires": [
            [
                "275c4552aa1ace35"
            ],
            [
                "leds_ws_event"
            ]
        ]
    },
    {
        "id": "leds_http_blink",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/leds/blink",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1020,
        "y": 1060,
        "wires": [
            [
                "leds_func_blink"
            ]
        ]
    },
    {
        "id": "leds_func_blink",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Blink LEDs",
        "func": "flow.set('leds_status', 'blinking');\nmsg.payload = { result: 'LEDs are blinking' };\nnode.send([msg, {payload:'blinking'}]);\nreturn;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 1060,
        "wires": [
            [
                "275c4552aa1ace35"
            ],
            [
                "leds_ws_event"
            ]
        ]
    },
    {
        "id": "leds_ws_event",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "ledStateChanged event",
        "server": "leds_ws_server",
        "client": "",
        "x": 1550,
        "y": 1020,
        "wires": []
    },
    {
        "id": "9bbc9801e3348ec8",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 34",
        "func": "\nconst heaterTD = {\n    \"@context\": [\n        \"[http://www.w3.org/ns/td](http://www.w3.org/ns/td)\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"Heater\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"temperature\": {\n            \"title\": \"Current temperature\",\n            \"description\": \"Shows the target temperature of the heater (¬∞C)\",\n            \"type\": \"integer\",\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/heater/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"readproperty\"\n                    ]\n                }\n            ]\n        },\n        \"timeHeating\": {\n            \"title\": \"Time heating\",\n            \"description\": \"Remaining heating time in minutes\",\n            \"type\": \"integer\",\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/heater/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"readproperty\"\n                    ]\n                }\n            ]\n        },\n        \"status\": {\n            \"title\": \"Status\",\n            \"description\": \"Current heater status\",\n            \"type\": \"string\",\n            \"enum\": [\n                \"on\",\n                \"off\"\n            ],\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/heater/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"readproperty\"\n                    ]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"startHeater\": {\n            \"title\": \"Start heater\",\n            \"description\": \"Starts the heater at the given temperature for the given time\",\n            \"input\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"temperature\": {\n                        \"type\": \"integer\",\n                        \"description\": \"The temperature in degrees C\"\n                    },\n                    \"timeHeating\": {\n                        \"type\": \"integer\",\n                        \"description\": \"Minutes to keep heater on\"\n                    }\n                },\n                \"required\": [\n                    \"temperature\",\n                    \"timeHeating\"\n                ]\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/heater/startHeater\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"invokeaction\"\n                    ]\n                }\n            ]\n        },\n        \"stopHeater\": {\n            \"title\": \"Stop heater\",\n            \"description\": \"Stops the heater immediately\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/heater/stopHeater\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"invokeaction\"\n                    ]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"heaterStopped\": {\n            \"title\": \"Heater stopped\",\n            \"description\": \"Raised when the heater stops (timeout or manual stop)\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"ws://localhost:1880/things/heater/heaterStopped\",\n                    \"subprotocol\": \"websocket\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"subscribeevent\"\n                    ]\n                }\n            ]\n        }\n    }\n}\n\n\n\n\nflow.set(\"heaterTD\", heaterTD);\n\nmsg.payload = heaterTD\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 580,
        "wires": [
            [
                "243260ce44651b69"
            ]
        ]
    },
    {
        "id": "0308d90b5f2edb1d",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 33",
        "func": "\nconst ledsTD = {\n    \"@context\": [\n        \"[http://www.w3.org/ns/td](http://www.w3.org/ns/td)\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"LEDs\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"status\": {\n            \"title\": \"LED Status\",\n            \"description\": \"Current state of the LEDs\",\n            \"type\": \"string\",\n            \"enum\": [\"on\", \"off\", \"blinking\"],\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/leds/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"blink\": {\n            \"title\": \"Blink LEDs\",\n            \"description\": \"Blinks the LEDs\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/leds/blink\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"LEDsOn\": {\n            \"title\": \"Turn LEDs on\",\n            \"description\": \"Turns on the LEDs\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/leds/on\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"LEDsOff\": {\n            \"title\": \"Turn LEDs off\",\n            \"description\": \"Turns off the LEDs\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/leds/off\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"ledStateChanged\": {\n            \"title\": \"LED state changed\",\n            \"description\": \"Emitted when the LED status changes\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"ws://localhost:1880/things/leds/ledStateChanged\",\n                    \"subprotocol\": \"websocket\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"subscribeevent\"]\n                }\n            ]\n        }\n    }\n}\n\n\n\n\n\nflow.set(\"ledsTD\", ledsTD);\n\nmsg.payload = ledsTD\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 900,
        "wires": [
            [
                "275c4552aa1ace35"
            ]
        ]
    },
    {
        "id": "d7ce2041238cba7b",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Main Room LightüèÆ",
        "info": "",
        "x": 290,
        "y": 940,
        "wires": []
    },
    {
        "id": "b4cfa409b44f5158",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/mainroomlight",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 130,
        "y": 1000,
        "wires": [
            [
                "ac8331939a955d42"
            ]
        ]
    },
    {
        "id": "ac8331939a955d42",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 32",
        "func": "\nconst mainRoomLight = {\n    \"@context\": [\n        \"[http://www.w3.org/ns/td](http://www.w3.org/ns/td)\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"MainRoomLight\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"status\": {\n            \"title\": \"Light status\",\n            \"description\": \"Current state of the main room light\",\n            \"type\": \"string\",\n            \"enum\": [\"on\", \"off\"],\n            \"readOnly\": true,\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/mainroomlight/status\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"lightOn\": {\n            \"title\": \"Turn light on\",\n            \"description\": \"Turns the light on\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/mainroomlight/on\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"lightOff\": {\n            \"title\": \"Turn light off\",\n            \"description\": \"Turns the light off\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/mainroomlight/off\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {\n        \"lightStateChanged\": {\n            \"title\": \"Light state changed\",\n            \"description\": \"Emitted whenever the main room light changes state\",\n            \"data\": {\n                \"type\": \"string\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"ws://localhost:1880/things/mainroomlight/lightStateChanged\",\n                    \"subprotocol\": \"websocket\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"subscribeevent\"]\n                }\n            ]\n        }\n    }\n}\n\n\n\n\n\n\nflow.set(\"mainRoomLight\", mainRoomLight);\n\nmsg.payload = mainRoomLight\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 1000,
        "wires": [
            [
                "e0bac71316f1678e"
            ]
        ]
    },
    {
        "id": "e0bac71316f1678e",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 590,
        "y": 1000,
        "wires": []
    },
    {
        "id": "mrl_http_status",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/mainroomlight/status",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 1060,
        "wires": [
            [
                "mrl_func_status"
            ]
        ]
    },
    {
        "id": "mrl_func_status",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Get status",
        "func": "msg.payload = { status: flow.get('mrl_status') || 'off' };\nreturn msg;",
        "outputs": 1,
        "x": 370,
        "y": 1060,
        "wires": [
            [
                "e0bac71316f1678e"
            ]
        ]
    },
    {
        "id": "mrl_http_on",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/mainroomlight/on",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 1140,
        "wires": [
            [
                "mrl_func_on"
            ]
        ]
    },
    {
        "id": "mrl_func_on",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Turn ON",
        "func": "flow.set('mrl_status', 'on');\nmsg.payload = { result: 'Main room light turned on' };\nnode.send([msg, {payload: 'on'}]);\nreturn;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 1140,
        "wires": [
            [
                "e0bac71316f1678e"
            ],
            [
                "mrl_ws_event"
            ]
        ]
    },
    {
        "id": "mrl_http_off",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/mainroomlight/off",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 140,
        "y": 1220,
        "wires": [
            [
                "mrl_func_off"
            ]
        ]
    },
    {
        "id": "mrl_func_off",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Turn OFF",
        "func": "flow.set('mrl_status', 'off');\nmsg.payload = { result: 'Main room light turned off' };\nnode.send([msg, {payload: 'off'}]);\nreturn;",
        "outputs": 2,
        "x": 360,
        "y": 1220,
        "wires": [
            [
                "e0bac71316f1678e"
            ],
            [
                "mrl_ws_event"
            ]
        ]
    },
    {
        "id": "mrl_ws_event",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "lightStateChanged event",
        "server": "mrl_ws_server",
        "client": "",
        "x": 650,
        "y": 1160,
        "wires": []
    },
    {
        "id": "daa8773bee0aa4b8",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Motion Sensor üèÉ‚Äç‚ôÇÔ∏è",
        "info": "",
        "x": 1190,
        "y": 1120,
        "wires": []
    },
    {
        "id": "a4f21a3fddc74c14",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/MotionSensor",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1030,
        "y": 1180,
        "wires": [
            [
                "983aba754cc04d05"
            ]
        ]
    },
    {
        "id": "983aba754cc04d05",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 35",
        "func": "\nconst motionSensor = {\n    \"@context\": [\n        \"[http://www.w3.org/ns/td](http://www.w3.org/ns/td)\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"MotionSensor\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {},\n    \"actions\": {},\n    \"events\": {\n        \"motionDetected\": {\n            \"title\": \"Motion detected\",\n            \"description\": \"An event emitted when motion is detected\",\n            \"data\": {\n                \"type\": \"string\",\n                \"description\": \"Timestamp when motion was detected\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"ws://localhost:1880/things/motionsensor/motiondetected\",\n                    \"subprotocol\": \"wot\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\n                        \"subscribeevent\",\n                        \"unsubscribeevent\"\n                    ]\n                }\n            ]\n        }\n    }\n}\n\n\n\n\n\n\nflow.set(\"motionSensor\", motionSensor);\n\nmsg.payload = motionSensor\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 1180,
        "wires": [
            [
                "e939c9b93b4fc4e9"
            ]
        ]
    },
    {
        "id": "e939c9b93b4fc4e9",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1490,
        "y": 1180,
        "wires": []
    },
    {
        "id": "ms_inject_motion",
        "type": "inject",
        "z": "7e0f78b972841d3a",
        "name": "Simulate motion",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 1000,
        "y": 1240,
        "wires": [
            [
                "ms_func_motion"
            ]
        ]
    },
    {
        "id": "ms_func_motion",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Generate event",
        "func": "let now = new Date().toISOString();\nmsg.payload = { \"event\": \"motionDetected\", \"time\": now };\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1280,
        "y": 1240,
        "wires": [
            [
                "ms_ws_motion"
            ]
        ]
    },
    {
        "id": "ms_ws_motion",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "",
        "server": "ms_ws_server",
        "client": "",
        "x": 1560,
        "y": 1240,
        "wires": []
    },
    {
        "id": "36811e5482c2a320",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Smart Assistant ü§ñ",
        "info": "",
        "x": 1190,
        "y": 1300,
        "wires": []
    },
    {
        "id": "c3bf5be4af0a0aef",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/smartassistant",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1030,
        "y": 1360,
        "wires": [
            [
                "c11051e1c8c3b9d5"
            ]
        ]
    },
    {
        "id": "c11051e1c8c3b9d5",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 36",
        "func": "\nconst smartAssistant = {\n    \"@context\": [\n        \"http://www.w3.org/ns/td\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"SmartAssistant\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"actions\": {\n        \"say\": {\n            \"title\": \"Say phrase\",\n            \"description\": \"Makes the assistant say the given phrase\",\n            \"input\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"phrase\": {\n                        \"type\": \"string\",\n                        \"description\": \"The phrase to be spoken by this assistant\"\n                    }\n                },\n                \"required\": [\"phrase\"]\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/smartassistant/say\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"properties\": {},\n    \"events\": {}\n}\n\n\n\n\n\n\n\nflow.set(\"smartAssistant\", smartAssistant);\n\nmsg.payload = smartAssistant\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1270,
        "y": 1360,
        "wires": [
            [
                "6b2c0c5eddf92660"
            ]
        ]
    },
    {
        "id": "6b2c0c5eddf92660",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 1490,
        "y": 1380,
        "wires": []
    },
    {
        "id": "sa_http_say",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/smartassistant/say",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1050,
        "y": 1420,
        "wires": [
            [
                "sa_func_say"
            ]
        ]
    },
    {
        "id": "sa_func_say",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Handle phrase",
        "func": "let body = msg.payload;\n\nif(body && body.phrase){\n    node.status({fill:\"green\",shape:\"dot\",text:\"Saying: \" + body.phrase});\n    msg.payload = { \"result\": \"Assistant said: \" + body.phrase };\n} else {\n    msg.statusCode = 400;\n    msg.payload = { \"error\": \"Missing 'phrase' in body\" };\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1280,
        "y": 1420,
        "wires": [
            [
                "6b2c0c5eddf92660"
            ]
        ]
    },
    {
        "id": "538907384348d888",
        "type": "comment",
        "z": "7e0f78b972841d3a",
        "name": "Speaker üîä",
        "info": "",
        "x": 270,
        "y": 1280,
        "wires": []
    },
    {
        "id": "c411a6b92a5be8c4",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/speaker",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 110,
        "y": 1340,
        "wires": [
            [
                "d5ce126e1d9311d9"
            ]
        ]
    },
    {
        "id": "d5ce126e1d9311d9",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "function 37",
        "func": "\nconst speaker = {\n    \"@context\": [\n        \"http://www.w3.org/ns/td\"\n    ],\n    \"@type\": [\n        \"Thing\"\n    ],\n    \"title\": \"Speaker\",\n    \"securityDefinitions\": {\n        \"no_sec\": {\n            \"scheme\": \"nosec\"\n        }\n    },\n    \"security\": \"no_sec\",\n    \"properties\": {\n        \"volume\": {\n            \"title\": \"Volume\",\n            \"description\": \"The current volume percentage\",\n            \"type\": \"integer\",\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/speaker/volume\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"readproperty\"]\n                }\n            ]\n        }\n    },\n    \"actions\": {\n        \"setVolume\": {\n            \"title\": \"Set volume\",\n            \"description\": \"Sets the volume of this speaker\",\n            \"input\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"percentage\": {\n                        \"type\": \"integer\",\n                        \"minimum\": 0,\n                        \"maximum\": 100,\n                        \"description\": \"The volume percentage (0‚Äì100)\"\n                    }\n                },\n                \"required\": [\"percentage\"]\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/speaker/setVolume\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        },\n        \"getVolume\": {\n            \"title\": \"Get volume\",\n            \"description\": \"Gets the current volume of this speaker\",\n            \"output\": {\n                \"type\": \"integer\"\n            },\n            \"forms\": [\n                {\n                    \"href\": \"http://localhost:1880/things/speaker/getVolume\",\n                    \"contentType\": \"application/json\",\n                    \"op\": [\"invokeaction\"]\n                }\n            ]\n        }\n    },\n    \"events\": {}\n}\n\n\n\n\n\n\n\nflow.set(\"speaker\", speaker);\n\nmsg.payload = speaker\n\n\nmsg.headers = {\n    \"Content-Type\": \"application/td+json\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 1340,
        "wires": [
            [
                "18531c0c2853be4a"
            ]
        ]
    },
    {
        "id": "18531c0c2853be4a",
        "type": "http response",
        "z": "7e0f78b972841d3a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 590,
        "y": 1400,
        "wires": []
    },
    {
        "id": "sp_http_setVolume",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/speaker/setVolume",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 1400,
        "wires": [
            [
                "sp_func_setVolume"
            ]
        ]
    },
    {
        "id": "sp_func_setVolume",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Set volume",
        "func": "let body = msg.payload;\nif(body && body.percentage !== undefined){\n    let vol = parseInt(body.percentage);\n    if(vol < 0) vol = 0;\n    if(vol > 100) vol = 100;\n    flow.set(\"speaker_volume\", vol);\n    msg.payload = { \"result\": \"Volume set to \" + vol, \"volume\": vol };\n} else {\n    msg.statusCode = 400;\n    msg.payload = { \"error\": \"Missing 'percentage' in body\" };\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 1400,
        "wires": [
            [
                "18531c0c2853be4a"
            ]
        ]
    },
    {
        "id": "sp_http_getVolume",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/speaker/getVolume",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 160,
        "y": 1460,
        "wires": [
            [
                "sp_func_getVolume"
            ]
        ]
    },
    {
        "id": "sp_func_getVolume",
        "type": "function",
        "z": "7e0f78b972841d3a",
        "name": "Get volume",
        "func": "let vol = flow.get(\"speaker_volume\") || 50; // default 50\nmsg.payload = { \"volume\": vol };\nreturn msg;",
        "outputs": 1,
        "x": 410,
        "y": 1460,
        "wires": [
            [
                "18531c0c2853be4a"
            ]
        ]
    },
    {
        "id": "sp_http_getVolume_property",
        "type": "http in",
        "z": "7e0f78b972841d3a",
        "name": "",
        "url": "/things/speaker/volume",
        "method": "get",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 1520,
        "wires": [
            [
                "sp_func_getVolume"
            ]
        ]
    },
    {
        "id": "5464a89eb7ef0bda",
        "type": "http request",
        "z": "7e0f78b972841d3a",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/wm/status",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 390,
        "y": 420,
        "wires": [
            [
                "cf86740517719117"
            ]
        ]
    },
    {
        "id": "11eb8ebcf326cd85",
        "type": "inject",
        "z": "7e0f78b972841d3a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 420,
        "wires": [
            [
                "5464a89eb7ef0bda"
            ]
        ]
    },
    {
        "id": "b7614e84e21bc41c",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "",
        "server": "459ec480e7d4d173",
        "client": "",
        "x": 640,
        "y": 480,
        "wires": []
    },
    {
        "id": "0916e7905bc65d3d",
        "type": "websocket out",
        "z": "7e0f78b972841d3a",
        "name": "",
        "server": "b929aa6c1471be56",
        "client": "",
        "x": 1510,
        "y": 480,
        "wires": []
    },
    {
        "id": "n3_motion_detected",
        "type": "websocket in",
        "z": "884a6474ca06ebd3",
        "name": "",
        "server": "",
        "client": "91c8ec522b374b97",
        "x": 330,
        "y": 340,
        "wires": [
            [
                "n4_light_on"
            ]
        ]
    },
    {
        "id": "n4_light_on",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Turn Main Room Light On",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/mainroomlight/on",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 710,
        "y": 340,
        "wires": [
            [
                "beb18f02d4914e95"
            ]
        ]
    },
    {
        "id": "n6_get_volume",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Get Speaker Volume",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/speaker/volume",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 260,
        "y": 680,
        "wires": [
            [
                "n7_store_volume",
                "94079233a707c01d"
            ]
        ]
    },
    {
        "id": "n7_store_volume",
        "type": "function",
        "z": "884a6474ca06ebd3",
        "name": "Store Volume",
        "func": "flow.set('prevVolume', msg.payload);\nmsg.payload = {\"percentage\": 10}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 280,
        "y": 740,
        "wires": [
            [
                "n8_set_low_volume"
            ]
        ]
    },
    {
        "id": "n8_set_low_volume",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Set Speaker Volume Low",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/speaker/setVolume",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 250,
        "y": 800,
        "wires": [
            [
                "b5ad05a01ef47912",
                "363aaeed881bc84d"
            ]
        ]
    },
    {
        "id": "n9_say_doorbell",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "SmartAssistant Say Doorbell",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/smartassistant/say",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 240,
        "y": 960,
        "wires": [
            [
                "n10_restore_volume",
                "c2c7e445eb8b8101"
            ]
        ]
    },
    {
        "id": "n10_restore_volume",
        "type": "function",
        "z": "884a6474ca06ebd3",
        "name": "Restore Volume Payload",
        "func": "var prev = flow.get('prevVolume');\nif (typeof prev === 'object' && prev !== null && prev.hasOwnProperty('volume')) {\n    msg.payload = { \"percentage\": prev.volume };\n} else if (typeof prev === 'number') {\n    msg.payload = { \"percentage\": prev };\n} else {\n    msg.payload = { \"percentage\": 50 };\n}\nreturn msg;",
        "outputs": 1,
        "x": 250,
        "y": 1020,
        "wires": [
            [
                "n11_set_restore_volume"
            ]
        ]
    },
    {
        "id": "n11_set_restore_volume",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Restore Speaker Volume",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/speaker/setVolume",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 250,
        "y": 1080,
        "wires": [
            [
                "7772f383032adf6d"
            ]
        ]
    },
    {
        "id": "n13_start_heater",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Start Heater 30C 20min",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/heater/start",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 830,
        "y": 460,
        "wires": [
            [
                "2eb5592b3e331dc8"
            ]
        ]
    },
    {
        "id": "e7f0e6696fc45206",
        "type": "websocket in",
        "z": "884a6474ca06ebd3",
        "name": "",
        "server": "",
        "client": "c53c11b411a8dbad",
        "x": 350,
        "y": 220,
        "wires": [
            [
                "d54d7e2b17b5b6cf"
            ]
        ]
    },
    {
        "id": "d54d7e2b17b5b6cf",
        "type": "http request",
        "z": "884a6474ca06ebd3",
        "name": "Blink LEDs",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:1880/things/leds/blink",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 690,
        "y": 200,
        "wires": [
            [
                "1e28f9495e35705c"
            ]
        ]
    },
    {
        "id": "1e28f9495e35705c",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 20",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 880,
        "y": 200,
        "wires": []
    },
    {
        "id": "d174306ab43da204",
        "type": "inject",
        "z": "884a6474ca06ebd3",
        "name": "Manual blink (test)",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "payload": "",
        "payloadType": "date",
        "x": 450,
        "y": 180,
        "wires": [
            [
                "d54d7e2b17b5b6cf"
            ]
        ]
    },
    {
        "id": "beb18f02d4914e95",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 21",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 940,
        "y": 340,
        "wires": []
    },
    {
        "id": "4c6d6713bf9f27a0",
        "type": "inject",
        "z": "884a6474ca06ebd3",
        "name": "Manual Test",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 350,
        "y": 400,
        "wires": [
            [
                "4f317d9f70b6a0bb"
            ]
        ]
    },
    {
        "id": "6a82f47ba7f6d6be",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 22",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 280,
        "y": 520,
        "wires": []
    },
    {
        "id": "2eb5592b3e331dc8",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 23",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1100,
        "y": 440,
        "wires": []
    },
    {
        "id": "60dcc738f1b793a5",
        "type": "websocket in",
        "z": "884a6474ca06ebd3",
        "name": "",
        "server": "",
        "client": "91c8ec522b374b97",
        "x": 210,
        "y": 460,
        "wires": [
            [
                "6a82f47ba7f6d6be",
                "4f317d9f70b6a0bb"
            ]
        ]
    },
    {
        "id": "4f317d9f70b6a0bb",
        "type": "function",
        "z": "884a6474ca06ebd3",
        "name": "set params",
        "func": "msg.payload = {\n    \"temperature\": 30,\n    \"timeHeating\": 30\n}",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 460,
        "wires": [
            [
                "n13_start_heater"
            ]
        ]
    },
    {
        "id": "34d007d424e5561a",
        "type": "websocket in",
        "z": "884a6474ca06ebd3",
        "name": "",
        "server": "19b93c24ab8e2161",
        "client": "",
        "x": 210,
        "y": 620,
        "wires": [
            [
                "n6_get_volume",
                "351060c42d2d5285"
            ]
        ]
    },
    {
        "id": "351060c42d2d5285",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 24",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 620,
        "wires": []
    },
    {
        "id": "94079233a707c01d",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 25",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 680,
        "wires": []
    },
    {
        "id": "b5ad05a01ef47912",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 26",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 800,
        "wires": []
    },
    {
        "id": "c2c7e445eb8b8101",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 27",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 960,
        "wires": []
    },
    {
        "id": "7772f383032adf6d",
        "type": "debug",
        "z": "884a6474ca06ebd3",
        "name": "debug 28",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 500,
        "y": 1080,
        "wires": []
    },
    {
        "id": "363aaeed881bc84d",
        "type": "function",
        "z": "884a6474ca06ebd3",
        "name": "function 38",
        "func": "msg.payload = {\"phrase\": \"somebody at the door!\"}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 250,
        "y": 880,
        "wires": [
            [
                "n9_say_doorbell"
            ]
        ]
    }
]